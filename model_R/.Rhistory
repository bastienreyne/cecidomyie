gather("Enherbement ras", "Paillage synthétique", "Enherbement haut",
key = sol, value = inflos, factor_key = TRUE)
## Chargement date 2017
load("/home/bastien/cecidomyie/data/date2017.Rdata")
inflos_CDE_obs <- inflos_CDE_obs %>%
mutate(Statut = factor(rep(c("CDE", "alive"), each = 80),
levels = c("CDE", "alive"))) %>%
mutate(Date = rep(date2017, 2)) %>%
gather("Enherbement ras", "Paillage synthétique", "Enherbement haut",
key = sol, value = inflos, factor_key = TRUE)
inflos_CDE_obs %>%
ggplot +
aes(x = Date, y = inflos, color = Statut) +
geom_line(lwd = 0.75) +
theme_bw() +
facet_grid(. ~ sol) +
scale_color_discrete(labels = c("Attractives", "Vivantes")) +
labs(color = element_text("Inflorescences")) +
ylab("Nombre d'inflorescences")
rm(list =ls())
# Packages / data ---------------------------------------------------------
library(tidyverse)
library(corrplot)
source("model_new.R")
source("objectif.R")
source("plot_res.R")
load("/home/bastien/cecidomyie/model_R/calibration_C.Rdata")
# Corrélations ------------------------------------------------------------
X <- scale(params_front_C)
Y <- scale(pareto_front_C)
matcor <- cor(cbind(X, Y), method = "spearman")
rownames(matcor) <- c(":gamma", ":p[m]", ":mu[ER]", ":mu[EH]",
":k", "stock", ":E[0] * mu[l]", "dA", "ER", "PS", "EH")
colnames(matcor) <- c(":gamma", ":p[m]", ":mu[ER]", ":mu[EH]",
":k", "stock", ":E[0] * mu[l]", "dA", "ER", "PS", "EH")
corrplot.mixed(matcor, tl.pos = "lt")
## On effectue une CAH
hca <- hclust(dist(X), method = "ward.D2")
inertie <- data.frame(height = rev(hca$height), nb_class = 1:(nrow(X)-1))
ggplot(inertie[1:25, ]) +
aes(y = height, x = nb_class) +
geom_step(lwd = 0.75) +
theme_bw() +
ylab("Inertie interne") +
xlab("Nombre de classes")
classes <- cutree(hca, 17)
plot_decompo_C(params_front_C[which(classes == classe)[1], ], inflos_obs)
classe <- 1
plot_decompo_C(params_front_C[which(classes == classe)[1], ], inflos_obs)
plot_decompo_C(params_front_C[which(classes == 2)[1], ], inflos_obs)
plot_decompo_C(params_front_C[which(classes == 3)[1], ], inflos_obs)
plot_decompo_C(params_front_C[which(classes == 4)[1], ], inflos_obs)
plot_decompo_C(params_front_C[which(classes == 5)[1], ], inflos_obs)
plot_decompo_C(params_front_C[which(classes == 6)[1], ], inflos_obs)
plot_decompo_C(params_front_C[which(classes == 7)[1], ], inflos_obs)
plot_decompo_C(params_front_C[which(classes == 8)[1], ], inflos_obs)
plot_decompo_C(params_front_C[which(classes == 9)[1], ], inflos_obs)
plot_decompo_C(params_front_C[which(classes == 10)[1], ], inflos_obs)
plot_decompo_C(params_front_C[which(classes == 11)[1], ], inflos_obs)
plot_decompo_C(params_front_C[which(classes == 12)[1], ], inflos_obs)
plot_decompo_C(params_front_C[which(classes == 13)[1], ], inflos_obs)
plot_decompo_C(params_front_C[which(classes == 14)[1], ], inflos_obs)
plot_decompo_C(params_front_C[which(classes == 15)[1], ], inflos_obs)
plot_decompo_C(params_front_C[which(classes == 16)[1], ], inflos_obs)
plot_decompo_C(params_front_C[which(classes == 17)[1], ], inflos_obs)
params_front_C[, 4] %>% summary()
params_front_C[, 4] %>% summary() %>% round(3)
plot_decompo_C(params_front_C[which(classes == 10)[1], ], inflos_obs)
ggsave("C1.eps", device = cairo_ps, width = 10, height = 5)
plot_decompo_C(params_front_C[which(classes == 1)[1], ], inflos_obs)
plot_decompo_C(params_front_C[which(classes == 1)[2], ], inflos_obs)
plot_decompo_C(params_front_C[which(classes == 1)[3], ], inflos_obs)
plot_decompo_C(params_front_C[which(classes == 1)[4], ], inflos_obs)
plot_decompo_C(params_front_C[which(classes == 1)[5], ], inflos_obs)
plot_decompo_C(params_front_C[which(classes == 1)[6], ], inflos_obs)
plot_decompo_C(params_front_C[which(classes == 1)[7], ], inflos_obs)
ggsave("C2.eps", device = cairo_ps, width = 10, height = 5)
params_front_C[which(classes == 1)[7], ] %>% round(3)
params_front_C[which(classes == 10)[1], ] %>% round(3)
## Chargement inflos
inflosCDE <- as.matrix(read.csv(file = "/home/bastien/cecidomyie/data/2017_inflosCDE_bloc1.csv",
row.names = "id"))
inflosCDE
inflosCDE[, 1]
rm(list=ls())
# Packages / data ---------------------------------------------------------
library(tidyverse)
library(corrplot)
source("model_new.R")
source("objectif.R")
source("plot_res.R")
load("/home/bastien/cecidomyie/model_R/calibration_C.Rdata")
# Corrélations ------------------------------------------------------------
X <- scale(params_front_C)
Y <- scale(pareto_front_C)
matcor <- cor(cbind(X, Y), method = "spearman")
rownames(matcor) <- c(":gamma", ":p[m]", ":mu[ER]", ":mu[EH]",
":k", "stock", ":E[0] * mu[l]", "dA", "ER", "PS", "EH")
colnames(matcor) <- c(":gamma", ":p[m]", ":mu[ER]", ":mu[EH]",
":k", "stock", ":E[0] * mu[l]", "dA", "ER", "PS", "EH")
corrplot.mixed(matcor, tl.pos = "lt")
# Corrélations ------------------------------------------------------------
X <- scale(params_front_C)
Y <- scale(pareto_front_C)
matcor <- cor(cbind(X, Y), method = "spearman")
rownames(matcor) <- c(":gamma", ":p[m]", ":mu[ER]", ":mu[EH]",
":k", "stock", ":E[0] * mu[l]", "ER", "PS", "EH")
colnames(matcor) <- c(":gamma", ":p[m]", ":mu[ER]", ":mu[EH]",
":k", "stock", ":E[0] * mu[l]", "ER", "PS", "EH")
corrplot.mixed(matcor, tl.pos = "lt")
## On effectue une CAH
hca <- hclust(dist(X), method = "ward.D2")
inertie <- data.frame(height = rev(hca$height), nb_class = 1:(nrow(X)-1))
ggplot(inertie[1:25, ]) +
aes(y = height, x = nb_class) +
geom_step(lwd = 0.75) +
theme_bw() +
ylab("Inertie interne") +
xlab("Nombre de classes")
classes <- cutree(hca, 13)
classe <- 1
plot_decompo_C(params_front_C[which(classes == classe)[1], ], inflos_obs)
plot_decompo_C(params_front_C[which(classes == 2)[1], ], inflos_obs)
plot_decompo_C(params_front_C[which(classes == 3)[1], ], inflos_obs)
plot_decompo_C(params_front_C[which(classes == 4)[1], ], inflos_obs)
plot_decompo_C(params_front_C[which(classes == 5)[1], ], inflos_obs)
plot_decompo_C(params_front_C[which(classes == 6)[1], ], inflos_obs)
plot_decompo_C(params_front_C[which(classes == 7)[1], ], inflos_obs)
plot_decompo_C(params_front_C[which(classes == 8)[1], ], inflos_obs)
plot_decompo_C(params_front_C[which(classes == 9)[1], ], inflos_obs)
plot_decompo_C(params_front_C[which(classes == 10)[1], ], inflos_obs)
plot_decompo_C(params_front_C[which(classes == 11)[1], ], inflos_obs)
plot_decompo_C(params_front_C[which(classes == 12)[1], ], inflos_obs)
plot_decompo_C(params_front_C[which(classes == 13)[1], ], inflos_obs)
plot_decompo_C(params_front_C[which(classes == 5)[1], ], inflos_obs)
plot_decompo_C(params_front_C[which(classes == 5)[2], ], inflos_obs)
plot_decompo_C(params_front_C[which(classes == 5)[3], ], inflos_obs)
plot_decompo_C(params_front_C[which(classes == 5)[4], ], inflos_obs)
plot_decompo_C(params_front_C[which(classes == 5)[5], ], inflos_obs)
plot_decompo_C(params_front_C[which(classes == 5)[6], ], inflos_obs)
plot_decompo_C(params_front_C[which(classes == 5)[7], ], inflos_obs)
plot_decompo_C(params_front_C[which(classes == 5)[8], ], inflos_obs)
plot_decompo_C(params_front_C[which(classes == 5)[9], ], inflos_obs)
plot_decompo_C(params_front_C[which(classes == 5)[10], ], inflos_obs)
plot_decompo_C(params_front_C[which(classes == 5)[11], ], inflos_obs)
plot_decompo_C(params_front_C[which(classes == 5)[12], ], inflos_obs)
plot_decompo_C(params_front_C[which(classes == 5)[13], ], inflos_obs)
plot_decompo_C(params_front_C[which(classes == 5)[3], ], inflos_obs)
plot_decompo_C(params_front_C[which(classes == 5)[1], ], inflos_obs)
plot_decompo_C(params_front_C[which(classes == 5)[2], ], inflos_obs)
plot_decompo_C(params_front_C[which(classes == 5)[3], ], inflos_obs)
ggsave("C2.eps", device = cairo_ps, width = 10, height = 5)
plot_decompo_C(params_front_C[which(classes == 13)[1], ], inflos_obs)
plot_decompo_C(params_front_C[which(classes == 13)[1], ], inflosCDE)
plot_decompo_C(params_front_C[which(classes == 1)[12], ], inflsCDE)
plot_decompo_C(params_front_C[which(classes == 1)[12], ], inflosCDE)
plot_decompo_C(params_front_C[which(classes == 1)[11], ], inflosCDE)
plot_decompo_C(params_front_C[which(classes == 1)[1], ], inflosCDE)
plot_decompo_C(params_front_C[which(classes == 2)[1], ], inflosCDE)
plot_decompo_C(params_front_C[which(classes == 3)[1], ], inflosCDE)
plot_decompo_C(params_front_C[which(classes == 4)[1], ], inflosCDE)
plot_decompo_C(params_front_C[which(classes == 5)[1], ], inflosCDE)
plot_decompo_C(params_front_C[which(classes == 6)[1], ], inflosCDE)
plot_decompo_C(params_front_C[which(classes == 7)[1], ], inflosCDE)
plot_decompo_C(params_front_C[which(classes == 8)[1], ], inflosCDE)
plot_decompo_C(params_front_C[which(classes == 9)[1], ], inflosCDE)
plot_decompo_C(params_front_C[which(classes == 10)[1], ], inflosCDE)
plot_decompo_C(params_front_C[which(classes == 11)[1], ], inflosCDE)
plot_decompo_C(params_front_C[which(classes == 12)[1], ], inflosCDE)
plot_decompo_C(params_front_C[which(classes == 13)[1], ], inflosCDE)
plot_decompo_C(params_front_C[which(classes == 8)[1], ], inflosCDE)
plot_decompo_C(params_front_C[which(classes == 10)[1], ], inflosCDE)
plot_decompo_C(params_front_C[which(classes == 10)[2], ], inflosCDE)
plot_decompo_C(params_front_C[which(classes == 10)[3], ], inflosCDE)
plot_decompo_C(params_front_C[which(classes == 10)[4], ], inflosCDE)
plot_decompo_C(params_front_C[which(classes == 10)[5], ], inflosCDE)
plot_decompo_C(params_front_C[which(classes == 10)[6], ], inflosCDE)
plot_decompo_C(params_front_C[which(classes == 10)[7], ], inflosCDE)
plot_decompo_C(params_front_C[which(classes == 10)[8], ], inflosCDE)
plot_decompo_C(params_front_C[which(classes == 10)[9], ], inflosCDE)
plot_decompo_C(params_front_C[which(classes == 10)[10], ], inflosCDE)
plot_decompo_C(params_front_C[which(classes == 10)[11], ], inflosCDE)
plot_decompo_C(params_front_C[which(classes == 10)[12], ], inflosCDE)
plot_decompo_C(params_front_C[which(classes == 10)[13], ], inflosCDE)
plot_decompo_C(params_front_C[which(classes == 10)[5], ], inflosCDE)
plot_decompo_C(params_front_C[which(classes == 10)[13], ], inflosCDE)
ggsave("C2.eps", device = cairo_ps, width = 10, height = 5)
params_front_C[which(classes == 10)[13], ] %>% round(3)
plot_decompo_C(params_front_C[which(classes == 6)[1], ], inflosCDE)
plot_decompo_C(params_front_C[which(classes == 6)[2], ], inflosCDE)
plot_decompo_C(params_front_C[which(classes == 6)[3], ], inflosCDE)
plot_decompo_C(params_front_C[which(classes == 6)[4], ], inflosCDE)
plot_decompo_C(params_front_C[which(classes == 6)[5], ], inflosCDE)
plot_decompo_C(params_front_C[which(classes == 6)[6], ], inflosCDE)
plot_decompo_C(params_front_C[which(classes == 6)[7], ], inflosCDE)
plot_decompo_C(params_front_C[which(classes == 6)[8], ], inflosCDE)
plot_decompo_C(params_front_C[which(classes == 6)[9], ], inflosCDE)
plot_decompo_C(params_front_C[which(classes == 6)[10], ], inflosCDE)
plot_decompo_C(params_front_C[which(classes == 6)[11], ], inflosCDE)
plot_decompo_C(params_front_C[which(classes == 6)[12], ], inflosCDE)
plot_decompo_C(params_front_C[which(classes == 6)[1], ], inflosCDE)
ggsave("C1.eps", device = cairo_ps, width = 10, height = 5)
params_front_C[which(classes == 6)[1], ] %>% round(3)
params_front_C[which(classes == 13)[1], ] %>% round(3)
plot_decompo_C(params_front_C[which(classes == 13)[1], ], inflosCDE)
plot_decompo_C(params_front_C[which(classes == 13)[2], ], inflosCDE)
plot_decompo_C(params_front_C[which(classes == 13)[3], ], inflosCDE)
plot_decompo_C(params_front_C[which(classes == 13)[4], ], inflosCDE)
params_front_C[, 4] %>% summary()
params_front_C[, 4] %>% which.max()
plot_decompo_C(params_front_C[150, ], inflosCDE)
classes[150]
plot_decompo_C(params_front_C[which(classes == 4)[4], ], inflosCDE)
plot_decompo_C(params_front_C[which(classes == 4)[3], ], inflosCDE)
plot_decompo_C(params_front_C[which(classes == 4)[2], ], inflosCDE)
plot_decompo_C(params_front_C[which(classes == 4)[5], ], inflosCDE)
plot_decompo_C(params_front_C[which(classes == 4)[6], ], inflosCDE)
plot_decompo_C(params_front_C[which(classes == 4)[7], ], inflosCDE)
plot_decompo_C(params_front_C[which(classes == 4)[8], ], inflosCDE)
plot_decompo_C(params_front_C[which(classes == 4)[9], ], inflosCDE)
plot_decompo_C(params_front_C[which(classes == 4)[10], ], inflosCDE)
plot_decompo_C(params_front_C[which(classes == 4)[11], ], inflosCDE)
plot_decompo_C(params_front_C[which(classes == 4)[12], ], inflosCDE)
plot_decompo_C(params_front_C[which(classes == 2)[12], ], inflosCDE)
plot_decompo_C(params_front_C[which(classes == 2)[2], ], inflosCDE)
plot_decompo_C(params_front_C[which(classes == 2)[3], ], inflosCDE)
plot_decompo_C(params_front_C[which(classes == 2)[4], ], inflosCDE)
which(classes = 2)
which(classes == 2)
C2 <- which(classes == 2)
para
params_front_C[C2, 4]
params_front_C[C2, 4] %>% which.max
C2[15]
plot_decompo_C(params_front_C[88, ], inflosCDE)
C2 <- which(classes == 3)
C2
params_front_C[C2, 4] %>% which.max
C2[19]
plot_decompo_C(params_front_C[227, ], inflosCDE)
plot_decompo_C(params_front_C[which(classes == 4)[4], ], inflosCDE)
plot_decompo_C(params_front_C[which(classes == 4)[2], ], inflosCDE)
plot_decompo_C(params_front_C[which(classes == 4)[1], ], inflosCDE)
plot_decompo_C(params_front_C[which(classes == 4)[2], ], inflosCDE)
plot_decompo_C(params_front_C[which(classes == 4)[3], ], inflosCDE)
ggsav("C3.eps", device = cairo_ps, width = 10, height = 5)
ggsave("C3.eps", device = cairo_ps, width = 10, height = 5)
params_front_C[which(classes == 4)[3], ]
params_front_C[which(classes == 4)[3], ] %>% round(3)
inflos_CDE_obs %>%
ggplot +
aes(x = Date, y = inflos, color = Statut) +
geom_line(lwd = 0.75) +
theme_bw() +
facet_grid(. ~ sol) +
scale_color_discrete(labels = c("Attractives", "Vivantes")) +
labs(color = element_text("Inflorescences")) +
ylab("Nombre d'inflorescences")
library(tidyverse)
inflos_CDE_obs %>%
ggplot +
aes(x = Date, y = inflos, color = Statut) +
geom_line(lwd = 0.75) +
theme_bw() +
facet_grid(. ~ sol) +
scale_color_discrete(labels = c("Attractives", "Vivantes")) +
labs(color = element_text("Inflorescences")) +
ylab("Nombre d'inflorescences")
bursts <- read.csv("../data/2017_bursts_simulated.csv", row.names = 1) %>% as.matrix
mu <- 29
sigma <- 14
CDF_norm <- pnorm(1:50, mu, sigma)
inflosCDE <- function(burst, dA = 16) {
inflos <- rep(NA, length(burst))
inflos[1] <- burst[1]
days <- 1:(length(burst)+3) ## Pour arriver au 80 jours avec les burst du dataset 1
for (t in days[-1]) {
temp <- 0
for (j in 1:min(dA, t-1)) {
temp <- temp + burst[t-j] * (1 - CDF_norm[j])
}
inflos[t] <- burst[t] + temp
}
inflos
}
inflosCDE_ER <- inflosCDE(bursts[, 1], 33)
inflosCDE_PS <- inflosCDE(bursts[, 2], 33)
inflosCDE_ER <- inflosCDE(bursts[, 1])
inflosCDE_PS <- inflosCDE(bursts[, 2])
inflosCDE_EH <- inflosCDE(bursts[, 3])
inflosCDE_bloc1 <- cbind(inflosCDE_ER[1:80],
inflosCDE_PS[1:80],
inflosCDE_EH[1:80])
inflos_CDE_obs <- rbind(inflosCDE_bloc1, inflos_obs) %>%
as.data.frame()
colnames(inflos_CDE_obs) <- c("Enherbement ras", "Paillage synthétique", "Enherbement haut")
inflos_CDE_obs <- inflos_CDE_obs %>%
mutate(Statut = factor(rep(c("CDE", "alive"), each = 80),
levels = c("CDE", "alive"))) %>%
mutate(Date = rep(date2017, 2)) %>%
gather("Enherbement ras", "Paillage synthétique", "Enherbement haut",
key = sol, value = inflos, factor_key = TRUE)
inflos_CDE_obs %>%
ggplot +
aes(x = Date, y = inflos, color = Statut) +
geom_line(lwd = 0.75) +
theme_bw() +
facet_grid(. ~ sol) +
scale_color_discrete(labels = c("Attractives", "Vivantes")) +
labs(color = element_text("Inflorescences")) +
ylab("Nombre d'inflorescences")
inflos_CDE_obs %>%
ggplot +
aes(x = Date, y = inflos, color = Statut) +
geom_line(lwd = 0.75) +
theme_bw() +
facet_grid(. ~ sol) +
scale_color_discrete(labels = c("Attractives", "Vivantes")) +
labs(color = element_text("Inflorescences")) +
ylab("Nombre d'inflorescences") +
theme(legend.position = "b")
inflos_CDE_obs %>%
ggplot +
aes(x = Date, y = inflos, color = Statut) +
geom_line(lwd = 0.75) +
theme_bw() +
facet_grid(. ~ sol) +
scale_color_discrete(labels = c("Attractives", "Vivantes")) +
labs(color = element_text("Inflorescences")) +
ylab("Nombre d'inflorescences") +
theme(legend.position = "bottom")
ggsave("inflos_CDE.eps", width = 10, height = 5)
library(tidyverse)
rm(list = ls())
# Packages / data ---------------------------------------------------------
library(tidyverse)
library(corrplot)
source("model_new.R")
source("objectif.R")
source("plot_res.R")
load("/home/bastien/cecidomyie/model_R/calibration_D.Rdata")
# Corrélations ------------------------------------------------------------
X <- scale(params_front_C)
Y <- scale(pareto_front_C)
matcor <- cor(cbind(X, Y), method = "spearman")
rownames(matcor) <- c(":gamma", ":p[m]", ":mu[ER]", ":mu[EH]",
":k", "stock", ":E[0] * mu[l]", "ER", "PS", "EH")
colnames(matcor) <- c(":gamma", ":p[m]", ":mu[ER]", ":mu[EH]",
":k", "stock", ":E[0] * mu[l]", "ER", "PS", "EH")
corrplot.mixed(matcor, tl.pos = "lt")
# Corrélations ------------------------------------------------------------
X <- scale(params_front_D)
Y <- scale(pareto_front_D)
matcor <- cor(cbind(X, Y), method = "spearman")
rownames(matcor) <- c(":gamma", ":p[m]", ":mu[ER]", ":mu[EH]",
":k", "stock", ":E[0] * mu[l]", "ER", "PS", "EH")
colnames(matcor) <- c(":gamma", ":p[m]", ":mu[ER]", ":mu[EH]",
":k", "stock", ":E[0] * mu[l]", "ER", "PS", "EH")
corrplot.mixed(matcor, tl.pos = "lt")
# Corrélations ------------------------------------------------------------
X <- scale(params_front_D)
Y <- scale(pareto_front_D)
matcor <- cor(cbind(X, Y), method = "spearman")
rownames(matcor) <- c(":gamma", ":p[m]", ":mu[ER]", ":mu[EH]",
":k", "stock", ":E[0] * mu[l]", "season", "ER", "PS", "EH")
colnames(matcor) <- c(":gamma", ":p[m]", ":mu[ER]", ":mu[EH]",
":k", "stock", ":E[0] * mu[l]", "season", "ER", "PS", "EH")
corrplot.mixed(matcor, tl.pos = "lt")
## On effectue une CAH
hca <- hclust(dist(X), method = "ward.D2")
inertie <- data.frame(height = rev(hca$height), nb_class = 1:(nrow(X)-1))
ggplot(inertie[1:25, ]) +
aes(y = height, x = nb_class) +
geom_step(lwd = 0.75) +
theme_bw() +
ylab("Inertie interne") +
xlab("Nombre de classes")
classes <- cutree(hca, 14)
classe <- 1
plot_decompo_season(params_front_C[which(classes == classe)[1], ], inflosCDE)
plot_decompo_season(params_front_C[which(classes == classe)[1], ], inflosCDE)
plot_decompo_season(params_front_D[which(classes == classe)[1], ], inflosCDE)
source('~/cecidomyie/model_R/plot_res.R')
plot_decompo_season(params_front_D[which(classes == classe)[1], ], inflosCDE)
plot_decompo_season(params_front_D[which(classes == 2)[1], ], inflosCDE)
plot_decompo_season(params_front_D[which(classes == 3)[1], ], inflosCDE)
plot_decompo_season(params_front_D[which(classes == 4)[1], ], inflosCDE)
plot_decompo_season(params_front_D[which(classes == 5)[1], ], inflosCDE)
plot_decompo_season(params_front_D[which(classes == 6)[1], ], inflosCDE)
plot_decompo_season(params_front_D[which(classes == 7)[1], ], inflosCDE)
plot_decompo_season(params_front_D[which(classes == 8)[1], ], inflosCDE)
plot_decompo_season(params_front_D[which(classes == 9)[1], ], inflosCDE)
plot_decompo_season(params_front_D[which(classes == 10)[1], ], inflosCDE)
plot_decompo_season(params_front_D[which(classes == 11)[1], ], inflosCDE)
plot_decompo_season(params_front_D[which(classes == 12)[1], ], inflosCDE)
plot_decompo_season(params_front_D[which(classes == 13)[1], ], inflosCDE)
plot_decompo_season(params_front_D[which(classes == 14)[1], ], inflosCDE)
plot_decompo_season(params_front_D[which(classes == 15)[1], ], inflosCDE)
plot_decompo_season(params_front_D[which(classes == 5)[2], ], inflosCDE)
plot_decompo_season(params_front_D[which(classes == 5)[3], ], inflosCDE)
plot_decompo_season(params_front_D[which(classes == 5)[4], ], inflosCDE)
plot_decompo_season(params_front_D[which(classes == 5)[5], ], inflosCDE)
plot_decompo_season(params_front_D[which(classes == 5)[6], ], inflosCDE)
plot_decompo_season(params_front_D[which(classes == 5)[7], ], inflosCDE)
plot_decompo_season(params_front_D[which(classes == 5)[8], ], inflosCDE)
plot_decompo_season(params_front_D[which(classes == 5)[9], ], inflosCDE)
plot_decompo_season(params_front_D[which(classes == 7)[9], ], inflosCDE)
plot_decompo_season(params_front_D[which(classes == 7)[8], ], inflosCDE)
plot_decompo_season(params_front_D[which(classes == 5)[5], ], inflosCDE)
params_front_D[which(classes == 5)[5], ] %>% round(3)
ggsave("D1.eps", device = cairo_ps, width = 10, height = 5)
plot_decompo_season(params_front_D[which(classes == 7)[1], ], inflosCDE)
plot_decompo_season(params_front_D[which(classes == 7)[2], ], inflosCDE)
plot_decompo_season(params_front_D[which(classes == 7)[3], ], inflosCDE)
plot_decompo_season(params_front_D[which(classes == 7)[4], ], inflosCDE)
plot_decompo_season(params_front_D[which(classes == 7)[5], ], inflosCDE)
plot_decompo_season(params_front_D[which(classes == 7)[6], ], inflosCDE)
params_front_D[which(classes == 7), 2] %>% which.max()
plot_decompo_season(params_front_D[which(classes == 7)[56], ], inflosCDE)
plot_decompo_season(params_front_D[which(classes == 7)[42], ], inflosCDE)
plot_decompo_season(params_front_D[which(classes == 7)[12], ], inflosCDE)
plot_decompo_season(params_front_D[which(classes == 7)[13], ], inflosCDE)
params_front_D[which(classes == 5), 2] %>% which.max()
params_front_D[which(classes == 6), 2] %>% which.max()
plot_decompo_season(params_front_D[which(classes == 6)[9], ], inflosCDE)
plot_decompo_season(params_front_D[which(classes == 5)[5], ], inflosCDE)
plot_decompo_season(params_front_D[which(classes == 6)[9], ], inflosCDE)
ggsave("D1.eps", device = cairo_ps, width = 10, height = 5)
params_front_D[which(classes == 6)[9], ] %>% round(3)
dynamics_season_b2 <- function(arg, inflos) {
## Renvoie la dynamique de larves pour les trois sous-blocs
gamma <- arg[1]
migration <- arg[2]
mu_ER <- arg[3]
mu_EH <- arg[4]
inflo_capacity <- arg[5]
stock <- arg[6]
# stock <- 0
reproduction <- arg[7]
season <- arg[8]
alpha <- exchange(migration, inflos)
females_exo <- incoming(gamma, inflos)
# females_exo <- matrix(30, nrow = 80, ncol = 3)
larves <- matrix(0, nrow = nb_jours, ncol = 3)
females_endo <- matrix(0, nrow = nb_jours, ncol = 3)
females <- matrix(0, nrow = nb_jours, ncol = 3)
mu_sol <- c(mu_ER, mu_PS, mu_EH)
for (jour in 1:nb_jours) {
if (jour < 36) {
larves[jour, ] <- larvaes_count(jour, inflo_capacity, inflos, females,
mu_sol, reproduction)
females_endo[jour, ] <- emerging(jour, larves, mu_sol, stock)
females[jour, 1] <- females_count(jour, alpha[[1]],
females_exo[, 1], females_endo)
females[jour, 2] <- females_count(jour, alpha[[2]],
females_exo[, 2], females_endo)
females[jour, 3] <- females_count(jour, alpha[[3]],
females_exo[, 3], females_endo)
}
if (jour >= 36) {
larves[jour, ] <- larvaes_count(jour, inflo_capacity, inflos, females,
mu_sol, reproduction)
females_endo[jour, ] <- emerging(jour, larves, mu_sol, stock)
females[jour, 1] <- females_count(jour, alpha[[1]],
females_exo[, 1], females_endo)
females[jour, 2] <- females_count(jour, alpha[[2]],
females_exo[, 2], females_endo)
females[jour, 3] <- females_count(jour, alpha[[3]],
females_exo[, 3], females_endo)
females[jour, ] <- females[jour, ] * season
}
}
larves
}
source('~/cecidomyie/model_R/model_new.R')
source('~/cecidomyie/model_R/plot_res.R')
plot_decompo_season_b2(c(0.021, 0.105, 0.938, 0.916, 1.992, 516, 0.004))
inflosCDEb2 <- read.csv("/home/bastien/cecidomyie/data/2017_inflosCDE_bloc2.csv", row.names = "id")
inflosCDEb2
plot_decompo_season_b2(c(0.021, 0.105, 0.938, 0.916, 1.992, 516, 0.004), inflosCDEb2 %>% as.matrix)
plot_decompo_season_b2(c(0.021, 0.105, 0.938, 0.916, 1.992, 516, 0.004), as.matrix(inflosCDEb2)+1)
plot_decompo_season_b2(c(0.021, 0.105, 0.938, 0.916, 1.992, 516, 0.004), as.matrix(inflosCDEb2+1))
as.matrix(inflosCDEb2+1)
plot_decompo_season_b2(c(0.021, 0.105, 0.938, 0.916, 1.992, 516, 6.018, 0.004), as.matrix(inflosCDEb2+1))
ggsave("D2.eps", device = cairo_ps, width = 10, height = 5)
load("calibration_D.Rdata")
plot_decompo_season_b2(params_front_D[1, ], as.matrix(inflosCDEb2+1))
plot_decompo_season_b2(params_front_D[2, ], as.matrix(inflosCDEb2+1))
plot_decompo_season_b2(params_front_D[3, ], as.matrix(inflosCDEb2+1))
plot_decompo_season_b2(params_front_D[4, ], as.matrix(inflosCDEb2+1))
plot_decompo_season_b2(params_front_D[5, ], as.matrix(inflosCDEb2+1))
plot_decompo_season_b2(params_front_D[6, ], as.matrix(inflosCDEb2+1))
plot_decompo_season_b2(params_front_D[7, ], as.matrix(inflosCDEb2+1))
plot_decompo_season_b2(params_front_D[8, ], as.matrix(inflosCDEb2+1))
plot_decompo_season_b2(params_front_D[9, ], as.matrix(inflosCDEb2+1))
plot_decompo_season_b2(params_front_D[10, ], as.matrix(inflosCDEb2+1))
plot_decompo_season_b2(params_front_D[11, ], as.matrix(inflosCDEb2+1))
plot_decompo_season_b2(params_front_D[12, ], as.matrix(inflosCDEb2+1))
plot_decompo_season_b2(params_front_D[13, ], as.matrix(inflosCDEb2+1))
plot_decompo_season_b2(params_front_D[14, ], as.matrix(inflosCDEb2+1))
plot_decompo_season_b2(params_front_D[15, ], as.matrix(inflosCDEb2+1))
plot_decompo_season_b2(params_front_D[16, ], as.matrix(inflosCDEb2+1))
plot_decompo_season_b2(params_front_D[17, ], as.matrix(inflosCDEb2+1))
plot_decompo_season_b2(params_front_D[18, ], as.matrix(inflosCDEb2+1))
plot_decompo_season_b2(params_front_D[19, ], as.matrix(inflosCDEb2+1))
plot_decompo_season_b2(params_front_D[20, ], as.matrix(inflosCDEb2+1))
plot_decompo_season_b2(params_front_D[21, ], as.matrix(inflosCDEb2+1))
plot_decompo_season_b2(params_front_D[22, ], as.matrix(inflosCDEb2+1))
plot_decompo_season_b2(params_front_D[23, ], as.matrix(inflosCDEb2+1))
plot_decompo_season_b2(params_front_D[24, ], as.matrix(inflosCDEb2+1))
plot_decompo_season_b2(params_front_D[25, ], as.matrix(inflosCDEb2+1))
1+1

ggsave("D1.eps", device = cairo_ps, width = 10, height = 5)
plot_decompo_season(params_front_D[which(classes == 7)[1], ], inflosCDE)
plot_decompo_season(params_front_D[which(classes == 7)[2], ], inflosCDE)
plot_decompo_season(params_front_D[which(classes == 7)[3], ], inflosCDE)
plot_decompo_season(params_front_D[which(classes == 7)[4], ], inflosCDE)
plot_decompo_season(params_front_D[which(classes == 7)[5], ], inflosCDE)
plot_decompo_season(params_front_D[which(classes == 7)[6], ], inflosCDE)
params_front_D[which(classes == 7), 2] %>% which.max()
plot_decompo_season(params_front_D[which(classes == 7)[56], ], inflosCDE)
plot_decompo_season(params_front_D[which(classes == 7)[42], ], inflosCDE)
plot_decompo_season(params_front_D[which(classes == 7)[12], ], inflosCDE)
plot_decompo_season(params_front_D[which(classes == 7)[13], ], inflosCDE)
params_front_D[which(classes == 5), 2] %>% which.max()
params_front_D[which(classes == 6), 2] %>% which.max()
plot_decompo_season(params_front_D[which(classes == 6)[9], ], inflosCDE)
plot_decompo_season(params_front_D[which(classes == 5)[5], ], inflosCDE)
plot_decompo_season(params_front_D[which(classes == 6)[9], ], inflosCDE)
ggsave("D1.eps", device = cairo_ps, width = 10, height = 5)
params_front_D[which(classes == 6)[9], ] %>% round(3)
dynamics_season_b2 <- function(arg, inflos) {
## Renvoie la dynamique de larves pour les trois sous-blocs
gamma <- arg[1]
migration <- arg[2]
mu_ER <- arg[3]
mu_EH <- arg[4]
inflo_capacity <- arg[5]
stock <- arg[6]
# stock <- 0
reproduction <- arg[7]
season <- arg[8]
alpha <- exchange(migration, inflos)
females_exo <- incoming(gamma, inflos)
# females_exo <- matrix(30, nrow = 80, ncol = 3)
larves <- matrix(0, nrow = nb_jours, ncol = 3)
females_endo <- matrix(0, nrow = nb_jours, ncol = 3)
females <- matrix(0, nrow = nb_jours, ncol = 3)
mu_sol <- c(mu_ER, mu_PS, mu_EH)
for (jour in 1:nb_jours) {
if (jour < 36) {
larves[jour, ] <- larvaes_count(jour, inflo_capacity, inflos, females,
mu_sol, reproduction)
females_endo[jour, ] <- emerging(jour, larves, mu_sol, stock)
females[jour, 1] <- females_count(jour, alpha[[1]],
females_exo[, 1], females_endo)
females[jour, 2] <- females_count(jour, alpha[[2]],
females_exo[, 2], females_endo)
females[jour, 3] <- females_count(jour, alpha[[3]],
females_exo[, 3], females_endo)
}
if (jour >= 36) {
larves[jour, ] <- larvaes_count(jour, inflo_capacity, inflos, females,
mu_sol, reproduction)
females_endo[jour, ] <- emerging(jour, larves, mu_sol, stock)
females[jour, 1] <- females_count(jour, alpha[[1]],
females_exo[, 1], females_endo)
females[jour, 2] <- females_count(jour, alpha[[2]],
females_exo[, 2], females_endo)
females[jour, 3] <- females_count(jour, alpha[[3]],
females_exo[, 3], females_endo)
females[jour, ] <- females[jour, ] * season
}
}
larves
}
source('~/cecidomyie/model_R/model_new.R')
source('~/cecidomyie/model_R/plot_res.R')
plot_decompo_season_b2(c(0.021, 0.105, 0.938, 0.916, 1.992, 516, 0.004))
inflosCDEb2 <- read.csv("/home/bastien/cecidomyie/data/2017_inflosCDE_bloc2.csv", row.names = "id")
inflosCDEb2
plot_decompo_season_b2(c(0.021, 0.105, 0.938, 0.916, 1.992, 516, 0.004), inflosCDEb2 %>% as.matrix)
plot_decompo_season_b2(c(0.021, 0.105, 0.938, 0.916, 1.992, 516, 0.004), as.matrix(inflosCDEb2)+1)
plot_decompo_season_b2(c(0.021, 0.105, 0.938, 0.916, 1.992, 516, 0.004), as.matrix(inflosCDEb2+1))
as.matrix(inflosCDEb2+1)
plot_decompo_season_b2(c(0.021, 0.105, 0.938, 0.916, 1.992, 516, 6.018, 0.004), as.matrix(inflosCDEb2+1))
ggsave("D2.eps", device = cairo_ps, width = 10, height = 5)
load("calibration_D.Rdata")
plot_decompo_season_b2(params_front_D[1, ], as.matrix(inflosCDEb2+1))
plot_decompo_season_b2(params_front_D[2, ], as.matrix(inflosCDEb2+1))
plot_decompo_season_b2(params_front_D[3, ], as.matrix(inflosCDEb2+1))
plot_decompo_season_b2(params_front_D[4, ], as.matrix(inflosCDEb2+1))
plot_decompo_season_b2(params_front_D[5, ], as.matrix(inflosCDEb2+1))
plot_decompo_season_b2(params_front_D[6, ], as.matrix(inflosCDEb2+1))
plot_decompo_season_b2(params_front_D[7, ], as.matrix(inflosCDEb2+1))
plot_decompo_season_b2(params_front_D[8, ], as.matrix(inflosCDEb2+1))
plot_decompo_season_b2(params_front_D[9, ], as.matrix(inflosCDEb2+1))
plot_decompo_season_b2(params_front_D[10, ], as.matrix(inflosCDEb2+1))
plot_decompo_season_b2(params_front_D[11, ], as.matrix(inflosCDEb2+1))
plot_decompo_season_b2(params_front_D[12, ], as.matrix(inflosCDEb2+1))
plot_decompo_season_b2(params_front_D[13, ], as.matrix(inflosCDEb2+1))
plot_decompo_season_b2(params_front_D[14, ], as.matrix(inflosCDEb2+1))
plot_decompo_season_b2(params_front_D[15, ], as.matrix(inflosCDEb2+1))
plot_decompo_season_b2(params_front_D[16, ], as.matrix(inflosCDEb2+1))
plot_decompo_season_b2(params_front_D[17, ], as.matrix(inflosCDEb2+1))
plot_decompo_season_b2(params_front_D[18, ], as.matrix(inflosCDEb2+1))
plot_decompo_season_b2(params_front_D[19, ], as.matrix(inflosCDEb2+1))
plot_decompo_season_b2(params_front_D[20, ], as.matrix(inflosCDEb2+1))
plot_decompo_season_b2(params_front_D[21, ], as.matrix(inflosCDEb2+1))
plot_decompo_season_b2(params_front_D[22, ], as.matrix(inflosCDEb2+1))
plot_decompo_season_b2(params_front_D[23, ], as.matrix(inflosCDEb2+1))
plot_decompo_season_b2(params_front_D[24, ], as.matrix(inflosCDEb2+1))
plot_decompo_season_b2(params_front_D[25, ], as.matrix(inflosCDEb2+1))
1+1
source('~/cecidomyie/model_R/objectif.R')
source('~/cecidomyie/model_R/plot_res.R')
plot_dynamics_A(c(0.08, 0.494, 0.976, 0.046, 1.928, 5600, 3.084), inflos_obs)
to_plot %>% ggplot +
aes(x = date, y = nombre, color = statut) +
geom_point() +
geom_line() +
facet_grid(. ~ Sol) +
theme_bw() +
theme(legend.title = element_blank(), legend.position = "bottom") +
scale_color_discrete(labels = c("Observation", "Estimation"), values = c("black", "green4")) +
xlab("Date") +
ylab("Nombre de larves")
plot_dynamics_A <- function(args, inflos) {
obs <- larves_obs
est <- dynamics_A(args, inflos)
er <- data.frame(date = date2017, obs = obs[, 1], est = est[, 1]) %>%
mutate(Sol = factor("Enherbement ras",
levels = c("Enherbement ras",
"Paillage synthétique",
"Enherbement haut"))) %>%
gather(obs, est, key = statut, value = nombre, factor_key = TRUE)
ps <- data.frame(date = date2017, obs = obs[, 2], est = est[, 2]) %>%
mutate(Sol = factor("Paillage synthétique",
levels = c("Enherbement ras",
"Paillage synthétique",
"Enherbement haut"))) %>%
gather(obs, est, key = statut, value = nombre, factor_key = TRUE)
eh <- data.frame(date = date2017, obs = obs[, 3], est = est[, 3]) %>%
mutate(Sol = factor("Enherbement haut",
levels = c("Enherbement ras",
"Paillage synthétique",
"Enherbement haut"))) %>%
gather(obs, est, key = statut, value = nombre, factor_key = TRUE)
to_plot <- bind_rows(er, ps, eh)
to_plot %>% ggplot +
aes(x = date, y = nombre, color = statut) +
geom_point() +
geom_line() +
facet_grid(. ~ Sol) +
theme_bw() +
theme(legend.title = element_blank(), legend.position = "bottom") +
scale_color_discrete(labels = c("Observation", "Estimation"), values = c("black", "green4")) +
xlab("Date") +
ylab("Nombre de larves")
}
to_plot %>% ggplot +
aes(x = date, y = nombre, color = statut) +
geom_point() +
geom_line() +
facet_grid(. ~ Sol) +
theme_bw() +
theme(legend.title = element_blank(), legend.position = "bottom") +
scale_color_discrete(labels = c("Observation", "Estimation"), values = c("black", "green4")) +
xlab("Date") +
ylab("Nombre de larves")
plot_dynamics_A(c(0.08, 0.494, 0.976, 0.046, 1.928, 5600, 3.084), inflos_obs)
?scale_color_discrete
plot_dynamics_A <- function(args, inflos) {
obs <- larves_obs
est <- dynamics_A(args, inflos)
er <- data.frame(date = date2017, obs = obs[, 1], est = est[, 1]) %>%
mutate(Sol = factor("Enherbement ras",
levels = c("Enherbement ras",
"Paillage synthétique",
"Enherbement haut"))) %>%
gather(obs, est, key = statut, value = nombre, factor_key = TRUE)
ps <- data.frame(date = date2017, obs = obs[, 2], est = est[, 2]) %>%
mutate(Sol = factor("Paillage synthétique",
levels = c("Enherbement ras",
"Paillage synthétique",
"Enherbement haut"))) %>%
gather(obs, est, key = statut, value = nombre, factor_key = TRUE)
eh <- data.frame(date = date2017, obs = obs[, 3], est = est[, 3]) %>%
mutate(Sol = factor("Enherbement haut",
levels = c("Enherbement ras",
"Paillage synthétique",
"Enherbement haut"))) %>%
gather(obs, est, key = statut, value = nombre, factor_key = TRUE)
to_plot <- bind_rows(er, ps, eh)
to_plot %>% ggplot +
aes(x = date, y = nombre, color = statut) +
geom_point() +
geom_line() +
facet_grid(. ~ Sol) +
theme_bw() +
theme(legend.title = element_blank(), legend.position = "bottom") +
scale_color_discrete(labels = c("Observation", "Estimation")) +
xlab("Date") +
ylab("Nombre de larves")
}
to_plot %>% ggplot +
aes(x = date, y = nombre, color = statut) +
geom_point() +
geom_line() +
facet_grid(. ~ Sol) +
theme_bw() +
theme(legend.title = element_blank(), legend.position = "bottom") +
scale_color_discrete(labels = c("Observation", "Estimation")) +
scale_color_manual(values = c("black", "green4")) +
xlab("Date") +
ylab("Nombre de larves")
plot_dynamics_A <- function(args, inflos) {
obs <- larves_obs
est <- dynamics_A(args, inflos)
er <- data.frame(date = date2017, obs = obs[, 1], est = est[, 1]) %>%
mutate(Sol = factor("Enherbement ras",
levels = c("Enherbement ras",
"Paillage synthétique",
"Enherbement haut"))) %>%
gather(obs, est, key = statut, value = nombre, factor_key = TRUE)
ps <- data.frame(date = date2017, obs = obs[, 2], est = est[, 2]) %>%
mutate(Sol = factor("Paillage synthétique",
levels = c("Enherbement ras",
"Paillage synthétique",
"Enherbement haut"))) %>%
gather(obs, est, key = statut, value = nombre, factor_key = TRUE)
eh <- data.frame(date = date2017, obs = obs[, 3], est = est[, 3]) %>%
mutate(Sol = factor("Enherbement haut",
levels = c("Enherbement ras",
"Paillage synthétique",
"Enherbement haut"))) %>%
gather(obs, est, key = statut, value = nombre, factor_key = TRUE)
to_plot <- bind_rows(er, ps, eh)
to_plot %>% ggplot +
aes(x = date, y = nombre, color = statut) +
geom_point() +
geom_line() +
facet_grid(. ~ Sol) +
theme_bw() +
theme(legend.title = element_blank(), legend.position = "bottom") +
scale_color_discrete(labels = c("Observation", "Estimation")) +
scale_color_manual(values = c("black", "green4")) +
xlab("Date") +
ylab("Nombre de larves")
}
plot_dynamics_A(c(0.08, 0.494, 0.976, 0.046, 1.928, 5600, 3.084), inflos_obs)
plot_dynamics_A <- function(args, inflos) {
obs <- larves_obs
est <- dynamics_A(args, inflos)
er <- data.frame(date = date2017, obs = obs[, 1], est = est[, 1]) %>%
mutate(Sol = factor("Enherbement ras",
levels = c("Enherbement ras",
"Paillage synthétique",
"Enherbement haut"))) %>%
gather(obs, est, key = statut, value = nombre, factor_key = TRUE)
ps <- data.frame(date = date2017, obs = obs[, 2], est = est[, 2]) %>%
mutate(Sol = factor("Paillage synthétique",
levels = c("Enherbement ras",
"Paillage synthétique",
"Enherbement haut"))) %>%
gather(obs, est, key = statut, value = nombre, factor_key = TRUE)
eh <- data.frame(date = date2017, obs = obs[, 3], est = est[, 3]) %>%
mutate(Sol = factor("Enherbement haut",
levels = c("Enherbement ras",
"Paillage synthétique",
"Enherbement haut"))) %>%
gather(obs, est, key = statut, value = nombre, factor_key = TRUE)
to_plot <- bind_rows(er, ps, eh)
to_plot %>% ggplot +
aes(x = date, y = nombre, color = statut) +
geom_point() +
geom_line() +
facet_grid(. ~ Sol) +
theme_bw() +
theme(legend.title = element_blank(), legend.position = "bottom") +
scale_color_discrete(labels = c("Observation", "Estimation")) +
scale_color_manual(values = c("black", "green4"), labels = c("Observation", "Estimation")) +
xlab("Date") +
ylab("Nombre de larves")
}
plot_dynamics_A(c(0.08, 0.494, 0.976, 0.046, 1.928, 5600, 3.084), inflos_obs)
ggsave("A1_d.eps", width = 10, height = 4.5)
ggsave("A1_d.eps", width = 10, height = 5)
rm(list = ls())
# Packages ----------------------------------------------------------------
library(mco) ## Pour nsga2
library(emoa) ## Pour is_dominated
library(snow) ## Pour la parallelisation
library(snowfall) ## Pour la parallelisation
source("/home/bastien/cecidomyie/model_R/objectif.R")
# NSGA-II -----------------------------------------------------------------
to_optimize <- function(x, fun_obj) {
## x servira pour la parallelisation
## fun_obj correspond a notre fonction objectif
binf <- c(0, 0, 0, 0, 0.1, 500, 1, 3)
bsup <- c(1, 1, 1, 1, 2, 20300, 11, 40)
res <- nsga2(fun_obj,
idim = 7,
odim = 3,
lower.bounds = binf,
upper.bounds = bsup,
popsize = 200,
generations = 200)
}
to_optimize(1, obj_C)
to_optimize(1, obj_C)
dA
duree_attra
bursts
duree_attra
arg
inflos_attractives(bursts, 16)
inflos_attractives(bursts, 3)
inflos_attractives(bursts, 2)
inflos_attractives(bursts, 1)
to_optimize(1, obj_C)
gamma
migration
arg
to_optimize(1, obj_C)
gamma
migration
duree_attra
rm(list =ls())
source('~/cecidomyie/model_R/model_new.R')
source('~/cecidomyie/model_R/plot_res.R')
source('~/cecidomyie/model_R/objective.R')
source('~/cecidomyie/model_R/objectif.R')
inflosCDE2 <- read.csv("../data/2017_inflosCDE_bloc2.csv")
inflosCDE2
inflosCDE2 <- read.csv("../data/2017_inflosCDE_bloc2.csv", row.names = 1)
inflosCDE2
inflosCDE2 <- read.csv("../data/2017_inflosCDE_bloc2.csv", row.names = 1) %>% as.matrix
inflosCDE2
inflosCDE2 %>% class()
inflosCDE2[, 1]
source('~/cecidomyie/model_R/model_new.R')
source('~/cecidomyie/model_R/plot_res.R')
plot_decompo_15sept_b2(c(0.021
0.105
0.938
0.916
1.992
516
6.018,0.004
), inflosCDE2)
plot_decompo_15sept_b2(c(0.021,
0.105,
0.938,
0.916,
1.992,
516,
6.018,0.004
), inflosCDE2)
ggsave("verger2_15sept.eps", device = cairo_ps, width = 10, height = 5)
rm(list = ls())
# Packages / data ---------------------------------------------------------
library(tidyverse)
library(corrplot)
source("model_new.R")
source("objectif.R")
source("plot_res.R")
load("/home/bastien/cecidomyie/model_R/calibration_C2.Rdata")
# Corrélations ------------------------------------------------------------
X <- scale(params_front_C2)
Y <- scale(pareto_front_C2)
matcor <- cor(cbind(X, Y), method = "spearman")
rownames(matcor) <- c(":gamma", ":p[m]", ":mu[ER]", ":mu[EH]",
":k", "stock", ":E[0] * mu[l]", "dA", "ER", "PS", "EH")
colnames(matcor) <- c(":gamma", ":p[m]", ":mu[ER]", ":mu[EH]",
":k", "stock", ":E[0] * mu[l]", "dA", "ER", "PS", "EH")
corrplot.mixed(matcor, tl.pos = "lt")
## On effectue une CAH
hca <- hclust(dist(X), method = "ward.D2")
inertie <- data.frame(height = rev(hca$height), nb_class = 1:(nrow(X)-1))
ggplot(inertie[1:25, ]) +
aes(y = height, x = nb_class) +
geom_step(lwd = 0.75) +
theme_bw() +
ylab("Inertie interne") +
xlab("Nombre de classes")
classes <- cutree(hca, 15)
params_C2
params_C2[, 8]
params_C2[, 8] %>% summary()
params_C2[, 8] %>% hist
params_C2[, 8] %>% hist(freq = DALSE)
params_C2[, 8] %>% hist(freq = FALSE)
source('~/cecidomyie/model_R/model_new.R')
source('~/cecidomyie/model_R/plot_res.R')
source('~/cecidomyie/model_R/objectif.R')
# Packages / data ---------------------------------------------------------
library(tidyverse)
library(corrplot)
source("model_new.R")
source("objectif.R")
source("plot_res.R")
load("/home/bastien/cecidomyie/model_R/calibration_C2.Rdata")
X <- scale(params_front_C2)
Y <- scale(pareto_front_C2)
matcor <- cor(cbind(X, Y), method = "spearman")
rownames(matcor) <- c(":gamma", ":p[m]", ":mu[ER]", ":mu[EH]",
":k", "stock", ":E[0] * mu[l]", "dA", "ER", "PS", "EH")
colnames(matcor) <- c(":gamma", ":p[m]", ":mu[ER]", ":mu[EH]",
":k", "stock", ":E[0] * mu[l]", "dA", "ER", "PS", "EH")
corrplot.mixed(matcor, tl.pos = "lt")
## On effectue une CAH
hca <- hclust(dist(X), method = "ward.D2")
inertie <- data.frame(height = rev(hca$height), nb_class = 1:(nrow(X)-1))
ggplot(inertie[1:25, ]) +
aes(y = height, x = nb_class) +
geom_step(lwd = 0.75) +
theme_bw() +
ylab("Inertie interne") +
xlab("Nombre de classes")
classes <- cutree(hca, 15)
classe <- 1
plot_decompo_C2(params_front_C2[which(classes == classe)[1], ], inflosCDE)
plot_decompo_C2(params_front_C2[which(classes == 2)[1], ], inflosCDE)
plot_decompo_C2(params_front_C2[which(classes == 3)[1], ], inflosCDE)
plot_decompo_C2(params_front_C2[which(classes == 2)[1], ], inflosCDE)
plot_decompo_C2(params_front_C2[which(classes == 3)[1], ], inflosCDE)
plot_decompo_C2(params_front_C2[which(classes == 4)[1], ], inflosCDE)
plot_decompo_C2(params_front_C2[which(classes == 5)[1], ], inflosCDE)
plot_decompo_C2(params_front_C2[which(classes == 6)[1], ], inflosCDE)
params_front_C2[which(classes == 6)[1], ]
plot_decompo_C2(params_front_C2[which(classes == 7)[1], ], inflosCDE)
plot_decompo_C2(params_front_C2[which(classes == 8)[1], ], inflosCDE)
plot_decompo_C2(params_front_C2[which(classes == 9)[1], ], inflosCDE)
plot_decompo_C2(params_front_C2[which(classes == 10)[1], ], inflosCDE)
plot_decompo_C2(params_front_C2[which(classes == 11)[1], ], inflosCDE)
plot_decompo_C2(params_front_C2[which(classes == 12)[1], ], inflosCDE)
plot_decompo_C2(params_front_C2[which(classes == 12)[2], ], inflosCDE)
plot_decompo_C2(params_front_C2[which(classes == 13)[1], ], inflosCDE)
plot_decompo_C2(params_front_C2[which(classes == 14)[1], ], inflosCDE)
plot_decompo_C2(params_front_C2[which(classes == 15)[1], ], inflosCDE)
params_C2[, 8] %>% hist()
as.data.frame(dA = params_C2[, 8]) %>% ggplot() + aes(x=dA) + geom_histogram()
as.data.frame(dA = params_C2[, 8]) %>% ggplot() + aes(x=dA) + geom_histogram()
as.data.frame(dA = params_C2[, 8]) %>% ggplot() + aes(dA) + geom_histogram()
as.data.frame(dA = params_C2[, 8]) %>% ggplot() + geom_histogram(dA)
as.data.frame(dA = params_C2[, 8]) %>% ggplot() + geom_histogram(x = dA)
as.data.frame(dA = params_C2[, 8]) %>% ggplot() + geom_histogram(aes(x = dA))
toto <- as.data.frame(dA = params_C2[, 8])
toto
dA = params_C2[, 8]
toto <- as.data.frame(dA)
toto
toto %>% ggplot() + aes(x=dA) + geom_histogram()
toto %>% ggplot() + aes(x=dA) + geom_histogram() + theme_bw()
toto %>% ggplot() + aes(x=dA) + geom_histogram() + theme_bw() + xlab("Durée d'attractivité des inflosrescences")
toto %>% ggplot() + aes(x=dA, stat(density)) + geom_histogram() + theme_bw() + xlab("Durée d'attractivité des inflosrescences")
toto %>% ggplot() + aes(x=dA, stat(density)) + geom_histogram() + theme_bw() + xlab("Durée d'attractivité des inflosrescences") + ylab("Fréquence")
toto %>% ggplot() + aes(x=dA, stat(density)) + geom_histogram(binwidth = 0.01) + theme_bw() + xlab("Durée d'attractivité des inflosrescences") + ylab("Fréquence")
toto %>% ggplot() + aes(x=dA, stat(density)) + geom_histogram(binwidth = 0.1) + theme_bw() + xlab("Durée d'attractivité des inflosrescences") + ylab("Fréquence")
toto %>% ggplot() + aes(x=dA, stat(density)) + geom_histogram(binwidth = 0.2) + theme_bw() + xlab("Durée d'attractivité des inflosrescences") + ylab("Fréquence")
ggsave("dA.eps", width = 10, height = 7)
# Corrélations ------------------------------------------------------------
which(9 <= params_front_C2[, 8] <= 16)
# Corrélations ------------------------------------------------------------
which(9 <= params_front_C2[, 8] & params_front_C2[, 8] <= 16)
# Corrélations ------------------------------------------------------------
ind_dA <- which(9 <= params_front_C2[, 8] & params_front_C2[, 8] <= 16)
params_dA_C2 <- params_front_C2[ind_dA, ]
# Corrélations ------------------------------------------------------------
ind_dA <- which(9 <= params_front_C2[, 8] & params_front_C2[, 8] <= 16)
params_dA_C2 <- params_front_C2[ind_dA, ]
X <- scale(params_dA_C2)
Y <- scale(pareto_front_C2[ind_dA, ])
matcor <- cor(cbind(X, Y), method = "spearman")
rownames(matcor) <- c(":gamma", ":p[m]", ":mu[ER]", ":mu[EH]",
":k", "stock", ":E[0] * mu[l]", "dA", "ER", "PS", "EH")
colnames(matcor) <- c(":gamma", ":p[m]", ":mu[ER]", ":mu[EH]",
":k", "stock", ":E[0] * mu[l]", "dA", "ER", "PS", "EH")
corrplot.mixed(matcor, tl.pos = "lt")
## On effectue une CAH
hca <- hclust(dist(X), method = "ward.D2")
inertie <- data.frame(height = rev(hca$height), nb_class = 1:(nrow(X)-1))
ggplot(inertie[1:25, ]) +
aes(y = height, x = nb_class) +
geom_step(lwd = 0.75) +
theme_bw() +
ylab("Inertie interne") +
xlab("Nombre de classes")
classes <- cutree(hca, 12)
nrow(params_dA_C2)
classe <- 1
plot_decompo_C2(params_dA_C2[which(classes == classe)[1], ], inflosCDE)
plot_decompo_C2(params_dA_C2[which(classes == 2)[1], ], inflosCDE)
plot_decompo_C2(params_dA_C2[which(classes == 3)[1], ], inflosCDE)
plot_decompo_C2(params_dA_C2[which(classes == 4)[1], ], inflosCDE)
plot_decompo_C2(params_dA_C2[which(classes == 5)[1], ], inflosCDE)
plot_decompo_C2(params_dA_C2[which(classes == 6)[1], ], inflosCDE)
plot_decompo_C2(params_dA_C2[which(classes == 7)[1], ], inflosCDE)
plot_decompo_C2(params_dA_C2[which(classes == 8)[1], ], inflosCDE)
plot_decompo_C2(params_dA_C2[which(classes == 9)[1], ], inflosCDE)
plot_decompo_C2(params_dA_C2[which(classes == 10)[1], ], inflosCDE)
plot_decompo_C2(params_dA_C2[which(classes == 11)[1], ], inflosCDE)
plot_decompo_C2(params_dA_C2[which(classes == 12)[1], ], inflosCDE)
params_dA_C2[, 4] %>% which.max()
plot_decompo_C2(params_dA_C2[288, ], inflosCDE)
plot_decompo_C2(params_dA_C2[which(classes == 1)[1], ], inflosCDE)
plot_decompo_C2(params_dA_C2[which(classes == 8)[1], ], inflosCDE)
plot_decompo_C2(params_dA_C2[which(classes == 9)[1], ], inflosCDE)
plot_decompo_C2(params_dA_C2[which(classes == 2)[1], ], inflosCDE)
plot_decompo_C2(params_dA_C2[which(classes == 2)[2], ], inflosCDE)
params_dA_C2[, 1] %>% which.max()
plot_decompo_C2(params_dA_C2[285, ], inflosCDE)
plot_decompo_C2(params_dA_C2[which(classes == 2)[1], ], inflosCDE)
ggsave("C2_1.eps", device = cairo_ps, width = 10, height = 5)
params_dA_C2[which(classes == 2)[1], ]
params_dA_C2[which(classes == 2)[1], ] %>% round(3)
plot_decompo_C2(params_dA_C2[which(classes == 8)[1], ], inflosCDE)
ggsave("C2_2.eps", device = cairo_ps, width = 10, height = 5)
params_dA_C2[which(classes == 8)[1], ]
params_dA_C2[which(classes == 8)[1], ] %>% round(3)
plot_decompo_C2(params_dA_C2[which(classes == 9)[1], ], inflosCDE)
ggsave("C2_3.eps", device = cairo_ps, width = 10, height = 5)
params_dA_C2[which(classes == 9)[1], ] %>% round(3)

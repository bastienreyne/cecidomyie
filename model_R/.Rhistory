"Enherbement haut")),
Observation = obs[, 3],
Estimation = estimations[[1]][, 3],
Pupaison = estimations[[2]][, 3],
Diapause = estimations[[3]][, 3],
Voisinage = estimations[[4]][, 3],
Exogène = estimations[[5]][, 3],
Inflos = inflos[, 3]) %>%
gather(Exogène, Voisinage, Diapause, Pupaison,
key = prov, value = prop, factor_key = TRUE)
to_plot <- bind_rows(ploter, plotps, ploteh)
to_plot %>% ggplot +
aes(x = Date) +
geom_area(aes(y = prop, fill = prov), alpha = 0.5) +
geom_line(aes(y = Observation, color = "Observation"), lwd = 0.75) +
geom_line(aes(y = Estimation, color = "Estimation"), lwd = 0.75) +
geom_point(aes(y = Observation, color = "Observation")) +
geom_point(aes(y = Estimation, color = "Estimation")) +
geom_line(aes(y = Inflos, color = "Inflos"), lwd = 0.75) +
theme_bw() +
facet_grid(. ~ Sol) +
theme(legend.title = element_blank(), legend.position = "bottom") +
scale_color_manual(values = c("green4", "black", "red")) +
ylab("Nombre de larves")
}
plot_decompo_season(c(0, 0.052, 0.786, 0.8, 2, 500, 7.3, 0.001), inflosCDE)
plot_decompo_season <- function(args, inflos) {
obs <- larves_obs
estimations <- decomposition_season_bloc1(args, inflos)
ploter <- data.frame(Date = date2017,
Sol = factor("Enherbement ras", levels = c("Enherbement ras",
"Paillage synthétique",
"Enherbement haut")),
Observation = obs[, 1],
Estimation = estimations[[1]][, 1],
Pupaison = estimations[[2]][, 1],
Diapause = estimations[[3]][, 1],
Voisinage = estimations[[4]][, 1],
Exogène = estimations[[5]][, 1],
Inflos = inflos[, 1],
Alive = inflos_obs[, 1]) %>%
gather(Exogène, Voisinage, Diapause, Pupaison,
key = prov, value = prop, factor_key = TRUE)
plotps <- data.frame(Date = date2017,
Sol = factor("Paillage synthétique", levels = c("Enherbement ras",
"Paillage synthétique",
"Enherbement haut")),
Observation = obs[, 2],
Estimation = estimations[[1]][, 2],
Pupaison = estimations[[2]][, 2],
Diapause = estimations[[3]][, 2],
Voisinage = estimations[[4]][, 2],
Exogène = estimations[[5]][, 2],
Inflos = inflos[, 2],
Alive = inflos_obs[, 2]) %>%
gather(Exogène, Voisinage, Diapause, Pupaison,
key = prov, value = prop, factor_key = TRUE)
ploteh <- data.frame(Date = date2017,
Sol = factor("Enherbement haut", levels = c("Enherbement ras",
"Paillage synthétique",
"Enherbement haut")),
Observation = obs[, 3],
Estimation = estimations[[1]][, 3],
Pupaison = estimations[[2]][, 3],
Diapause = estimations[[3]][, 3],
Voisinage = estimations[[4]][, 3],
Exogène = estimations[[5]][, 3],
Inflos = inflos[, 3],
Alive = inflos_obs[, 3]) %>%
gather(Exogène, Voisinage, Diapause, Pupaison,
key = prov, value = prop, factor_key = TRUE)
to_plot <- bind_rows(ploter, plotps, ploteh)
to_plot %>% ggplot +
aes(x = Date) +
geom_area(aes(y = prop, fill = prov), alpha = 0.5) +
geom_line(aes(y = Observation, color = "Observation"), lwd = 0.75) +
geom_line(aes(y = Estimation, color = "Estimation"), lwd = 0.75) +
geom_point(aes(y = Observation, color = "Observation")) +
geom_point(aes(y = Estimation, color = "Estimation")) +
geom_line(aes(y = Inflos, color = "Inflos"), lwd = 0.75) +
geom_line(aes(y = Inflos, color = "Alive"), lwd = 0.75) +
theme_bw() +
facet_grid(. ~ Sol) +
theme(legend.title = element_blank(), legend.position = "bottom") +
scale_color_manual(values = c("green4", "red", "black", "blue")) +
ylab("Nombre de larves")
}
plot_decompo_season(c(0, 0.052, 0.786, 0.8, 2, 500, 7.3, 0.001), inflosCDE)
inflos_obs <- cbind(data_piege %>% filter(Sol == "ER") %>% pull(inflos),
data_piege %>% filter(Sol == "PS") %>% pull(inflos),
data_piege %>% filter(Sol == "EH") %>% pull(inflos))
plot_decompo_season(c(0, 0.052, 0.786, 0.8, 2, 500, 7.3, 0.001), inflosCDE)
plot_decompo_season <- function(args, inflos) {
obs <- larves_obs
estimations <- decomposition_season_bloc1(args, inflos)
ploter <- data.frame(Date = date2017,
Sol = factor("Enherbement ras", levels = c("Enherbement ras",
"Paillage synthétique",
"Enherbement haut")),
Observation = obs[, 1],
Estimation = estimations[[1]][, 1],
Pupaison = estimations[[2]][, 1],
Diapause = estimations[[3]][, 1],
Voisinage = estimations[[4]][, 1],
Exogène = estimations[[5]][, 1],
Inflos = inflos[, 1],
Alive = inflos_obs[, 1]) %>%
gather(Exogène, Voisinage, Diapause, Pupaison,
key = prov, value = prop, factor_key = TRUE)
plotps <- data.frame(Date = date2017,
Sol = factor("Paillage synthétique", levels = c("Enherbement ras",
"Paillage synthétique",
"Enherbement haut")),
Observation = obs[, 2],
Estimation = estimations[[1]][, 2],
Pupaison = estimations[[2]][, 2],
Diapause = estimations[[3]][, 2],
Voisinage = estimations[[4]][, 2],
Exogène = estimations[[5]][, 2],
Inflos = inflos[, 2],
Alive = inflos_obs[, 2]) %>%
gather(Exogène, Voisinage, Diapause, Pupaison,
key = prov, value = prop, factor_key = TRUE)
ploteh <- data.frame(Date = date2017,
Sol = factor("Enherbement haut", levels = c("Enherbement ras",
"Paillage synthétique",
"Enherbement haut")),
Observation = obs[, 3],
Estimation = estimations[[1]][, 3],
Pupaison = estimations[[2]][, 3],
Diapause = estimations[[3]][, 3],
Voisinage = estimations[[4]][, 3],
Exogène = estimations[[5]][, 3],
Inflos = inflos[, 3],
Alive = inflos_obs[, 3]) %>%
gather(Exogène, Voisinage, Diapause, Pupaison,
key = prov, value = prop, factor_key = TRUE)
to_plot <- bind_rows(ploter, plotps, ploteh)
to_plot %>% ggplot +
aes(x = Date) +
geom_area(aes(y = prop, fill = prov), alpha = 0.5) +
geom_line(aes(y = Observation, color = "Observation"), lwd = 0.75) +
geom_line(aes(y = Estimation, color = "Estimation"), lwd = 0.75) +
geom_point(aes(y = Observation, color = "Observation")) +
geom_point(aes(y = Estimation, color = "Estimation")) +
geom_line(aes(y = Inflos, color = "Inflos"), lwd = 0.75) +
geom_line(aes(y = Alive, color = "Alive"), lwd = 0.75) +
theme_bw() +
facet_grid(. ~ Sol) +
theme(legend.title = element_blank(), legend.position = "bottom") +
scale_color_manual(values = c("green4", "red", "black", "blue")) +
ylab("Nombre de larves")
}
plot_decompo_season(c(0, 0.052, 0.786, 0.8, 2, 500, 7.3, 0.001), inflosCDE)
plot_decompo_season <- function(args, inflos) {
obs <- larves_obs
estimations <- decomposition_season_bloc1(args, inflos)
ploter <- data.frame(Date = date2017,
Sol = factor("Enherbement ras", levels = c("Enherbement ras",
"Paillage synthétique",
"Enherbement haut")),
Observation = obs[, 1],
Estimation = estimations[[1]][, 1],
Pupaison = estimations[[2]][, 1],
Diapause = estimations[[3]][, 1],
Voisinage = estimations[[4]][, 1],
Exogène = estimations[[5]][, 1],
Inflos = inflos[, 1],
Alive = inflos_obs[, 1]) %>%
gather(Exogène, Voisinage, Diapause, Pupaison,
key = prov, value = prop, factor_key = TRUE)
plotps <- data.frame(Date = date2017,
Sol = factor("Paillage synthétique", levels = c("Enherbement ras",
"Paillage synthétique",
"Enherbement haut")),
Observation = obs[, 2],
Estimation = estimations[[1]][, 2],
Pupaison = estimations[[2]][, 2],
Diapause = estimations[[3]][, 2],
Voisinage = estimations[[4]][, 2],
Exogène = estimations[[5]][, 2],
Inflos = inflos[, 2],
Alive = inflos_obs[, 2]) %>%
gather(Exogène, Voisinage, Diapause, Pupaison,
key = prov, value = prop, factor_key = TRUE)
ploteh <- data.frame(Date = date2017,
Sol = factor("Enherbement haut", levels = c("Enherbement ras",
"Paillage synthétique",
"Enherbement haut")),
Observation = obs[, 3],
Estimation = estimations[[1]][, 3],
Pupaison = estimations[[2]][, 3],
Diapause = estimations[[3]][, 3],
Voisinage = estimations[[4]][, 3],
Exogène = estimations[[5]][, 3],
Inflos = inflos[, 3],
Alive = inflos_obs[, 3]) %>%
gather(Exogène, Voisinage, Diapause, Pupaison,
key = prov, value = prop, factor_key = TRUE)
to_plot <- bind_rows(ploter, plotps, ploteh)
to_plot %>% ggplot +
aes(x = Date) +
# geom_area(aes(y = prop, fill = prov), alpha = 0.5) +
geom_line(aes(y = Observation, color = "Observation"), lwd = 0.75) +
geom_line(aes(y = Estimation, color = "Estimation"), lwd = 0.75) +
geom_point(aes(y = Observation, color = "Observation")) +
geom_point(aes(y = Estimation, color = "Estimation")) +
geom_line(aes(y = Inflos, color = "Inflos"), lwd = 0.75) +
geom_line(aes(y = Alive, color = "Alive"), lwd = 0.75) +
theme_bw() +
facet_grid(. ~ Sol) +
theme(legend.title = element_blank(), legend.position = "bottom") +
scale_color_manual(values = c("green4", "red", "black", "blue")) +
ylab("Nombre de larves")
}
plot_decompo_season(c(0, 0.052, 0.786, 0.8, 2, 500, 7.3, 0.001), inflosCDE)
plot_decompo_season <- function(args, inflos) {
obs <- larves_obs
estimations <- decomposition_season_bloc1(args, inflos)
ploter <- data.frame(Date = date2017,
Sol = factor("Enherbement ras", levels = c("Enherbement ras",
"Paillage synthétique",
"Enherbement haut")),
Observation = obs[, 1],
Estimation = estimations[[1]][, 1],
Pupaison = estimations[[2]][, 1],
Diapause = estimations[[3]][, 1],
Voisinage = estimations[[4]][, 1],
Exogène = estimations[[5]][, 1],
Inflos = inflos[, 1],
Alive = inflos_obs[, 1]) %>%
gather(Exogène, Voisinage, Diapause, Pupaison,
key = prov, value = prop, factor_key = TRUE)
plotps <- data.frame(Date = date2017,
Sol = factor("Paillage synthétique", levels = c("Enherbement ras",
"Paillage synthétique",
"Enherbement haut")),
Observation = obs[, 2],
Estimation = estimations[[1]][, 2],
Pupaison = estimations[[2]][, 2],
Diapause = estimations[[3]][, 2],
Voisinage = estimations[[4]][, 2],
Exogène = estimations[[5]][, 2],
Inflos = inflos[, 2],
Alive = inflos_obs[, 2]) %>%
gather(Exogène, Voisinage, Diapause, Pupaison,
key = prov, value = prop, factor_key = TRUE)
ploteh <- data.frame(Date = date2017,
Sol = factor("Enherbement haut", levels = c("Enherbement ras",
"Paillage synthétique",
"Enherbement haut")),
Observation = obs[, 3],
Estimation = estimations[[1]][, 3],
Pupaison = estimations[[2]][, 3],
Diapause = estimations[[3]][, 3],
Voisinage = estimations[[4]][, 3],
Exogène = estimations[[5]][, 3],
Inflos = inflos[, 3],
Alive = inflos_obs[, 3]) %>%
gather(Exogène, Voisinage, Diapause, Pupaison,
key = prov, value = prop, factor_key = TRUE)
to_plot <- bind_rows(ploter, plotps, ploteh)
to_plot %>% ggplot +
aes(x = Date) +
# geom_area(aes(y = prop, fill = prov), alpha = 0.5) +
geom_line(aes(y = Observation, color = "Observation"), lwd = 0.75) +
# geom_line(aes(y = Estimation, color = "Estimation"), lwd = 0.75) +
geom_point(aes(y = Observation, color = "Observation")) +
geom_point(aes(y = Estimation, color = "Estimation")) +
geom_line(aes(y = Inflos, color = "Inflos"), lwd = 0.75) +
geom_line(aes(y = Alive, color = "Alive"), lwd = 0.75) +
theme_bw() +
facet_grid(. ~ Sol) +
theme(legend.title = element_blank(), legend.position = "bottom") +
scale_color_manual(values = c("green4", "black", "blue")) +
ylab("Nombre de larves")
}
plot_decompo_season(c(0, 0.052, 0.786, 0.8, 2, 500, 7.3, 0.001), inflosCDE)
plot_decompo_season <- function(args, inflos) {
obs <- larves_obs
estimations <- decomposition_season_bloc1(args, inflos)
ploter <- data.frame(Date = date2017,
Sol = factor("Enherbement ras", levels = c("Enherbement ras",
"Paillage synthétique",
"Enherbement haut")),
Observation = obs[, 1],
Estimation = estimations[[1]][, 1],
Pupaison = estimations[[2]][, 1],
Diapause = estimations[[3]][, 1],
Voisinage = estimations[[4]][, 1],
Exogène = estimations[[5]][, 1],
Inflos = inflos[, 1],
Alive = inflos_obs[, 1]) %>%
gather(Exogène, Voisinage, Diapause, Pupaison,
key = prov, value = prop, factor_key = TRUE)
plotps <- data.frame(Date = date2017,
Sol = factor("Paillage synthétique", levels = c("Enherbement ras",
"Paillage synthétique",
"Enherbement haut")),
Observation = obs[, 2],
Estimation = estimations[[1]][, 2],
Pupaison = estimations[[2]][, 2],
Diapause = estimations[[3]][, 2],
Voisinage = estimations[[4]][, 2],
Exogène = estimations[[5]][, 2],
Inflos = inflos[, 2],
Alive = inflos_obs[, 2]) %>%
gather(Exogène, Voisinage, Diapause, Pupaison,
key = prov, value = prop, factor_key = TRUE)
ploteh <- data.frame(Date = date2017,
Sol = factor("Enherbement haut", levels = c("Enherbement ras",
"Paillage synthétique",
"Enherbement haut")),
Observation = obs[, 3],
Estimation = estimations[[1]][, 3],
Pupaison = estimations[[2]][, 3],
Diapause = estimations[[3]][, 3],
Voisinage = estimations[[4]][, 3],
Exogène = estimations[[5]][, 3],
Inflos = inflos[, 3],
Alive = inflos_obs[, 3]) %>%
gather(Exogène, Voisinage, Diapause, Pupaison,
key = prov, value = prop, factor_key = TRUE)
to_plot <- bind_rows(ploter, plotps, ploteh)
to_plot %>% ggplot +
aes(x = Date) +
# geom_area(aes(y = prop, fill = prov), alpha = 0.5) +
geom_line(aes(y = Observation, color = "Observation"), lwd = 0.75) +
# geom_line(aes(y = Estimation, color = "Estimation"), lwd = 0.75) +
geom_point(aes(y = Observation, color = "Observation")) +
# geom_point(aes(y = Estimation, color = "Estimation")) +
geom_line(aes(y = Inflos, color = "Inflos"), lwd = 0.75) +
geom_line(aes(y = Alive, color = "Alive"), lwd = 0.75) +
theme_bw() +
facet_grid(. ~ Sol) +
theme(legend.title = element_blank(), legend.position = "bottom") +
scale_color_manual(values = c("green4", "black", "blue")) +
ylab("Nombre de larves")
}
plot_decompo_season(c(0, 0.052, 0.786, 0.8, 2, 500, 7.3, 0.001), inflosCDE)
source('~/cecidomyie/model_R/model_new.R')
plot_decompo_season(c(0, 0.052, 0.786, 0.8, 2, 500, 7.3, 0.001), inflosCDE)
plot_decompo_season <- function(args, inflos) {
obs <- larves_obs
estimations <- decomposition_season_bloc1(args, inflos)
ploter <- data.frame(Date = date2017,
Sol = factor("Enherbement ras", levels = c("Enherbement ras",
"Paillage synthétique",
"Enherbement haut")),
Observation = obs[, 1],
Estimation = estimations[[1]][, 1],
Pupaison = estimations[[2]][, 1],
Diapause = estimations[[3]][, 1],
Voisinage = estimations[[4]][, 1],
Exogène = estimations[[5]][, 1],
Inflos = inflos[, 1],
Alive = inflos_obs[, 1]) %>%
gather(Exogène, Voisinage, Diapause, Pupaison,
key = prov, value = prop, factor_key = TRUE)
plotps <- data.frame(Date = date2017,
Sol = factor("Paillage synthétique", levels = c("Enherbement ras",
"Paillage synthétique",
"Enherbement haut")),
Observation = obs[, 2],
Estimation = estimations[[1]][, 2],
Pupaison = estimations[[2]][, 2],
Diapause = estimations[[3]][, 2],
Voisinage = estimations[[4]][, 2],
Exogène = estimations[[5]][, 2],
Inflos = inflos[, 2],
Alive = inflos_obs[, 2]) %>%
gather(Exogène, Voisinage, Diapause, Pupaison,
key = prov, value = prop, factor_key = TRUE)
ploteh <- data.frame(Date = date2017,
Sol = factor("Enherbement haut", levels = c("Enherbement ras",
"Paillage synthétique",
"Enherbement haut")),
Observation = obs[, 3],
Estimation = estimations[[1]][, 3],
Pupaison = estimations[[2]][, 3],
Diapause = estimations[[3]][, 3],
Voisinage = estimations[[4]][, 3],
Exogène = estimations[[5]][, 3],
Inflos = inflos[, 3],
Alive = inflos_obs[, 3]) %>%
gather(Exogène, Voisinage, Diapause, Pupaison,
key = prov, value = prop, factor_key = TRUE)
to_plot <- bind_rows(ploter, plotps, ploteh)
to_plot %>% ggplot +
aes(x = Date) +
# geom_area(aes(y = prop, fill = prov), alpha = 0.5) +
geom_line(aes(y = Observation, color = "Observation"), lwd = 0.75) +
geom_line(aes(y = Estimation, color = "Estimation"), lwd = 0.75) +
geom_point(aes(y = Observation, color = "Observation")) +
geom_point(aes(y = Estimation, color = "Estimation")) +
geom_line(aes(y = Inflos, color = "Inflos"), lwd = 0.75) +
geom_line(aes(y = Alive, color = "Alive"), lwd = 0.75) +
theme_bw() +
facet_grid(. ~ Sol) +
theme(legend.title = element_blank(), legend.position = "bottom") +
scale_color_manual(values = c("green4", "black", "blue")) +
ylab("Nombre de larves")
}
plot_decompo_season(c(0, 0.052, 0.786, 0.8, 2, 500, 7.3, 0.001), inflosCDE)
plot_decompo_season <- function(args, inflos) {
obs <- larves_obs
estimations <- decomposition_season_bloc1(args, inflos)
ploter <- data.frame(Date = date2017,
Sol = factor("Enherbement ras", levels = c("Enherbement ras",
"Paillage synthétique",
"Enherbement haut")),
Observation = obs[, 1],
Estimation = estimations[[1]][, 1],
Pupaison = estimations[[2]][, 1],
Diapause = estimations[[3]][, 1],
Voisinage = estimations[[4]][, 1],
Exogène = estimations[[5]][, 1],
Inflos = inflos[, 1],
Alive = inflos_obs[, 1]) %>%
gather(Exogène, Voisinage, Diapause, Pupaison,
key = prov, value = prop, factor_key = TRUE)
plotps <- data.frame(Date = date2017,
Sol = factor("Paillage synthétique", levels = c("Enherbement ras",
"Paillage synthétique",
"Enherbement haut")),
Observation = obs[, 2],
Estimation = estimations[[1]][, 2],
Pupaison = estimations[[2]][, 2],
Diapause = estimations[[3]][, 2],
Voisinage = estimations[[4]][, 2],
Exogène = estimations[[5]][, 2],
Inflos = inflos[, 2],
Alive = inflos_obs[, 2]) %>%
gather(Exogène, Voisinage, Diapause, Pupaison,
key = prov, value = prop, factor_key = TRUE)
ploteh <- data.frame(Date = date2017,
Sol = factor("Enherbement haut", levels = c("Enherbement ras",
"Paillage synthétique",
"Enherbement haut")),
Observation = obs[, 3],
Estimation = estimations[[1]][, 3],
Pupaison = estimations[[2]][, 3],
Diapause = estimations[[3]][, 3],
Voisinage = estimations[[4]][, 3],
Exogène = estimations[[5]][, 3],
Inflos = inflos[, 3],
Alive = inflos_obs[, 3]) %>%
gather(Exogène, Voisinage, Diapause, Pupaison,
key = prov, value = prop, factor_key = TRUE)
to_plot <- bind_rows(ploter, plotps, ploteh)
to_plot %>% ggplot +
aes(x = Date) +
# geom_area(aes(y = prop, fill = prov), alpha = 0.5) +
geom_line(aes(y = Observation, color = "Observation"), lwd = 0.75) +
geom_line(aes(y = Estimation, color = "Estimation"), lwd = 0.75) +
geom_point(aes(y = Observation, color = "Observation")) +
geom_point(aes(y = Estimation, color = "Estimation")) +
geom_line(aes(y = Inflos, color = "Inflos"), lwd = 0.75) +
geom_line(aes(y = Alive, color = "Alive"), lwd = 0.75) +
theme_bw() +
facet_grid(. ~ Sol) +
theme(legend.title = element_blank(), legend.position = "bottom") +
scale_color_manual(values = c("green4", "black", "blue", "orange")) +
ylab("Nombre de larves")
}
plot_decompo_season(c(0, 0.052, 0.786, 0.8, 2, 500, 7.3, 0.001), inflosCDE)
source('~/cecidomyie/model_R/model_new.R')
plot_decompo_season(c(0, 0.052, 0.786, 0.8, 2, 500, 7.3, 0.001), inflosCDE)
source('~/cecidomyie/model_R/model_new.R')
plot_decompo_season(c(0, 0.052, 0.786, 0.8, 2, 500, 7.3, 0.001), inflosCDE)
decomposition(c(0, 0.052, 0.786, 0.8, 2, 500, 7.3, 0.001), inflosCDE)[[6]]
decomposition(c(0.099,
0.088,
0.541,
0.001,
74,
10900,
4.2
), inflosCDE)[[6]]
plot(decomposition(c(0.099,
0.088,
0.541,
0.001,
74,
10900,
4.2
), inflosCDE)[[6]][, 1])
plot(decomposition(c(0.099,
0.088,
0.541,
0.001,
74,
10900,
4.2
), inflosCDE)[[1]][, 1])
piege <- read.csv("../data/raw/piege0.csv")
piege
piege <- read.csv("../data/raw/piege0.csv", sep = ";")
piege
piege$nb.larves %>% summary()
which(piege$nb.larves == 237)
piege[480, ]
hist(piege$nb.larves)
plot(piege$nb.larves, type ="h")
plot(decomposition(c(0.099,
0.088,
0.541,
0.001,
74,
10900,
4.2
), inflosCDE)[[6]][, 1])

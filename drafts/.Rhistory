theme_bw() +
theme(legend.title = element_blank(), legend.position = "none") +
ggtitle("Estimation de référence\n\nPaillage synthétique") +
ylab("Nombre de larves") +
scale_color_manual(values = c("black", "green4")) +
guides(fill = guide_legend(ncol = 1),
color = guide_legend(ncol = 1))
eh2 <- data.frame(Date = date2017,
Observées = larves[, 3],
Référence = dec1[[1]][, 3],
Exogène = dec1[[2]][, 3],
Endogène = dec1[[3]][, 3],
Side = dec1[[4]][, 3]) %>%
gather(Exogène, Endogène, Side, key = provenance,
value = Nombre, factor_key = TRUE) %>%
ggplot +
aes(x = Date) +
geom_line(aes(y = Observées, color = "Observées")) +
geom_point(aes(y = Observées, color = "Observées")) +
geom_line(aes(y = Référence, color = "Référence")) +
geom_point(aes(y = Référence, color = "Référence")) +
geom_area(aes(y = Nombre, fill = provenance), alpha = 0.5) +
theme_bw() +
theme(legend.title = element_blank(), legend.position = "none") +
ggtitle("\n\nEnherbement haut") +
ylab("Nombre de larves") +
scale_color_manual(values = c("black", "green4")) +
guides(fill = guide_legend(ncol = 1),
color = guide_legend(ncol = 1))
grid.arrange(er2, ps2, eh2, ncol = 3)
dec2 <- decomposition2(arg2, inflos)
er3 <- data.frame(Date = date2017,
Observées = larves[, 1],
Référence = dec2[[1]][, 1],
Exogène = dec2[[2]][, 1],
Endogène = dec2[[3]][, 1],
Side = dec2[[4]][, 1]) %>%
gather(Exogène, Endogène, Side, key = provenance,
value = Nombre, factor_key = TRUE) %>%
ggplot +
aes(x = Date) +
geom_line(aes(y = Observées, color = "Observées")) +
geom_point(aes(y = Observées, color = "Observées")) +
geom_line(aes(y = Référence, color = "Référence")) +
geom_point(aes(y = Référence, color = "Référence")) +
geom_area(aes(y = Nombre, fill = provenance), alpha = 0.5) +
theme_bw() +
theme(legend.title = element_blank(), legend.position = "none") +
ggtitle("\n\nEnherbement ras") +
ylab("Nombre de larves") +
xlab("Date\n\n\n\n\n\n") +
scale_color_manual(values = c("black", "green4"))
ps3 <- data.frame(Date = date2017,
Observées = larves[, 2],
Référence = dec2[[1]][, 2],
Exogène = dec2[[2]][, 2],
Endogène = dec2[[3]][, 2],
Side = dec2[[4]][, 2]) %>%
gather(Exogène, Endogène, Side, key = provenance,
value = Nombre, factor_key = TRUE) %>%
ggplot +
aes(x = Date) +
geom_line(aes(y = Observées, color = "Observées")) +
geom_point(aes(y = Observées, color = "Observées")) +
geom_line(aes(y = Référence, color = "Référence")) +
geom_point(aes(y = Référence, color = "Référence")) +
geom_area(aes(y = Nombre, fill = provenance), alpha = 0.5) +
theme_bw() +
theme(legend.title = element_blank(), legend.position = "bottom") +
ggtitle("Nouvelle estimation \n \n Paillage synthétique") +
ylab("Nombre de larves") +
scale_color_manual(values = c("black", "green4")) +
guides(fill = guide_legend(ncol = 1),
color = guide_legend(ncol = 1))
eh3 <- data.frame(Date = date2017,
Observées = larves[, 3],
Référence = dec2[[1]][, 3],
Exogène = dec2[[2]][, 3],
Endogène = dec2[[3]][, 3],
Side = dec2[[4]][, 3]) %>%
gather(Exogène, Endogène, Side, key = provenance,
value = Nombre, factor_key = TRUE) %>%
ggplot +
aes(x = Date) +
geom_line(aes(y = Observées, color = "Observées")) +
geom_point(aes(y = Observées, color = "Observées")) +
geom_line(aes(y = Référence, color = "Référence")) +
geom_point(aes(y = Référence, color = "Référence")) +
geom_area(aes(y = Nombre, fill = provenance), alpha = 0.5) +
theme_bw() +
theme(legend.title = element_blank(), legend.position = "none") +
ggtitle("\n\nEnherbement haut") +
ylab("Nombre de larves") +
xlab("Date\n\n\n\n\n\n") +
scale_color_manual(values = c("black", "green4"))
grid.arrange(er3, ps3, eh3, ncol = 3)
grid.arrange(er2, ps2, eh2, er3, ps3, eh3, nrow = 2)
?grid.arrange
grid.arrange(er2, ps2, eh2, er3, ps3, eh3, nrow = 2, layout_matrix = c(1,2,1,2,1,2))
grid.arrange(er2, ps2, eh2, er3, ps3, eh3, nrow = 2, layout_matrix = matrix(c(1,2,1,2,1,2), nrow = 2))
grid.arrange(er2, ps2, eh2, er3, ps3, eh3, nrow = 2)
# Comparaison décomposition -----------------------------------------------
dec1 <- decomposition(arg1, inflos)
er2 <- data.frame(Date = date2017,
Observées = larves[, 1],
Référence = dec1[[1]][, 1],
Exogène = dec1[[2]][, 1],
Endogène = dec1[[3]][, 1],
Side = dec1[[4]][, 1]) %>%
gather(Exogène, Endogène, Side, key = provenance,
value = Nombre, factor_key = TRUE) %>%
ggplot +
aes(x = Date) +
geom_line(aes(y = Observées, color = "Observées")) +
geom_point(aes(y = Observées, color = "Observées")) +
geom_line(aes(y = Référence, color = "Référence")) +
geom_point(aes(y = Référence, color = "Référence")) +
geom_area(aes(y = Nombre, fill = provenance), alpha = 0.5) +
theme_bw() +
theme(legend.title = element_blank(), legend.position = "none") +
ggtitle("\n\nEnherbement ras") +
ylab("Nombre de larves") +
scale_color_manual(values = c("black", "green4")) +
guides(fill = guide_legend(ncol = 1),
color = guide_legend(ncol = 1))
ps2 <- data.frame(Date = date2017,
Observées = larves[, 2],
Référence = dec1[[1]][, 2],
Exogène = dec1[[2]][, 2],
Endogène = dec1[[3]][, 2],
Side = dec1[[4]][, 2]) %>%
gather(Exogène, Endogène, Side, key = provenance,
value = Nombre, factor_key = TRUE) %>%
ggplot +
aes(x = Date) +
geom_line(aes(y = Observées, color = "Observées")) +
geom_point(aes(y = Observées, color = "Observées")) +
geom_line(aes(y = Référence, color = "Référence")) +
geom_point(aes(y = Référence, color = "Référence")) +
geom_area(aes(y = Nombre, fill = provenance), alpha = 0.5) +
theme_bw() +
theme(legend.title = element_blank(), legend.position = "bottom") +
ggtitle("Estimation de référence\n\nPaillage synthétique") +
ylab("Nombre de larves") +
scale_color_manual(values = c("black", "green4")) +
guides(fill = guide_legend(ncol = 1),
color = guide_legend(ncol = 1))
eh2 <- data.frame(Date = date2017,
Observées = larves[, 3],
Référence = dec1[[1]][, 3],
Exogène = dec1[[2]][, 3],
Endogène = dec1[[3]][, 3],
Side = dec1[[4]][, 3]) %>%
gather(Exogène, Endogène, Side, key = provenance,
value = Nombre, factor_key = TRUE) %>%
ggplot +
aes(x = Date) +
geom_line(aes(y = Observées, color = "Observées")) +
geom_point(aes(y = Observées, color = "Observées")) +
geom_line(aes(y = Référence, color = "Référence")) +
geom_point(aes(y = Référence, color = "Référence")) +
geom_area(aes(y = Nombre, fill = provenance), alpha = 0.5) +
theme_bw() +
theme(legend.title = element_blank(), legend.position = "none") +
ggtitle("\n\nEnherbement haut") +
ylab("Nombre de larves") +
scale_color_manual(values = c("black", "green4")) +
guides(fill = guide_legend(ncol = 1),
color = guide_legend(ncol = 1))
grid.arrange(er2, ps2, eh2, ncol = 3)
dec2 <- decomposition2(arg2, inflos)
er3 <- data.frame(Date = date2017,
Observées = larves[, 1],
Référence = dec2[[1]][, 1],
Exogène = dec2[[2]][, 1],
Endogène = dec2[[3]][, 1],
Side = dec2[[4]][, 1]) %>%
gather(Exogène, Endogène, Side, key = provenance,
value = Nombre, factor_key = TRUE) %>%
ggplot +
aes(x = Date) +
geom_line(aes(y = Observées, color = "Observées")) +
geom_point(aes(y = Observées, color = "Observées")) +
geom_line(aes(y = Référence, color = "Référence")) +
geom_point(aes(y = Référence, color = "Référence")) +
geom_area(aes(y = Nombre, fill = provenance), alpha = 0.5) +
theme_bw() +
theme(legend.title = element_blank(), legend.position = "none") +
ggtitle("\n\nEnherbement ras") +
ylab("Nombre de larves") +
xlab("Date\n\n\n\n\n\n") +
scale_color_manual(values = c("black", "green4"))
ps3 <- data.frame(Date = date2017,
Observées = larves[, 2],
Référence = dec2[[1]][, 2],
Exogène = dec2[[2]][, 2],
Endogène = dec2[[3]][, 2],
Side = dec2[[4]][, 2]) %>%
gather(Exogène, Endogène, Side, key = provenance,
value = Nombre, factor_key = TRUE) %>%
ggplot +
aes(x = Date) +
geom_line(aes(y = Observées, color = "Observées")) +
geom_point(aes(y = Observées, color = "Observées")) +
geom_line(aes(y = Référence, color = "Référence")) +
geom_point(aes(y = Référence, color = "Référence")) +
geom_area(aes(y = Nombre, fill = provenance), alpha = 0.5) +
theme_bw() +
theme(legend.title = element_blank(), legend.position = "bottom") +
ggtitle("Nouvelle estimation \n \n Paillage synthétique") +
ylab("Nombre de larves") +
scale_color_manual(values = c("black", "green4")) +
guides(fill = guide_legend(ncol = 1),
color = guide_legend(ncol = 1))
eh3 <- data.frame(Date = date2017,
Observées = larves[, 3],
Référence = dec2[[1]][, 3],
Exogène = dec2[[2]][, 3],
Endogène = dec2[[3]][, 3],
Side = dec2[[4]][, 3]) %>%
gather(Exogène, Endogène, Side, key = provenance,
value = Nombre, factor_key = TRUE) %>%
ggplot +
aes(x = Date) +
geom_line(aes(y = Observées, color = "Observées")) +
geom_point(aes(y = Observées, color = "Observées")) +
geom_line(aes(y = Référence, color = "Référence")) +
geom_point(aes(y = Référence, color = "Référence")) +
geom_area(aes(y = Nombre, fill = provenance), alpha = 0.5) +
theme_bw() +
theme(legend.title = element_blank(), legend.position = "none") +
ggtitle("\n\nEnherbement haut") +
ylab("Nombre de larves") +
xlab("Date\n\n\n\n\n\n") +
scale_color_manual(values = c("black", "green4"))
grid.arrange(er3, ps3, eh3, ncol = 3)
grid.arrange(er2, ps2, eh2, er3, ps3, eh3, nrow = 2)
# Comparaison décomposition -----------------------------------------------
dec1 <- decomposition(arg1, inflos)
er2 <- data.frame(Date = date2017,
Observées = larves[, 1],
Référence = dec1[[1]][, 1],
Exogène = dec1[[2]][, 1],
Endogène = dec1[[3]][, 1],
Side = dec1[[4]][, 1]) %>%
gather(Exogène, Endogène, Side, key = provenance,
value = Nombre, factor_key = TRUE) %>%
ggplot +
aes(x = Date) +
geom_line(aes(y = Observées, color = "Observées")) +
geom_point(aes(y = Observées, color = "Observées")) +
geom_line(aes(y = Référence, color = "Référence")) +
geom_point(aes(y = Référence, color = "Référence")) +
geom_area(aes(y = Nombre, fill = provenance), alpha = 0.5) +
theme_bw() +
theme(legend.title = element_blank(), legend.position = "none") +
ggtitle("\n\nEnherbement ras") +
ylab("Nombre de larves") +
xlab("Date\n\n\n\n\n\n") +
scale_color_manual(values = c("black", "green4")) +
guides(fill = guide_legend(ncol = 1),
color = guide_legend(ncol = 1))
ps2 <- data.frame(Date = date2017,
Observées = larves[, 2],
Référence = dec1[[1]][, 2],
Exogène = dec1[[2]][, 2],
Endogène = dec1[[3]][, 2],
Side = dec1[[4]][, 2]) %>%
gather(Exogène, Endogène, Side, key = provenance,
value = Nombre, factor_key = TRUE) %>%
ggplot +
aes(x = Date) +
geom_line(aes(y = Observées, color = "Observées")) +
geom_point(aes(y = Observées, color = "Observées")) +
geom_line(aes(y = Référence, color = "Référence")) +
geom_point(aes(y = Référence, color = "Référence")) +
geom_area(aes(y = Nombre, fill = provenance), alpha = 0.5) +
theme_bw() +
theme(legend.title = element_blank(), legend.position = "bottom") +
ggtitle("Estimation de référence\n\nPaillage synthétique") +
ylab("Nombre de larves") +
scale_color_manual(values = c("black", "green4")) +
guides(fill = guide_legend(ncol = 1),
color = guide_legend(ncol = 1))
eh2 <- data.frame(Date = date2017,
Observées = larves[, 3],
Référence = dec1[[1]][, 3],
Exogène = dec1[[2]][, 3],
Endogène = dec1[[3]][, 3],
Side = dec1[[4]][, 3]) %>%
gather(Exogène, Endogène, Side, key = provenance,
value = Nombre, factor_key = TRUE) %>%
ggplot +
aes(x = Date) +
geom_line(aes(y = Observées, color = "Observées")) +
geom_point(aes(y = Observées, color = "Observées")) +
geom_line(aes(y = Référence, color = "Référence")) +
geom_point(aes(y = Référence, color = "Référence")) +
geom_area(aes(y = Nombre, fill = provenance), alpha = 0.5) +
theme_bw() +
theme(legend.title = element_blank(), legend.position = "none") +
ggtitle("\n\nEnherbement haut") +
ylab("Nombre de larves") +
xlab("Date\n\n\n\n\n\n") +
scale_color_manual(values = c("black", "green4")) +
guides(fill = guide_legend(ncol = 1),
color = guide_legend(ncol = 1))
grid.arrange(er2, ps2, eh2, ncol = 3)
dec2 <- decomposition2(arg2, inflos)
er3 <- data.frame(Date = date2017,
Observées = larves[, 1],
Référence = dec2[[1]][, 1],
Exogène = dec2[[2]][, 1],
Endogène = dec2[[3]][, 1],
Side = dec2[[4]][, 1]) %>%
gather(Exogène, Endogène, Side, key = provenance,
value = Nombre, factor_key = TRUE) %>%
ggplot +
aes(x = Date) +
geom_line(aes(y = Observées, color = "Observées")) +
geom_point(aes(y = Observées, color = "Observées")) +
geom_line(aes(y = Référence, color = "Référence")) +
geom_point(aes(y = Référence, color = "Référence")) +
geom_area(aes(y = Nombre, fill = provenance), alpha = 0.5) +
theme_bw() +
theme(legend.title = element_blank(), legend.position = "none") +
ggtitle("\n\nEnherbement ras") +
ylab("Nombre de larves") +
xlab("Date\n\n\n\n\n\n") +
scale_color_manual(values = c("black", "green4"))
ps3 <- data.frame(Date = date2017,
Observées = larves[, 2],
Référence = dec2[[1]][, 2],
Exogène = dec2[[2]][, 2],
Endogène = dec2[[3]][, 2],
Side = dec2[[4]][, 2]) %>%
gather(Exogène, Endogène, Side, key = provenance,
value = Nombre, factor_key = TRUE) %>%
ggplot +
aes(x = Date) +
geom_line(aes(y = Observées, color = "Observées")) +
geom_point(aes(y = Observées, color = "Observées")) +
geom_line(aes(y = Référence, color = "Référence")) +
geom_point(aes(y = Référence, color = "Référence")) +
geom_area(aes(y = Nombre, fill = provenance), alpha = 0.5) +
theme_bw() +
theme(legend.title = element_blank(), legend.position = "bottom") +
ggtitle("Nouvelle estimation \n \n Paillage synthétique") +
ylab("Nombre de larves") +
scale_color_manual(values = c("black", "green4")) +
guides(fill = guide_legend(ncol = 1),
color = guide_legend(ncol = 1))
eh3 <- data.frame(Date = date2017,
Observées = larves[, 3],
Référence = dec2[[1]][, 3],
Exogène = dec2[[2]][, 3],
Endogène = dec2[[3]][, 3],
Side = dec2[[4]][, 3]) %>%
gather(Exogène, Endogène, Side, key = provenance,
value = Nombre, factor_key = TRUE) %>%
ggplot +
aes(x = Date) +
geom_line(aes(y = Observées, color = "Observées")) +
geom_point(aes(y = Observées, color = "Observées")) +
geom_line(aes(y = Référence, color = "Référence")) +
geom_point(aes(y = Référence, color = "Référence")) +
geom_area(aes(y = Nombre, fill = provenance), alpha = 0.5) +
theme_bw() +
theme(legend.title = element_blank(), legend.position = "none") +
ggtitle("\n\nEnherbement haut") +
ylab("Nombre de larves") +
xlab("Date\n\n\n\n\n\n") +
scale_color_manual(values = c("black", "green4"))
grid.arrange(er3, ps3, eh3, ncol = 3)
grid.arrange(er2, ps2, eh2, er3, ps3, eh3, nrow = 2)
dev.copy2eps(file = "toto.eps", device = cairo_ps())
cairo_ps("toto.eps", height = 9)
?cairo_ps
ggsave("toto.eps", height = 9)
ggsave("toto.eps", height = 9, device = cairo_ps())
ggsave("toto.eps", height = 9, device = cairo_ps
)
dev.copy2eps(file = "toto.eps", device = cairo_ps)
install.packages(cowplot)
install.packages("cowplot")
final <- cowplot::plot_grid(er2, ps2, eh2, er3, ps3, eh3, nrow = 2)
final
ggsave(final, filename = "decompopo.eps", device = cairo_ps, height = 9)
ggsave(final, filename = "decompopo.eps", device = cairo_ps, height = 12)
ggsave(final, filename = "decompopo.eps", device = cairo_ps, height = 9)
# Nouvelle référence ------------------------------------------------------
inflos_simulated <- read.csv("../data/attractive_simulated.csv")
set.seed(1848)
res_ref <- nsga2(obj2, 5, 3, inflos_simulated,
lower.bounds = c(0, 0, 0, 0, 1),
upper.bounds = c(1, 1, 1, 1, 70),
popsize = 200, generations = 200)
indref <- res_ref$value %>% as_tibble %>%
mutate(norm = abs(V1 + V2 + V3)) %$%
which.min(norm)
argref <- res_ref$par[indref, ]
inflos_simulated
# Nouvelle référence ------------------------------------------------------
inflos_simulated <- read.csv("../data/attractive_simulated.csv")[3:5] %>% as.matrix()
set.seed(1848)
res_ref <- nsga2(obj2, 5, 3, inflos_simulated,
lower.bounds = c(0, 0, 0, 0, 1),
upper.bounds = c(1, 1, 1, 1, 70),
popsize = 200, generations = 200)
indref <- res_ref$value %>% as_tibble %>%
mutate(norm = abs(V1 + V2 + V3)) %$%
which.min(norm)
argref <- res_ref$par[indref, ]
# Nouvelle référence ------------------------------------------------------
inflos_simulated <- read.csv("../data/attractive_simulated.csv")[3:5] %>% as.matrix()
set.seed(1848)
res_ref <- nsga2(obj2, 5, 3, inflos_simulated,
lower.bounds = c(0, 0, 0, 0, 1),
upper.bounds = c(1, 1, 1, 1, 70),
popsize = 200, generations = 200)
indref <- res_ref$value %>% as_tibble %>%
mutate(norm = abs(V1 + V2 + V3)) %$%
which.min(norm)
argref <- res_ref$par[indref, ]
argref
round(argref, 3)
estimation <- dynamics2(argref, inflos_simulated)
to_plot <- bind_rows(p1, p2, p3)
p1 <- data.frame(Date = date2017,
Observées = larves[, 1],
Estimées = estimation[, 1],
Sol = factor("ER", levels = c("ER", "PS", "EH")))
p2 <- data.frame(Date = date2017,
Observées = larves[, 2],
Estimées = estimation[, 2],
Sol = factor("PS", levels = c("ER", "PS", "EH")))
p3 <- data.frame(Date = date2017,
Observées = larves[, 3],
Estimées = estimation[, 3],
Sol = factor("EH", levels = c("ER", "PS", "EH")))
to_plot <- bind_rows(p1, p2, p3)
to_plot
to_plot %>%
gather(Observées, Estimées, key = statut, value = Nombre, factor_key = TRUE) %>%
ggplot() +
aes(x = Date, y = Nombre, color = statut) +
geom_point() +
geom_line() +
ylab("Nombre de larves") +
theme_bw() +
theme(legend.title = element_blank()) +
facet_grid(. ~ Sol)
to_plot %>%
gather(Observées, Estimées, key = statut, value = Nombre, factor_key = TRUE) %>%
ggplot() +
aes(x = Date, y = Nombre, color = statut) +
geom_point() +
geom_line() +
ylab("Nombre de larves") +
theme_bw() +
theme(legend.title = element_blank(), legend.position = "bottom") +
facet_grid(. ~ Sol)
to_plot %>%
gather(Observées, Estimées, key = statut, value = Nombre, factor_key = TRUE) %>%
ggplot() +
aes(x = Date, y = Nombre, color = statut) +
geom_point() +
geom_line() +
ylab("Nombre de larves") +
theme_bw() +
theme(legend.title = element_blank(), legend.position = "bottom") +
facet_grid(. ~ Sol) +
scale_color_manual(c("black", "green4"))
to_plot %>%
gather(Observées, Estimées, key = statut, value = Nombre, factor_key = TRUE) %>%
ggplot() +
aes(x = Date, y = Nombre, color = statut) +
geom_point() +
geom_line() +
ylab("Nombre de larves") +
theme_bw() +
theme(legend.title = element_blank(), legend.position = "bottom") +
facet_grid(. ~ Sol) +
scale_color_manual(values = c("black", "green4"))
p1 <- data.frame(Date = date2017,
Observées = larves[, 1],
Estimées = estimation[, 1],
Sol = factor("Enherbement ras",
levels = c("Enherbement ras", "Paillage synthétique", "Enherbement haut")))
p2 <- data.frame(Date = date2017,
Observées = larves[, 2],
Estimées = estimation[, 2],
Sol = factor("Paillage synthétique",
levels = c("Enherbement ras", "Paillage synthétique", "Enherbement haut")))
p3 <- data.frame(Date = date2017,
Observées = larves[, 3],
Estimées = estimation[, 3],
Sol = factor("Enherbement haut",
levels = c("Enherbement ras", "Paillage synthétique", "Enherbement haut")))
to_plot <- bind_rows(p1, p2, p3)
to_plot %>%
gather(Observées, Estimées, key = statut, value = Nombre, factor_key = TRUE) %>%
ggplot() +
aes(x = Date, y = Nombre, color = statut) +
geom_point() +
geom_line() +
ylab("Nombre de larves") +
theme_bw() +
theme(legend.title = element_blank(), legend.position = "bottom") +
facet_grid(. ~ Sol) +
scale_color_manual(values = c("black", "green4"))
argref %>% round(3)

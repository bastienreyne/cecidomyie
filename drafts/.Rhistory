aes(x = Date) +
geom_line(aes(y = Observés), col = "black") +
geom_line(aes(y = Référence), col = "blue") +
geom_line(aes(y = Nouveau_pm), col = "green4") +
geom_point(aes(y = Observés), col = "black") +
geom_point(aes(y = Référence), col = "blue") +
geom_point(aes(y = Nouveau_pm), col = "green4") +
theme_bw()
df_eh %>% ggplot +
aes(x = Date) +
geom_line(aes(y = Observés), col = "black") +
geom_line(aes(y = Référence), col = "blue") +
geom_line(aes(y = Nouveau_pm), col = "green4") +
geom_point(aes(y = Observés), col = "black") +
geom_point(aes(y = Référence), col = "blue") +
geom_point(aes(y = Nouveau_pm), col = "green4") +
theme_bw()
rm(list = ls())
source('~/cecidomyie/drafts/test_new_pm.R')
laps <- c(7, 7, 7, 8, 2, 5, 2, 4, 3, 5, 2, 5, 2, 5, 2, 4, 3, 4, 3)
true_index <- which(date2017 %in% true_date)
true_index <- which(date2017 %in% true_date2017)
rm(list = ls())
source('~/cecidomyie/drafts/test_new_pm.R')
rm(list = ls())
source('~/cecidomyie/drafts/test_new_pm.R')
source('~/cecidomyie/drafts/test_new_pm.R')
ref <- dynamics2(arg1, inflos)
new <- dynamics4(arg2, inflos)
df_er <- data.frame(Date = date2017,
Observés = larves_ER,
Référence = ref[, 1],
Nouveau_pm = new[, 1])
df_er %>% ggplot +
aes(x = Date) +
geom_line(aes(y = Observés), col = "black") +
geom_line(aes(y = Référence), col = "blue") +
geom_line(aes(y = Nouveau_pm), col = "green4") +
geom_point(aes(y = Observés), col = "black") +
geom_point(aes(y = Référence), col = "blue") +
geom_point(aes(y = Nouveau_pm), col = "green4") +
theme_bw()
df_ps <- data.frame(Date = date2017,
Observés = larves_PS,
Référence = ref[, 2],
Nouveau_pm = new[, 2])
df_ps %>% ggplot +
aes(x = Date) +
geom_line(aes(y = Observés), col = "black") +
geom_line(aes(y = Référence), col = "blue") +
geom_line(aes(y = Nouveau_pm), col = "green4") +
geom_point(aes(y = Observés), col = "black") +
geom_point(aes(y = Référence), col = "blue") +
geom_point(aes(y = Nouveau_pm), col = "green4") +
theme_bw()
df_eh <- data.frame(Date = date2017,
Observés = larves_EH,
Référence = ref[, 3],
Nouveau_pm = new[, 3])
df_eh %>% ggplot +
aes(x = Date) +
geom_line(aes(y = Observés), col = "black") +
geom_line(aes(y = Référence), col = "blue") +
geom_line(aes(y = Nouveau_pm), col = "green4") +
geom_point(aes(y = Observés), col = "black") +
geom_point(aes(y = Référence), col = "blue") +
geom_point(aes(y = Nouveau_pm), col = "green4") +
theme_bw()
ref <- dynamics2(arg1, inflos)
new <- dynamics4(arg2, inflos)
df_er <- data.frame(Date = date2017,
Observés = larves_ER,
Référence = ref[, 1],
Nouveau_pm = new[, 1])
df_er %>% ggplot +
aes(x = Date) +
geom_line(aes(y = Observés), col = "black") +
geom_line(aes(y = Référence), col = "blue") +
geom_line(aes(y = Nouveau_pm), col = "green4") +
geom_point(aes(y = Observés), col = "black") +
geom_point(aes(y = Référence), col = "blue") +
geom_point(aes(y = Nouveau_pm), col = "green4") +
theme_bw()
df_ps <- data.frame(Date = date2017,
Observés = larves_PS,
Référence = ref[, 2],
Nouveau_pm = new[, 2])
df_ps %>% ggplot +
aes(x = Date) +
geom_line(aes(y = Observés), col = "black") +
geom_line(aes(y = Référence), col = "blue") +
geom_line(aes(y = Nouveau_pm), col = "green4") +
geom_point(aes(y = Observés), col = "black") +
geom_point(aes(y = Référence), col = "blue") +
geom_point(aes(y = Nouveau_pm), col = "green4") +
theme_bw()
df_eh <- data.frame(Date = date2017,
Observés = larves_EH,
Référence = ref[, 3],
Nouveau_pm = new[, 3])
df_eh %>% ggplot +
aes(x = Date) +
geom_line(aes(y = Observés), col = "black") +
geom_line(aes(y = Référence), col = "blue") +
geom_line(aes(y = Nouveau_pm), col = "green4") +
geom_point(aes(y = Observés), col = "black") +
geom_point(aes(y = Référence), col = "blue") +
geom_point(aes(y = Nouveau_pm), col = "green4") +
theme_bw()
source('~/cecidomyie/drafts/test_new_pm.R')
# Plots -------------------------------------------------------------------
ref <- dynamics2(arg1, inflos)
new <- dynamics4(arg2, inflos)
df_er <- data.frame(Date = date2017,
Observés = larves_ER,
Référence = ref[, 1],
Nouveau_pm = new[, 1])
df_er %>% ggplot +
aes(x = Date) +
geom_line(aes(y = Observés), col = "black") +
geom_line(aes(y = Référence), col = "blue") +
geom_line(aes(y = Nouveau_pm), col = "green4") +
geom_point(aes(y = Observés), col = "black") +
geom_point(aes(y = Référence), col = "blue") +
geom_point(aes(y = Nouveau_pm), col = "green4") +
theme_bw()
df_ps <- data.frame(Date = date2017,
Observés = larves_PS,
Référence = ref[, 2],
Nouveau_pm = new[, 2])
df_ps %>% ggplot +
aes(x = Date) +
geom_line(aes(y = Observés), col = "black") +
geom_line(aes(y = Référence), col = "blue") +
geom_line(aes(y = Nouveau_pm), col = "green4") +
geom_point(aes(y = Observés), col = "black") +
geom_point(aes(y = Référence), col = "blue") +
geom_point(aes(y = Nouveau_pm), col = "green4") +
theme_bw()
df_eh <- data.frame(Date = date2017,
Observés = larves_EH,
Référence = ref[, 3],
Nouveau_pm = new[, 3])
df_eh %>% ggplot +
aes(x = Date) +
geom_line(aes(y = Observés), col = "black") +
geom_line(aes(y = Référence), col = "blue") +
geom_line(aes(y = Nouveau_pm), col = "green4") +
geom_point(aes(y = Observés), col = "black") +
geom_point(aes(y = Référence), col = "blue") +
geom_point(aes(y = Nouveau_pm), col = "green4") +
theme_bw()
rm(list = ls())
source('~/cecidomyie/drafts/test_new_pm.R')
ref <- dynamics2(arg1, inflos)
new <- dynamics4(arg2, inflos)
df_er <- data.frame(Date = date2017,
Observés = larves_ER,
Référence = ref[, 1],
Nouveau_pm = new[, 1])
df_er %>% ggplot +
aes(x = Date) +
geom_line(aes(y = Observés), col = "black") +
geom_line(aes(y = Référence), col = "blue") +
geom_line(aes(y = Nouveau_pm), col = "green4") +
geom_point(aes(y = Observés), col = "black") +
geom_point(aes(y = Référence), col = "blue") +
geom_point(aes(y = Nouveau_pm), col = "green4") +
theme_bw()
df_ps <- data.frame(Date = date2017,
Observés = larves_PS,
Référence = ref[, 2],
Nouveau_pm = new[, 2])
df_ps %>% ggplot +
aes(x = Date) +
geom_line(aes(y = Observés), col = "black") +
geom_line(aes(y = Référence), col = "blue") +
geom_line(aes(y = Nouveau_pm), col = "green4") +
geom_point(aes(y = Observés), col = "black") +
geom_point(aes(y = Référence), col = "blue") +
geom_point(aes(y = Nouveau_pm), col = "green4") +
theme_bw()
df_eh <- data.frame(Date = date2017,
Observés = larves_EH,
Référence = ref[, 3],
Nouveau_pm = new[, 3])
df_eh %>% ggplot +
aes(x = Date) +
geom_line(aes(y = Observés), col = "black") +
geom_line(aes(y = Référence), col = "blue") +
geom_line(aes(y = Nouveau_pm), col = "green4") +
geom_point(aes(y = Observés), col = "black") +
geom_point(aes(y = Référence), col = "blue") +
geom_point(aes(y = Nouveau_pm), col = "green4") +
theme_bw()
# Plots -------------------------------------------------------------------
ref <- dynamics2(arg1, inflos)
new <- dynamics4(arg2, inflos)
df_er <- data.frame(Date = date2017,
Observés = larves_ER,
Référence = ref[, 1],
Nouveau_pm = new[, 1])
df_er %>% ggplot +
aes(x = Date) +
geom_line(aes(y = Observés), col = "black") +
geom_line(aes(y = Référence), col = "blue") +
geom_line(aes(y = Nouveau_pm), col = "green4") +
geom_point(aes(y = Observés), col = "black") +
geom_point(aes(y = Référence), col = "blue") +
geom_point(aes(y = Nouveau_pm), col = "green4") +
theme_bw()
df_ps <- data.frame(Date = date2017,
Observés = larves_PS,
Référence = ref[, 2],
Nouveau_pm = new[, 2])
df_ps %>% ggplot +
aes(x = Date) +
geom_line(aes(y = Observés), col = "black") +
geom_line(aes(y = Référence), col = "blue") +
geom_line(aes(y = Nouveau_pm), col = "green4") +
geom_point(aes(y = Observés), col = "black") +
geom_point(aes(y = Référence), col = "blue") +
geom_point(aes(y = Nouveau_pm), col = "green4") +
theme_bw()
df_eh <- data.frame(Date = date2017,
Observés = larves_EH,
Référence = ref[, 3],
Nouveau_pm = new[, 3])
df_eh %>% ggplot +
aes(x = Date) +
geom_line(aes(y = Observés), col = "black") +
geom_line(aes(y = Référence), col = "blue") +
geom_line(aes(y = Nouveau_pm), col = "green4") +
geom_point(aes(y = Observés), col = "black") +
geom_point(aes(y = Référence), col = "blue") +
geom_point(aes(y = Nouveau_pm), col = "green4") +
theme_bw()
arg1
arg2
source('~/cecidomyie/drafts/test_new_pm.R')
# Plots -------------------------------------------------------------------
ref <- dynamics2(arg1, inflos)
new <- dynamics4(arg2, inflos)
df_er <- data.frame(Date = date2017,
Observés = larves_ER,
Référence = ref[, 1],
Nouveau_pm = new[, 1])
df_er %>% ggplot +
aes(x = Date) +
geom_line(aes(y = Observés), col = "black") +
geom_line(aes(y = Référence), col = "blue") +
geom_line(aes(y = Nouveau_pm), col = "green4") +
geom_point(aes(y = Observés), col = "black") +
geom_point(aes(y = Référence), col = "blue") +
geom_point(aes(y = Nouveau_pm), col = "green4") +
theme_bw()
df_ps <- data.frame(Date = date2017,
Observés = larves_PS,
Référence = ref[, 2],
Nouveau_pm = new[, 2])
df_ps %>% ggplot +
aes(x = Date) +
geom_line(aes(y = Observés), col = "black") +
geom_line(aes(y = Référence), col = "blue") +
geom_line(aes(y = Nouveau_pm), col = "green4") +
geom_point(aes(y = Observés), col = "black") +
geom_point(aes(y = Référence), col = "blue") +
geom_point(aes(y = Nouveau_pm), col = "green4") +
theme_bw()
df_eh <- data.frame(Date = date2017,
Observés = larves_EH,
Référence = ref[, 3],
Nouveau_pm = new[, 3])
df_eh %>% ggplot +
aes(x = Date) +
geom_line(aes(y = Observés), col = "black") +
geom_line(aes(y = Référence), col = "blue") +
geom_line(aes(y = Nouveau_pm), col = "green4") +
geom_point(aes(y = Observés), col = "black") +
geom_point(aes(y = Référence), col = "blue") +
geom_point(aes(y = Nouveau_pm), col = "green4") +
theme_bw()
source('~/cecidomyie/model_R/model.R')
source('~/cecidomyie/drafts/test_new_pm.R')
# Plots -------------------------------------------------------------------
ref <- dynamics2(arg1, inflos)
new <- dynamics4(arg2, inflos)
df_er <- data.frame(Date = date2017,
Observés = larves_ER,
Référence = ref[, 1],
Nouveau_pm = new[, 1])
df_er %>% ggplot +
aes(x = Date) +
geom_line(aes(y = Observés), col = "black") +
geom_line(aes(y = Référence), col = "blue") +
geom_line(aes(y = Nouveau_pm), col = "green4") +
geom_point(aes(y = Observés), col = "black") +
geom_point(aes(y = Référence), col = "blue") +
geom_point(aes(y = Nouveau_pm), col = "green4") +
theme_bw()
df_ps <- data.frame(Date = date2017,
Observés = larves_PS,
Référence = ref[, 2],
Nouveau_pm = new[, 2])
df_ps %>% ggplot +
aes(x = Date) +
geom_line(aes(y = Observés), col = "black") +
geom_line(aes(y = Référence), col = "blue") +
geom_line(aes(y = Nouveau_pm), col = "green4") +
geom_point(aes(y = Observés), col = "black") +
geom_point(aes(y = Référence), col = "blue") +
geom_point(aes(y = Nouveau_pm), col = "green4") +
theme_bw()
df_eh <- data.frame(Date = date2017,
Observés = larves_EH,
Référence = ref[, 3],
Nouveau_pm = new[, 3])
df_eh %>% ggplot +
aes(x = Date) +
geom_line(aes(y = Observés), col = "black") +
geom_line(aes(y = Référence), col = "blue") +
geom_line(aes(y = Nouveau_pm), col = "green4") +
geom_point(aes(y = Observés), col = "black") +
geom_point(aes(y = Référence), col = "blue") +
geom_point(aes(y = Nouveau_pm), col = "green4") +
theme_bw()
rm(list = ls())
source('~/cecidomyie/drafts/test_new_pm.R')
rm(list = ls())
er1
er2
ps1
ps2
eh1
eh2
# New test ----------------------------------------------------------------
objectif <- function(x, my_function, inflos){
larves_estimees <- dynamics2(x, inflos)
larvesER <- larves_estimees[, 1]
larvesPS <- larves_estimees[, 2]
larvesEH <- larves_estimees[, 3]
larves_est <- matrix(NA, nrow = length(laps), ncol = 3)
for (i in 1:length(laps)) {
indices <- (true_index[i] - laps[i] + 1):true_index[i]
larves_est[i, ] <- c(mean(larvesER[indices]),
mean(larvesPS[indices]),
mean(larvesEH[indices]))
}
larves_observed <- larves2017[true_index, ]
return(c(my_function(larves_est[, 1], larves_observed[, 1]),
my_function(larves_est[, 2], larves_observed[, 2]),
my_function(larves_est[, 3], larves_observed[, 3])))
}
res_c <- nsga2(objectif, 5, 3, my_mae, inflos,
lower.bounds = rep(0,5),
upper.bounds = c(10,1,1,1,10),
popsize = 100, generations = 50)
ind_opt_c <- res_c$value %>% as_tibble %>%
mutate(norm = abs(V1 + V2 + V3)) %$%
which.min(norm)
arg_opt_c <- res_c$par[ind_opt_c, ]
test <- dynamics2(arg_opt_c, inflos)
source('~/cecidomyie/drafts/test_new_pm.R')
source('~/cecidomyie/drafts/test_new_pm.R')
df_pst <- data.frame(Date = date2017,
Observés = larves_PS,
Test = test[, 2]) %>%
gather(Observés, Test, key = statut, value = Nombre) %>%
ggplot() +
aes(x = Date, y = Nombre, color = statut) +
geom_line() +
geom_point() +
theme_bw()
df_pst
source('~/cecidomyie/drafts/test_new_pm.R')
source('~/cecidomyie/drafts/test_new_pm.R')
arg_opt_c
df_ert <- data.frame(Date = date2017,
Observés = larves_PS,
Test = test[, 1]) %>%
gather(Observés, Test, key = statut, value = Nombre) %>%
ggplot() +
aes(x = Date, y = Nombre, color = statut) +
geom_line() +
geom_point() +
theme_bw()
df_eht <- data.frame(Date = date2017,
Observés = larves_PS,
Test = test[, 3]) %>%
gather(Observés, Test, key = statut, value = Nombre) %>%
ggplot() +
aes(x = Date, y = Nombre, color = statut) +
geom_line() +
geom_point() +
theme_bw()
df_ert
df_eht
arg_opt_c
source('~/cecidomyie/drafts/test_new_pm.R')
# New test ----------------------------------------------------------------
objectif <- function(x, my_function, inflos){
larves_estimees <- dynamics2(x, inflos)
larvesER <- larves_estimees[, 1]
larvesPS <- larves_estimees[, 2]
larvesEH <- larves_estimees[, 3]
larves_est <- matrix(NA, nrow = length(laps), ncol = 3)
for (i in 1:length(laps)) {
indices <- (true_index[i] - laps[i] + 1):true_index[i]
larves_est[i, ] <- c(mean(larvesER[indices]),
mean(larvesPS[indices]),
mean(larvesEH[indices]))
}
larves_observed <- larves[true_index, ]
return(c(my_function(larves_est[, 1], larves_observed[, 1]),
my_function(larves_est[, 2], larves_observed[, 2]),
my_function(larves_est[, 3], larves_observed[, 3])))
}
res_c <- nsga2(objectif, 5, 3, my_mae, inflos,
lower.bounds = rep(0,5),
upper.bounds = c(10,1,1,1,10),
popsize = 100, generations = 100)
ind_opt_c <- res_c$value %>% as_tibble %>%
mutate(norm = abs(V1 + V2 + V3)) %$%
which.min(norm)
arg_opt_c <- res_c$par[ind_opt_c, ]
test <- dynamics2(arg_opt_c, inflos)
df_eht <- data.frame(Date = date2017,
Observés = larves_PS,
Test = test[, 3]) %>%
gather(Observés, Test, key = statut, value = Nombre) %>%
ggplot() +
aes(x = Date, y = Nombre, color = statut) +
geom_line() +
geom_point() +
theme_bw()
df_eht
source('~/cecidomyie/drafts/test_new_pm.R')
df_eht
df_eht <- data.frame(Date = date2017,
Observés = larves_PS,
Test = test[, 3]) %>%
gather(Observés, Test, key = statut, value = Nombre) %>%
ggplot() +
aes(x = Date, y = Nombre, color = statut) +
geom_line() +
geom_point() +
theme_bw()
df_eht
rm(list = ls())
source('~/cecidomyie/drafts/test_new_pm.R')
source('~/cecidomyie/drafts/test_new_pm.R')
df_eht <- data.frame(Date = date2017,
Observés = larves_PS,
Test = test[, 3]) %>%
gather(Observés, Test, key = statut, value = Nombre) %>%
ggplot() +
aes(x = Date, y = Nombre, color = statut) +
geom_line() +
geom_point() +
theme_bw()
df_eht
rm(list = ls())
source('~/cecidomyie/drafts/test_new_pm.R')
source('~/cecidomyie/drafts/test_new_pm.R')
rm(list = ls())
source('~/cecidomyie/drafts/test_new_pm.R')
df_er <- data.frame(Date = date2017,
Observés = larves_ER,
Référence = ref[, 1],
Nouveau_pm = ref2[, 1])
er2 <- df_er %>% ggplot +
aes(x = Date) +
geom_line(aes(y = Observés), col = "black") +
geom_line(aes(y = Référence), col = "blue") +
geom_line(aes(y = Nouveau_pm), col = "green4") +
geom_point(aes(y = Observés), col = "black") +
geom_point(aes(y = Référence), col = "blue") +
geom_point(aes(y = Nouveau_pm), col = "green4") +
theme_bw()
er2
df_ps <- data.frame(Date = date2017,
Observés = larves_PS,
Référence = ref[, 2],
Nouveau_pm = ref2[, 2])
ps2 <- df_ps %>% ggplot +
aes(x = Date) +
geom_line(aes(y = Observés), col = "black") +
geom_line(aes(y = Référence), col = "blue") +
geom_line(aes(y = Nouveau_pm), col = "green4") +
geom_point(aes(y = Observés), col = "black") +
geom_point(aes(y = Référence), col = "blue") +
geom_point(aes(y = Nouveau_pm), col = "green4") +
theme_bw()
df_eh <- data.frame(Date = date2017,
Observés = larves_EH,
Référence = ref[, 3],
Nouveau_pm = ref2[, 3])
eh2 <- df_eh %>% ggplot +
aes(x = Date) +
geom_line(aes(y = Observés), col = "black") +
geom_line(aes(y = Référence), col = "blue") +
geom_line(aes(y = Nouveau_pm), col = "green4") +
geom_point(aes(y = Observés), col = "black") +
geom_point(aes(y = Référence), col = "blue") +
geom_point(aes(y = Nouveau_pm), col = "green4") +
theme_bw()
ps2
eh2
obj4(arg4, inflos)
obj3(arg4, inflos)
obj2(arg4, inflos)
obj1(arg4, inflos)

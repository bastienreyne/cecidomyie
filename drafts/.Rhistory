#
# ind_opt2 <- res2$value %>% as_tibble %>%
#     mutate(norm = abs(V1 + V2 + V3)) %$%
#     which.min(norm)
#
# arg_opt2 <- res2$par[ind_opt2, ]
source('~/cecidomyie/drafts/decomposition.R')
source('~/cecidomyie/drafts/test_param_saisonnalité.R')
to_plot %>% ggplot(aes(x = date, y = nombre, color = statut)) +
geom_point() +
geom_line(lwd = 0.75) +
theme_bw() +
# geom_line(data = inflo, aes(x = date, y = inflo), col = "black") +
facet_grid(. ~ Sol)
larves_er_ref <- cbind(date = date2017, obs = larves2017[, 1], ref = larves_cla[, 1]) %>%
as_tibble %>%
mutate_at("date", as_date) %>%
gather(obs, ref, key = statut, value = nombre, factor_key = TRUE) %>%
mutate(Sol = factor("ER", levels = c("ER", "PS", "EH")))
larves_ps_ref <- cbind(date = date2017, obs = larves2017[, 2], ref = larves_cla[, 2]) %>%
as_tibble %>%
mutate_at("date", as_date) %>%
gather(obs, ref, key = statut, value = nombre, factor_key = TRUE) %>%
mutate(Sol = factor("PS", levels = c("ER", "PS", "EH")))
larves_eh_ref <- cbind(date = date2017, obs = larves2017[, 3], ref = larves_cla[, 3]) %>%
as_tibble %>%
mutate_at("date", as_date) %>%
gather(obs, ref, key = statut, value = nombre, factor_key = TRUE) %>%
mutate(Sol = factor("EH", levels = c("ER", "PS", "EH")))
larves_ref <- bind_rows(larves_er_ref, larves_ps_ref, larves_eh_ref)
to_plot <- bind_rows(larves_er, larves_ps, larves_eh, larves_er_ref, larves_ps_ref, larves_eh_ref) %>%
mutate_at("statut", as_factor)
to_plot %>% ggplot(aes(x = date, y = nombre, color = statut)) +
geom_point() +
geom_line(lwd = 0.75) +
theme_bw() +
# geom_line(data = inflo, aes(x = date, y = inflo), col = "black") +
facet_grid(. ~ Sol)
source('~/cecidomyie/drafts/decomposition.R')
source('~/cecidomyie/drafts/test_param_saisonnalité.R')
source('~/cecidomyie/drafts/test_param_saisonnalité.R')
# eggs <- 300
res2 <- nsga2(objectif2, 6, 3, my_mae, inflos2017,
lower.bounds = c(0,0,0,0,1,0),
upper.bounds = c(10,1,1,1,50,2),
popsize = 200, generations = 50)
source('~/cecidomyie/drafts/test_param_saisonnalité.R')
# eggs <- 300
res2 <- nsga2(objectif2, 6, 3, my_mae, inflos2017,
lower.bounds = c(0,0,0,0,1,0),
upper.bounds = c(10,1,1,1,50,2),
popsize = 200, generations = 50)
ind_opt2 <- res2$value %>% as_tibble %>%
mutate(norm = abs(V1 + V2 + V3)) %$%
which.min(norm)
arg_opt2 <- res2$par[ind_opt2, ]
res2
# Plot --------------------------------------------------------------------
# eggs <- 150
larves_cla <- dynamics2(arg_opt, inflos2017)
larves_er_ref <- cbind(date = date2017, obs = larves2017[, 1], ref = larves_cla[, 1]) %>%
as_tibble %>%
mutate_at("date", as_date) %>%
gather(obs, ref, key = statut, value = nombre, factor_key = TRUE) %>%
mutate(Sol = factor("ER", levels = c("ER", "PS", "EH")))
larves_ps_ref <- cbind(date = date2017, obs = larves2017[, 2], ref = larves_cla[, 2]) %>%
as_tibble %>%
mutate_at("date", as_date) %>%
gather(obs, ref, key = statut, value = nombre, factor_key = TRUE) %>%
mutate(Sol = factor("PS", levels = c("ER", "PS", "EH")))
larves_eh_ref <- cbind(date = date2017, obs = larves2017[, 3], ref = larves_cla[, 3]) %>%
as_tibble %>%
mutate_at("date", as_date) %>%
gather(obs, ref, key = statut, value = nombre, factor_key = TRUE) %>%
mutate(Sol = factor("EH", levels = c("ER", "PS", "EH")))
larves_ref <- bind_rows(larves_er_ref, larves_ps_ref, larves_eh_ref)
# eggs <- 300
larves_est <- dynamics3(arg_opt2, inflos2017)
larves_er <- cbind(date = date2017, obs = larves2017[, 1], est = larves_est[, 1]) %>%
as_tibble %>%
mutate_at("date", as_date) %>%
gather(obs, est, key = statut, value = nombre, factor_key = TRUE) %>%
mutate(Sol = factor("ER", levels = c("ER", "PS", "EH")))
larves_ps <- cbind(date = date2017, obs = larves2017[, 2], est = larves_est[, 2]) %>%
as_tibble %>%
mutate_at("date", as_date) %>%
gather(obs, est, key = statut, value = nombre, factor_key = TRUE) %>%
mutate(Sol = factor("PS", levels = c("ER", "PS", "EH")))
larves_eh <- cbind(date = date2017, obs = larves2017[, 3], est = larves_est[, 3]) %>%
as_tibble %>%
mutate_at("date", as_date) %>%
gather(obs, est, key = statut, value = nombre, factor_key = TRUE) %>%
mutate(Sol = factor("EH", levels = c("ER", "PS", "EH")))
to_plot <- bind_rows(larves_er, larves_ps, larves_eh, larves_er_ref, larves_ps_ref, larves_eh_ref) %>%
mutate_at("statut", as_factor)
to_plot %>% ggplot(aes(x = date, y = nombre, color = statut)) +
geom_point() +
geom_line(lwd = 0.75) +
theme_bw() +
# geom_line(data = inflo, aes(x = date, y = inflo), col = "black") +
facet_grid(. ~ Sol)
inflo <- cbind(date = date2017, inflos2017) %>%
as_tibble %>%
mutate_at("date", as_date) %>%
gather(ER, PS, EH, key = Sol, value = inflo, factor_key = TRUE)
source('~/cecidomyie/drafts/decomposition.R')
source('~/cecidomyie/drafts/test_param_saisonnalité.R')
source('~/cecidomyie/drafts/decomposition.R')
# eggs <- 300
res2 <- nsga2(objectif2, 6, 3, my_mae, inflos2017,
lower.bounds = c(0,0,0,0,1,0),
upper.bounds = c(10,1,1,1,50,2),
popsize = 200, generations = 50)
ind_opt2 <- res2$value %>% as_tibble %>%
mutate(norm = abs(V1 + V2 + V3)) %$%
which.min(norm)
arg_opt2 <- res2$par[ind_opt2, ]
# Plot --------------------------------------------------------------------
# eggs <- 150
larves_cla <- dynamics2(arg_opt, inflos2017)
larves_er_ref <- cbind(date = date2017, obs = larves2017[, 1], ref = larves_cla[, 1]) %>%
as_tibble %>%
mutate_at("date", as_date) %>%
gather(obs, ref, key = statut, value = nombre, factor_key = TRUE) %>%
mutate(Sol = factor("ER", levels = c("ER", "PS", "EH")))
larves_ps_ref <- cbind(date = date2017, obs = larves2017[, 2], ref = larves_cla[, 2]) %>%
as_tibble %>%
mutate_at("date", as_date) %>%
gather(obs, ref, key = statut, value = nombre, factor_key = TRUE) %>%
mutate(Sol = factor("PS", levels = c("ER", "PS", "EH")))
larves_eh_ref <- cbind(date = date2017, obs = larves2017[, 3], ref = larves_cla[, 3]) %>%
as_tibble %>%
mutate_at("date", as_date) %>%
gather(obs, ref, key = statut, value = nombre, factor_key = TRUE) %>%
mutate(Sol = factor("EH", levels = c("ER", "PS", "EH")))
larves_ref <- bind_rows(larves_er_ref, larves_ps_ref, larves_eh_ref)
# eggs <- 300
larves_est <- dynamics3(arg_opt2, inflos2017)
larves_er <- cbind(date = date2017, obs = larves2017[, 1], est = larves_est[, 1]) %>%
as_tibble %>%
mutate_at("date", as_date) %>%
gather(obs, est, key = statut, value = nombre, factor_key = TRUE) %>%
mutate(Sol = factor("ER", levels = c("ER", "PS", "EH")))
larves_ps <- cbind(date = date2017, obs = larves2017[, 2], est = larves_est[, 2]) %>%
as_tibble %>%
mutate_at("date", as_date) %>%
gather(obs, est, key = statut, value = nombre, factor_key = TRUE) %>%
mutate(Sol = factor("PS", levels = c("ER", "PS", "EH")))
larves_eh <- cbind(date = date2017, obs = larves2017[, 3], est = larves_est[, 3]) %>%
as_tibble %>%
mutate_at("date", as_date) %>%
gather(obs, est, key = statut, value = nombre, factor_key = TRUE) %>%
mutate(Sol = factor("EH", levels = c("ER", "PS", "EH")))
to_plot <- bind_rows(larves_er, larves_ps, larves_eh, larves_er_ref, larves_ps_ref, larves_eh_ref) %>%
mutate_at("statut", as_factor)
to_plot %>% ggplot(aes(x = date, y = nombre, color = statut)) +
geom_point() +
geom_line(lwd = 0.75) +
theme_bw() +
# geom_line(data = inflo, aes(x = date, y = inflo), col = "black") +
facet_grid(. ~ Sol)
arg_opt
arg_opt2
source('~/cecidomyie/drafts/decomposition.R')
res2 <- nsga2(objectif2, 6, 3, my_mae, inflos2017,
lower.bounds = c(0,0,0,0,1,0),
upper.bounds = c(10,1,1,1,50,2),
popsize = 200, generations = 50)
ind_opt2 <- res2$value %>% as_tibble %>%
mutate(norm = abs(V1 + V2 + V3)) %$%
which.min(norm)
arg_opt2 <- res2$par[ind_opt2, ]
arg_opt2
larves2017
larves2017[,1]
cor(larves2017[13:80,1], lag(larves2017[,1], 12)[-(1:12)])
cor(larves2017[1:68,1], lag(larves2017[,1], 12)[-(1:12)])
cor(lag(larves2017[,1], 12)[-(1:12)], larves2017[1:68,1] )
larves_ER
lag(larves_ER, 12)
lag(larves_ER, order = 12)
?lag
lag(larves_ER, n = 12)
dplyr::lag(larves_ER, n = 12)
library(tidyverse)
cor(lag(larves2017[,1], 12)[-(1:12)], larves2017[1:68,1] )
cor(lag(larves2017[,1], 12)[-(1:12)], larves2017[13:80,1] )
lag(larves_ER, 12)
lag(larves_ER, 12)[-(1:12)]
cor(lag(larves_ER, 12)[-(1:12)], larves_ER[13:80])
cor(larves_ER[1:68], larves_ER[13:80])
cor(larves_PS[1:68], larves_PS[13:80])
cor(larves_EH[1:68], larves_EH[13:80])
cor(larves_ER[1:69], larves_ER[14:80])
cor(larves_ER[1:67], larves_ER[14:80])
cor(larves_PS[1:67], larves_PS[14:80])
cor(larves_EH[1:67], larves_EH[14:80])
source('~/cecidomyie/drafts/larves_model.R')
## Script qui...
# Packages / data ---------------------------------------------------------
library(tidyverse)
library(mco)
data <- read.csv("../data/2017_piege.csv")
larves_ER <- data %>% filter(Sol == "ER") %>% pull(inflos)
larves_PS <- data %>% filter(Sol == "PS") %>% pull(inflos)
larves_EH <- data %>% filter(Sol == "EH") %>% pull(inflos)
# Corrélations ------------------------------------------------------------
## 12
cor(lag(larves_ER, 12)[-(1:12)], larves_ER[13:80], method = "spearman")
cor(lag(larves_PS, 12)[-(1:12)], larves_PS[13:80], method = "spearman")
cor(lag(larves_EH, 12)[-(1:12)], larves_EH[13:80], method = "spearman")
## 13
cor(lag(larves_ER, 13)[-(1:13)], larves_ER[14:80], method = "spearman")
cor(lag(larves_PS, 13)[-(1:13)], larves_PS[14:80], method = "spearman")
cor(lag(larves_EH, 13)[-(1:13)], larves_EH[14:80], method = "spearman")
# Modèle ------------------------------------------------------------------
my_mae <- function(x, y) {
n_obs <- length(x)
sum(abs(x - y)) / n_obs
}
objectif_larves <- function(x, larve) {
alpha <- x[1:68]
r <- x[69]
mu <- x[70]
exo <- x[71:138]
larves_lag <- lag(larve, 12)[-(1:12)]
larves_pred <- alpha * r * (mu * larves_lag + exo)
my_mae(larves_pred, larve[13:80])
}
give <- function(x, larve) {
alpha <- x[1:68]
r <- x[69]
mu <- x[70]
exo <- x[71:138]
larves_lag <- lag(larve, 12)[-(1:12)]
larves_pred <- alpha * r * (mu * larves_lag + exo)
}
res_ER <- nsga2(objectif_larves, 138, 1, larves_ER,
lower.bounds = rep(0, 138), upper.bounds = rep(5000, 138),
popsize = 800, generations = 1000)
res_PS <- nsga2(objectif_larves, 138, 1, larves_PS,
lower.bounds = rep(0, 138), upper.bounds = rep(5000, 138),
popsize = 800, generations = 1000)
res_EH <- nsga2(objectif_larves, 138, 1, larves_EH,
lower.bounds = rep(0, 138), upper.bounds = rep(5000, 138),
popsize = 800, generations = 1000)
res_ER$par[1,]
larves_ER
give(res_ER$par[1,], larves_ER)
plot(give(res_ER$par[1,], larves_ER))
plot(give(res_ER$par[1,], larves_ER), type = 'l')
lines(larves_ER, col = "red")
plot(give(res_ER$par[1,], larves_ER), type = 'l')
lines(larves_ER[1:68], col = "red")
plot(give(res_ER$par[1,], larves_ER), type = 'l')
lines(larves_ER[13:80], col = "red")
plot(give(res_ER$par[1,], larves_ER), type = 'l', lwd = 2)
lines(larves_ER[13:80], col = "red", lwd = 2)
plot(give(res_PS$par[1,], larves_PS), type = 'l', lwd = 2)
lines(larves_PS[13:80], col = "red", lwd = 2)
plot(give(res_EH$par[1,], larves_PS), type = 'l', lwd = 2)
lines(larves_EH[13:80], col = "red", lwd = 2)
res_EH <- nsga2(objectif_larves, 138, 1, larves_EH,
lower.bounds = rep(0, 138), upper.bounds = rep(5000, 138),
popsize = 800, generations = 3000)
plot(give(res_EH$par[1,], larves_PS), type = 'l', lwd = 2)
lines(larves_EH[13:80], col = "red", lwd = 2)
res_EH <- nsga2(objectif_larves, 138, 1, larves_EH,
lower.bounds = rep(0, 138), upper.bounds = rep(5000, 138),
popsize = 800, generations = 8000)
plot(give(res_EH$par[1,], larves_PS), type = 'l', lwd = 2)
lines(larves_EH[13:80], col = "red", lwd = 2)
plot(larves_EH[13:80], type = "l", col = "red", lwd = 2)
lines(give(res_EH$par[1,], larves_PS), lwd = 2)
res_EH <- nsga2(objectif_larves, 138, 1, larves_EH,
lower.bounds = rep(0, 138), upper.bounds = rep(5000, 138),
popsize = 800, generations = 16000)
plot(larves_EH[13:80], type = "l", col = "red", lwd = 2)
lines(give(res_EH$par[1,], larves_PS), lwd = 2)
res_ER$par[1,]
source('~/cecidomyie/drafts/larves_model.R')
plot(give(res_EH$par[1, ], larves_EH), type = "l")
lines(larves_EH, col = "red")
plot(give(res_EH$par[1, ], larves_EH), type = "l")
lines(larves_EH[13:68], col = "red")
plot(give(res_EH$par[1, ], larves_EH), type = "l")
lines(larves_EH[13:68], col = "red")
plot(give(res_EH$par[1, ], larves_EH), type = "l")
lines(larves_EH[13:80], col = "red")
source('~/cecidomyie/drafts/modele_conceptuel_cecido.R')
summary(glm_ER)
## ER
df_ER <- data.frame(Date = date2017[18:80], Observation = larves_ER[18:80],
Prédiction = predict(glm_ER))
## ER
df_ER <- data.frame(Date = date2017[18:80], Observation = larves_ER[18:80],
Prédiction = predict(glm_ER,type = "response"))
plot_ER1 <- df_ER %>% ggplot() +
aes(x = Observation, y = Prédiction) +
geom_point() +
theme_bw() +
theme(aspect.ratio = 1) +
ylim(c(0, 2605)) +
xlim(c(0, 2605))
plot_ER1
## ER
df_ER <- data.frame(Date = date2017[18:80], Observation = larves_ER[18:80],
Prédiction = predict(lm_ER))
plot_ER1 <- df_ER %>% ggplot() +
aes(x = Observation, y = Prédiction) +
geom_point() +
theme_bw() +
theme(aspect.ratio = 1) +
ylim(c(0, 2605)) +
xlim(c(0, 2605))
plot_ER1
lag(larves)
lag(larves_ER)
source('~/cecidomyie/drafts/modele_conceptuel_cecido.R')
lag(larves_ER, 5)
for (day in 7:17) {
print(day)
cor(larves_ER[1:(80-day)], lag(larves_ER, day)[-(1:day)])
}
for (day in 7:17) {
print(day)
(cor(larves_ER[1:(80-day)], lag(larves_ER, day)[-(1:day)], method = "spearman"))
}
for (day in 7:17) {
print(day)
print(cor(larves_ER[1:(80-day)], lag(larves_ER, day)[-(1:day)], method = "spearman"))
}
for (day in 7:17) {
print(day)
print(cor(larves_ER[1:(80 - day)],
larves_ER[day:80],
method = "spearman"))
}
for (day in 7:17) {
print(day)
print(cor(larves_ER[1:(80 - day)],
larves_ER[(day + 1):80],
method = "spearman"))
}
print(cor(larves_ER[(day + 1):80],
larves_ER[1:(80 - day)],
method = "spearman"))
for (day in 7:17) {
print(day)
print(cor(larves_ER[(day + 1):80],
larves_ER[1:(80 - day)],
method = "spearman"))
}
for (day in 7:17) {
print(day)
print(cor(larves_ER[(day + 1):80], larves_ER[1:(80 - day)], method = "spearman"),
cor(larves_PS[(day + 1):80], larves_PS[1:(80 - day)], method = "spearman"),
cor(larves_EH[(day + 1):80], larves_EH[1:(80 - day)], method = "spearman"))
}
for (day in 7:17) {
print(cor(larves_ER[(day + 1):80], larves_ER[1:(80 - day)], method = "spearman"),
cor(larves_PS[(day + 1):80], larves_PS[1:(80 - day)], method = "spearman"),
cor(larves_EH[(day + 1):80], larves_EH[1:(80 - day)], method = "spearman"))
}
for (day in 7:17) {
print(cor(larves_ER[(day + 1):80], larves_ER[1:(80 - day)], method = "spearman"))
# cor(larves_PS[(day + 1):80], larves_PS[1:(80 - day)], method = "spearman"),
# cor(larves_EH[(day + 1):80], larves_EH[1:(80 - day)], method = "spearman"))
}
?print
for (day in 7:17) {
paste(cor(larves_ER[(day + 1):80], larves_ER[1:(80 - day)], method = "spearman"),
cor(larves_PS[(day + 1):80], larves_PS[1:(80 - day)], method = "spearman"),
cor(larves_EH[(day + 1):80], larves_EH[1:(80 - day)], method = "spearman"))
}
for (day in 7:17) {
paste(cor(larves_ER[(day + 1):80], larves_ER[1:(80 - day)], method = "spearman"),
cor(larves_PS[(day + 1):80], larves_PS[1:(80 - day)], method = "spearman"),
cor(larves_EH[(day + 1):80], larves_EH[1:(80 - day)], method = "spearman"))
}
for (day in 7:17) {
paste(cor(larves_ER[(day + 1):80], larves_ER[1:(80 - day)], method = "spearman"),
cor(larves_PS[(day + 1):80], larves_PS[1:(80 - day)], method = "spearman"),
cor(larves_EH[(day + 1):80], larves_EH[1:(80 - day)], method = "spearman")) %>% print
}
for (day in 7:17) {
print(day)
print(cor(larves_ER[(day + 1):80], larves_ER[1:(80 - day)], method = "spearman"))
}
for (day in 7:17) {
# print(day)
print(cor(larves_ER[(day + 1):80], larves_ER[1:(80 - day)], method = "spearman"))
}
for (day in 7:17) {
# print(day)
print(c(cor(larves_ER[(day + 1):80], larves_ER[1:(80 - day)], method = "spearman"),
cor(larves_PS[(day + 1):80], larves_PS[1:(80 - day)], method = "spearman"),
cor(larves_EH[(day + 1):80], larves_EH[1:(80 - day)], method = "spearman")))
}
for (day in 7:17) {
# print(day)
print(c(cor(larves_ER[(day + 1):80], larves_ER[1:(80 - day)], method = "pearson"),
cor(larves_PS[(day + 1):80], larves_PS[1:(80 - day)], method = "pearson"),
cor(larves_EH[(day + 1):80], larves_EH[1:(80 - day)], method = "pearson")))
}
for (day in 7:17) {
# print(day)
print(c(cor(larves_ER[(day + 1):80], larves_ER[1:(80 - day)], method = "spearman"),
cor(larves_PS[(day + 1):80], larves_PS[1:(80 - day)], method = "spearman"),
cor(larves_EH[(day + 1):80], larves_EH[1:(80 - day)], method = "spearman")))
}
for (day in 7:17) {
# print(day)
print(c(cor(larves_ER[(day + 1):80], larves_ER[1:(80 - day)], method = "spearman"),
cor(larves_PS[(day + 1):80], larves_PS[1:(80 - day)], method = "spearman"),
cor(larves_EH[(day + 1):80], larves_EH[1:(80 - day)], method = "spearman")))
}
for (day in 7:17) {
# print(day)
print(c(cor(larves_ER[(day + 1):80], inflos_ER[1:(80 - day)], method = "spearman"),
cor(larves_PS[(day + 1):80], inflos_PS[1:(80 - day)], method = "spearman"),
cor(larves_EH[(day + 1):80], inflos_EH[1:(80 - day)], method = "spearman")))
}
for (day in 1:17) {
# print(day)
print(c(cor(larves_ER[(day + 1):80], inflos_ER[1:(80 - day)], method = "spearman"),
cor(larves_PS[(day + 1):80], inflos_PS[1:(80 - day)], method = "spearman"),
cor(larves_EH[(day + 1):80], inflos_EH[1:(80 - day)], method = "spearman")))
}
for (day in 1:17) {
# print(day)
print(c(cor(larves_ER[(day + 1):80], larves_ER[1:(80 - day)], method = "spearman"),
cor(larves_PS[(day + 1):80], larves_PS[1:(80 - day)], method = "spearman"),
cor(larves_EH[(day + 1):80], larves_EH[1:(80 - day)], method = "spearman")))
}
for (day in 7:17) {
# print(day)
print(c(cor(larves_ER[(day + 1):80], inflos_ER[1:(80 - day)], method = "spearman"),
cor(larves_PS[(day + 1):80], inflos_PS[1:(80 - day)], method = "spearman"),
cor(larves_EH[(day + 1):80], inflos_EH[1:(80 - day)], method = "spearman")))
}
clear
toto <- rnorm
toto <- rnorm(100)
tutu <- rnorm(100, mean = 0.5)
df <- data.frame(toto, tutu)
# Clem --------------------------------------------------------------------
toto <- rnorm(100)
tutu <- rnorm(100, mean = 0.5)
df <- data.frame(toto, tutu)
df %>% ggplot +
aes(x = tutu, y = toto) +
geom_point()
quantile(toto)
quantile(toto) * 2
quantile(toto, 0:0.01:1)
0:0.1:1
0:1:0.01
seq(0,1,0.01)
quantile(toto, seq(0,1,0.01))
toto <- quantile(rnorm(100), seq(0, 1, 0.01))
tutu <- quantile(rnorm(100, mean = 0.5), seq(0, 1, 0.01))
df <- data.frame(toto, tutu)
df %>% ggplot +
aes(x = tutu, y = toto) +
geom_point()
df %>% ggplot +
aes(x = tutu, y = toto) +
geom_point() +
theme(aspect.ratio = 1)
min(toto)
max(toto)
max(tutu)
min(tutu)
df %>% ggplot +
aes(x = tutu, y = toto) +
geom_point() +
theme(aspect.ratio = 1) +
ylim(c(-2.7, 2.7)) +
xlim(c(-2.7, 2.7))
df %>% ggplot +
aes(x = tutu, y = toto) +
geom_point() +
theme(aspect.ratio = 1) +
ylim(c(-2.7, 2.7)) +
xlim(c(-2.7, 2.7)) +
theme_bw()
df %>% ggplot +
aes(x = tutu, y = toto) +
geom_point() +
ylim(c(-2.7, 2.7)) +
xlim(c(-2.7, 2.7)) +
theme_bw() +
theme(aspect.ratio = 1)
df %>% ggplot +
aes(x = tutu, y = toto) +
geom_point() +
ylim(c(-2.5, 2.7)) +
xlim(c(-2.5, 2.7)) +
theme_bw() +
theme(aspect.ratio = 1)
df %>% ggplot +
aes(x = tutu, y = toto) +
geom_point() +
ylim(c(-2.2, 2.7)) +
xlim(c(-2.2, 2.7)) +
theme_bw() +
theme(aspect.ratio = 1)
lm_ER
qqplot(lm_ER)
qqplot(toto, tutu)
rm(list = ls())

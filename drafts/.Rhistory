ylab(expression(I/N))
data.frame(kdet = k_er, ratio = IsurN[, 1]) %>%
ggplot +
aes(x = ratio, y = kdet) +
geom_point() +
theme_bw() +
ylab(expression(k[ER](t))) +
xlab(expression(I/N))
p2 <- data.frame(kdet = k_ps, ratio = IsurN[, 2]) %>%
ggplot +
aes(x = ratio, y = kdet) +
geom_point() +
theme_bw() +
ylab(expression(k[PS](t))) +
xlab(expression(I/N))
p3 <- data.frame(kdet = k_eh, ratio = IsurN[, 3]) %>%
ggplot +
aes(x = ratio, y = kdet) +
geom_point() +
theme_bw() +
ylab(expression(k[EH](t))) +
xlab(expression(I/N))
p1
p1 <- data.frame(kdet = k_er, ratio = IsurN[, 1]) %>%
ggplot +
aes(x = ratio, y = kdet) +
geom_point() +
theme_bw() +
ylab(expression(k[ER](t))) +
xlab(expression(I/N))
p1
p2
p3
p1
p2
p3
library(gridExtra)
grid.arrange(p1, p2, p3, ncol = 3)
p1 <- data.frame(kdet = k_er, ratio = NsurI[, 1]) %>%
ggplot +
aes(x = ratio, y = kdet) +
geom_point() +
theme_bw() +
ylab(expression(k[ER](t))) +
xlab(expression(I/N))
p2 <- data.frame(kdet = k_ps, ratio = NsurI[, 2]) %>%
ggplot +
aes(x = ratio, y = kdet) +
geom_point() +
theme_bw() +
ylab(expression(k[PS](t))) +
xlab(expression(I/N))
p3 <- data.frame(kdet = k_eh, ratio = NsurI[, 3]) %>%
ggplot +
aes(x = ratio, y = kdet) +
geom_point() +
theme_bw() +
ylab(expression(k[EH](t))) +
xlab(expression(I/N))
grid.arrange(p1, p2, p3, ncol = 3)
p1 <- data.frame(kdet = k_er, ratio = NsurI[, 1]) %>%
ggplot +
aes(x = ratio, y = kdet) +
geom_point() +
theme_bw() +
ylab(expression(k[ER](t))) +
xlab(expression(N/I))
p2 <- data.frame(kdet = k_ps, ratio = NsurI[, 2]) %>%
ggplot +
aes(x = ratio, y = kdet) +
geom_point() +
theme_bw() +
ylab(expression(k[PS](t))) +
xlab(expression(N/I))
p3 <- data.frame(kdet = k_eh, ratio = NsurI[, 3]) %>%
ggplot +
aes(x = ratio, y = kdet) +
geom_point() +
theme_bw() +
ylab(expression(k[EH](t))) +
xlab(expression(N/I))
grid.arrange(p1, p2, p3, ncol = 3)
k_er
plot(obs[, 1], k_er)
plot(obs[, 2], k_ps)
plot(obs[, 3], k_eh)
plot(inflos_simulated[, 3], k_eh)
plot(inflos_simulated[, 1], k_er)
plot(inflos_simulated[, 2], k_ps)
# packages / data ---------------------------------------------------------
library(tidyverse)
library(magrittr)
library(mco)
read.csv("../data/2017_bursts_simulated.csv")
bursts <- read.csv("../data/2017_bursts_simulated.csv")
bursts
inflosCDE_er <- rep(NA, 80)
inflosCDE_ps <- rep(NA, 80)
inflosCDE_eh <- rep(NA, 80)
bursts %>% dim()
bursts <- read.csv("../data/2017_bursts_simulated.csv")[2:4]
for (t in 1:80) {
if (t <= 16) {
inflosCDE_er[t] <- sum(bursts[1:t, 1])
inflosCDE_ps[t] <- sum(bursts[1:t, 2])
inflosCDE_eh[t] <- sum(bursts[1:t, 3])
} else {
inflosCDE_er[t] <- sum(bursts[(t - 15):t, 1])
inflosCDE_ps[t] <- sum(bursts[(t - 15):t, 2])
inflosCDE_eh[t] <- sum(bursts[(t - 15):t, 3])
}
}
inflosCDE <- cbind(inflosCDE_er, inflosCDE_ps, inflosCDE_eh)
inflosCDE
plot(inflosCDE[, 1])
plot(inflosCDE[, 2])
plot(inflosCDE[, 3])
inflosCDE %>% class
rm(list = ls)
rm(list = ls())
source('~/cecidomyie/drafts/inflosCDE.R')
source('~/cecidomyie/drafts/inflosCDE.R')
# Plots -------------------------------------------------------------------
obs <- larves
est <- dynamics_diap(arg1, inflosCDE)
er <- data.frame(date = date2017, obs = obs[, 1], est = est[, 1]) %>%
mutate(Sol = factor("ER", levels = c("ER", "PS", "EH"))) %>%
gather(obs, est, key = statut, value = nombre, factor_key = TRUE)
ps <- data.frame(date = date2017, obs = obs[, 2], est = est[, 2]) %>%
mutate(Sol = factor("PS", levels = c("ER", "PS", "EH"))) %>%
gather(obs, est, key = statut, value = nombre, factor_key = TRUE)
eh <- data.frame(date = date2017, obs = obs[, 3], est = est[, 3]) %>%
mutate(Sol = factor("EH", levels = c("ER", "PS", "EH"))) %>%
gather(obs, est, key = statut, value = nombre, factor_key = TRUE)
to_plot <- bind_rows(er, ps, eh)
to_plot %>% ggplot +
aes(x = date, y = nombre, color = statut) +
geom_point() +
geom_line() +
facet_grid(. ~ Sol) +
theme_bw() +
theme(legend.title = element_blank()) +
scale_color_discrete(labels = c("Observation", "Estimation")) +
xlab("Date") +
ylab("Nombre de larves")
# Plots -------------------------------------------------------------------
obs <- larves
est <- dynamics_diap(arg2, inflosCDE)
er <- data.frame(date = date2017, obs = obs[, 1], est = est[, 1]) %>%
mutate(Sol = factor("ER", levels = c("ER", "PS", "EH"))) %>%
gather(obs, est, key = statut, value = nombre, factor_key = TRUE)
ps <- data.frame(date = date2017, obs = obs[, 2], est = est[, 2]) %>%
mutate(Sol = factor("PS", levels = c("ER", "PS", "EH"))) %>%
gather(obs, est, key = statut, value = nombre, factor_key = TRUE)
eh <- data.frame(date = date2017, obs = obs[, 3], est = est[, 3]) %>%
mutate(Sol = factor("EH", levels = c("ER", "PS", "EH"))) %>%
gather(obs, est, key = statut, value = nombre, factor_key = TRUE)
to_plot <- bind_rows(er, ps, eh)
to_plot %>% ggplot +
aes(x = date, y = nombre, color = statut) +
geom_point() +
geom_line() +
facet_grid(. ~ Sol) +
theme_bw() +
theme(legend.title = element_blank()) +
scale_color_discrete(labels = c("Observation", "Estimation")) +
xlab("Date") +
ylab("Nombre de larves")
# Plots -------------------------------------------------------------------
obs <- larves
est <- dynamics_diap(arg3, inflosCDE)
er <- data.frame(date = date2017, obs = obs[, 1], est = est[, 1]) %>%
mutate(Sol = factor("ER", levels = c("ER", "PS", "EH"))) %>%
gather(obs, est, key = statut, value = nombre, factor_key = TRUE)
ps <- data.frame(date = date2017, obs = obs[, 2], est = est[, 2]) %>%
mutate(Sol = factor("PS", levels = c("ER", "PS", "EH"))) %>%
gather(obs, est, key = statut, value = nombre, factor_key = TRUE)
eh <- data.frame(date = date2017, obs = obs[, 3], est = est[, 3]) %>%
mutate(Sol = factor("EH", levels = c("ER", "PS", "EH"))) %>%
gather(obs, est, key = statut, value = nombre, factor_key = TRUE)
to_plot <- bind_rows(er, ps, eh)
to_plot %>% ggplot +
aes(x = date, y = nombre, color = statut) +
geom_point() +
geom_line() +
facet_grid(. ~ Sol) +
theme_bw() +
theme(legend.title = element_blank()) +
scale_color_discrete(labels = c("Observation", "Estimation")) +
xlab("Date") +
ylab("Nombre de larves")
# Plots -------------------------------------------------------------------
obs <- larves
est <- dynamics_diap(arg1, inflosCDE)
er <- data.frame(date = date2017, obs = obs[, 1], est = est[, 1]) %>%
mutate(Sol = factor("ER", levels = c("ER", "PS", "EH"))) %>%
gather(obs, est, key = statut, value = nombre, factor_key = TRUE)
ps <- data.frame(date = date2017, obs = obs[, 2], est = est[, 2]) %>%
mutate(Sol = factor("PS", levels = c("ER", "PS", "EH"))) %>%
gather(obs, est, key = statut, value = nombre, factor_key = TRUE)
eh <- data.frame(date = date2017, obs = obs[, 3], est = est[, 3]) %>%
mutate(Sol = factor("EH", levels = c("ER", "PS", "EH"))) %>%
gather(obs, est, key = statut, value = nombre, factor_key = TRUE)
to_plot <- bind_rows(er, ps, eh)
to_plot %>% ggplot +
aes(x = date, y = nombre, color = statut) +
geom_point() +
geom_line() +
facet_grid(. ~ Sol) +
theme_bw() +
theme(legend.title = element_blank()) +
scale_color_discrete(labels = c("Observation", "Estimation")) +
xlab("Date") +
ylab("Nombre de larves")
plot(inflosCDE[, 1])
plot(inflosCDE[, 2])
plot(inflosCDE[, 3])
# Plots -------------------------------------------------------------------
obs <- larves
est <- dynamics_diap(arg1, inflosCDE)
er <- data.frame(date = date2017, obs = obs[, 1], est = est[, 1]) %>%
mutate(Sol = factor("ER", levels = c("ER", "PS", "EH"))) %>%
gather(obs, est, key = statut, value = nombre, factor_key = TRUE)
ps <- data.frame(date = date2017, obs = obs[, 2], est = est[, 2]) %>%
mutate(Sol = factor("PS", levels = c("ER", "PS", "EH"))) %>%
gather(obs, est, key = statut, value = nombre, factor_key = TRUE)
eh <- data.frame(date = date2017, obs = obs[, 3], est = est[, 3]) %>%
mutate(Sol = factor("EH", levels = c("ER", "PS", "EH"))) %>%
gather(obs, est, key = statut, value = nombre, factor_key = TRUE)
to_plot <- bind_rows(er, ps, eh)
to_plot %>% ggplot +
aes(x = date, y = nombre, color = statut) +
geom_point() +
geom_line() +
facet_grid(. ~ Sol) +
theme_bw() +
theme(legend.title = element_blank()) +
scale_color_discrete(labels = c("Observation", "Estimation")) +
xlab("Date") +
ylab("Nombre de larves")
# Plots -------------------------------------------------------------------
obs <- larves
est <- dynamics_diap(arg3, inflosCDE)
er <- data.frame(date = date2017, obs = obs[, 1], est = est[, 1]) %>%
mutate(Sol = factor("ER", levels = c("ER", "PS", "EH"))) %>%
gather(obs, est, key = statut, value = nombre, factor_key = TRUE)
ps <- data.frame(date = date2017, obs = obs[, 2], est = est[, 2]) %>%
mutate(Sol = factor("PS", levels = c("ER", "PS", "EH"))) %>%
gather(obs, est, key = statut, value = nombre, factor_key = TRUE)
eh <- data.frame(date = date2017, obs = obs[, 3], est = est[, 3]) %>%
mutate(Sol = factor("EH", levels = c("ER", "PS", "EH"))) %>%
gather(obs, est, key = statut, value = nombre, factor_key = TRUE)
to_plot <- bind_rows(er, ps, eh)
to_plot %>% ggplot +
aes(x = date, y = nombre, color = statut) +
geom_point() +
geom_line() +
facet_grid(. ~ Sol) +
theme_bw() +
theme(legend.title = element_blank()) +
scale_color_discrete(labels = c("Observation", "Estimation")) +
xlab("Date") +
ylab("Nombre de larves")
# Plots -------------------------------------------------------------------
obs <- larves
est <- dynamics_diap(arg1, inflosCDE)
er <- data.frame(date = date2017, obs = obs[, 1], est = est[, 1]) %>%
mutate(Sol = factor("ER", levels = c("ER", "PS", "EH"))) %>%
gather(obs, est, key = statut, value = nombre, factor_key = TRUE)
ps <- data.frame(date = date2017, obs = obs[, 2], est = est[, 2]) %>%
mutate(Sol = factor("PS", levels = c("ER", "PS", "EH"))) %>%
gather(obs, est, key = statut, value = nombre, factor_key = TRUE)
eh <- data.frame(date = date2017, obs = obs[, 3], est = est[, 3]) %>%
mutate(Sol = factor("EH", levels = c("ER", "PS", "EH"))) %>%
gather(obs, est, key = statut, value = nombre, factor_key = TRUE)
to_plot <- bind_rows(er, ps, eh)
to_plot %>% ggplot +
aes(x = date, y = nombre, color = statut) +
geom_point() +
geom_line() +
facet_grid(. ~ Sol) +
theme_bw() +
theme(legend.title = element_blank()) +
scale_color_discrete(labels = c("Observation", "Estimation")) +
xlab("Date") +
ylab("Nombre de larves")
# Plots -------------------------------------------------------------------
obs <- larves
est <- dynamics_diap(arg2, inflosCDE)
er <- data.frame(date = date2017, obs = obs[, 1], est = est[, 1]) %>%
mutate(Sol = factor("ER", levels = c("ER", "PS", "EH"))) %>%
gather(obs, est, key = statut, value = nombre, factor_key = TRUE)
ps <- data.frame(date = date2017, obs = obs[, 2], est = est[, 2]) %>%
mutate(Sol = factor("PS", levels = c("ER", "PS", "EH"))) %>%
gather(obs, est, key = statut, value = nombre, factor_key = TRUE)
eh <- data.frame(date = date2017, obs = obs[, 3], est = est[, 3]) %>%
mutate(Sol = factor("EH", levels = c("ER", "PS", "EH"))) %>%
gather(obs, est, key = statut, value = nombre, factor_key = TRUE)
to_plot <- bind_rows(er, ps, eh)
to_plot %>% ggplot +
aes(x = date, y = nombre, color = statut) +
geom_point() +
geom_line() +
facet_grid(. ~ Sol) +
theme_bw() +
theme(legend.title = element_blank()) +
scale_color_discrete(labels = c("Observation", "Estimation")) +
xlab("Date") +
ylab("Nombre de larves")
# Plots -------------------------------------------------------------------
obs <- larves
est <- dynamics_diap(arg3, inflosCDE)
er <- data.frame(date = date2017, obs = obs[, 1], est = est[, 1]) %>%
mutate(Sol = factor("ER", levels = c("ER", "PS", "EH"))) %>%
gather(obs, est, key = statut, value = nombre, factor_key = TRUE)
ps <- data.frame(date = date2017, obs = obs[, 2], est = est[, 2]) %>%
mutate(Sol = factor("PS", levels = c("ER", "PS", "EH"))) %>%
gather(obs, est, key = statut, value = nombre, factor_key = TRUE)
eh <- data.frame(date = date2017, obs = obs[, 3], est = est[, 3]) %>%
mutate(Sol = factor("EH", levels = c("ER", "PS", "EH"))) %>%
gather(obs, est, key = statut, value = nombre, factor_key = TRUE)
to_plot <- bind_rows(er, ps, eh)
to_plot %>% ggplot +
aes(x = date, y = nombre, color = statut) +
geom_point() +
geom_line() +
facet_grid(. ~ Sol) +
theme_bw() +
theme(legend.title = element_blank()) +
scale_color_discrete(labels = c("Observation", "Estimation")) +
xlab("Date") +
ylab("Nombre de larves")
arg1 %>% round(3)
arg3 %>% round(3)
ind1
ind3
res1
res2
res1$par == res3$par
arg1 %>% round(3)
source('~/cecidomyie/drafts/inflosCDE.R')
# Plots -------------------------------------------------------------------
obs <- larves
est <- dynamics_diap(ar1, inflosCDE)
er <- data.frame(date = date2017, obs = obs[, 1], est = est[, 1]) %>%
mutate(Sol = factor("ER", levels = c("ER", "PS", "EH"))) %>%
gather(obs, est, key = statut, value = nombre, factor_key = TRUE)
ps <- data.frame(date = date2017, obs = obs[, 2], est = est[, 2]) %>%
mutate(Sol = factor("PS", levels = c("ER", "PS", "EH"))) %>%
gather(obs, est, key = statut, value = nombre, factor_key = TRUE)
eh <- data.frame(date = date2017, obs = obs[, 3], est = est[, 3]) %>%
mutate(Sol = factor("EH", levels = c("ER", "PS", "EH"))) %>%
gather(obs, est, key = statut, value = nombre, factor_key = TRUE)
to_plot <- bind_rows(er, ps, eh)
to_plot %>% ggplot +
aes(x = date, y = nombre, color = statut) +
geom_point() +
geom_line() +
facet_grid(. ~ Sol) +
theme_bw() +
theme(legend.title = element_blank()) +
scale_color_discrete(labels = c("Observation", "Estimation")) +
xlab("Date") +
ylab("Nombre de larves")
# Plots -------------------------------------------------------------------
obs <- larves
est <- dynamics_diap(ar2, inflosCDE)
er <- data.frame(date = date2017, obs = obs[, 1], est = est[, 1]) %>%
mutate(Sol = factor("ER", levels = c("ER", "PS", "EH"))) %>%
gather(obs, est, key = statut, value = nombre, factor_key = TRUE)
ps <- data.frame(date = date2017, obs = obs[, 2], est = est[, 2]) %>%
mutate(Sol = factor("PS", levels = c("ER", "PS", "EH"))) %>%
gather(obs, est, key = statut, value = nombre, factor_key = TRUE)
eh <- data.frame(date = date2017, obs = obs[, 3], est = est[, 3]) %>%
mutate(Sol = factor("EH", levels = c("ER", "PS", "EH"))) %>%
gather(obs, est, key = statut, value = nombre, factor_key = TRUE)
to_plot <- bind_rows(er, ps, eh)
to_plot %>% ggplot +
aes(x = date, y = nombre, color = statut) +
geom_point() +
geom_line() +
facet_grid(. ~ Sol) +
theme_bw() +
theme(legend.title = element_blank()) +
scale_color_discrete(labels = c("Observation", "Estimation")) +
xlab("Date") +
ylab("Nombre de larves")
# Plots -------------------------------------------------------------------
obs <- larves
est <- dynamics_diap(ar3, inflosCDE)
er <- data.frame(date = date2017, obs = obs[, 1], est = est[, 1]) %>%
mutate(Sol = factor("ER", levels = c("ER", "PS", "EH"))) %>%
gather(obs, est, key = statut, value = nombre, factor_key = TRUE)
ps <- data.frame(date = date2017, obs = obs[, 2], est = est[, 2]) %>%
mutate(Sol = factor("PS", levels = c("ER", "PS", "EH"))) %>%
gather(obs, est, key = statut, value = nombre, factor_key = TRUE)
eh <- data.frame(date = date2017, obs = obs[, 3], est = est[, 3]) %>%
mutate(Sol = factor("EH", levels = c("ER", "PS", "EH"))) %>%
gather(obs, est, key = statut, value = nombre, factor_key = TRUE)
to_plot <- bind_rows(er, ps, eh)
to_plot %>% ggplot +
aes(x = date, y = nombre, color = statut) +
geom_point() +
geom_line() +
facet_grid(. ~ Sol) +
theme_bw() +
theme(legend.title = element_blank()) +
scale_color_discrete(labels = c("Observation", "Estimation")) +
xlab("Date") +
ylab("Nombre de larves")
# Plots -------------------------------------------------------------------
obs <- larves
est <- dynamics_diap(c(0.02, 0.094, 0.989, 0.709, 0.232, 5708), inflosCDE)
er <- data.frame(date = date2017, obs = obs[, 1], est = est[, 1]) %>%
mutate(Sol = factor("ER", levels = c("ER", "PS", "EH"))) %>%
gather(obs, est, key = statut, value = nombre, factor_key = TRUE)
ps <- data.frame(date = date2017, obs = obs[, 2], est = est[, 2]) %>%
mutate(Sol = factor("PS", levels = c("ER", "PS", "EH"))) %>%
gather(obs, est, key = statut, value = nombre, factor_key = TRUE)
eh <- data.frame(date = date2017, obs = obs[, 3], est = est[, 3]) %>%
mutate(Sol = factor("EH", levels = c("ER", "PS", "EH"))) %>%
gather(obs, est, key = statut, value = nombre, factor_key = TRUE)
to_plot <- bind_rows(er, ps, eh)
to_plot %>% ggplot +
aes(x = date, y = nombre, color = statut) +
geom_point() +
geom_line() +
facet_grid(. ~ Sol) +
theme_bw() +
theme(legend.title = element_blank()) +
scale_color_discrete(labels = c("Observation", "Estimation")) +
xlab("Date") +
ylab("Nombre de larves")
inflos_simulated <- as.matrix(read.csv("/home/bastien/cecidomyie/data/attractive_simulated.csv")[, 3:5])
inflos_simulated
to_plot %>% as.data.frame %>%
gather(ER, PS, EH, key = Sol, value = nombre, factor_key = TRUE) %>%
ggplot +
aes(x = date2017, y = value, color = statut) +
geom_line() +
theme_bw() +
facet_grid(. ~ Sol)
to_plot <- rbind(inflos_simulated, inflosCDE) %>%
mutate(statut = rep(c("Attractives", "C/D/E"), each = 80))
colnames(to_plot) <- c("ER", "PS", "EH", "statut")
to_plot %>% as.data.frame %>%
gather(ER, PS, EH, key = Sol, value = nombre, factor_key = TRUE) %>%
ggplot +
aes(x = date2017, y = value, color = statut) +
geom_line() +
theme_bw() +
facet_grid(. ~ Sol)
to_plot <- rbind(inflos_simulated, inflosCDE) %>%
as.data.frame() %>%
mutate(statut = rep(c("Attractives", "C/D/E"), each = 80))
colnames(to_plot) <- c("ER", "PS", "EH", "statut")
to_plot %>%
gather(ER, PS, EH, key = Sol, value = nombre, factor_key = TRUE) %>%
ggplot +
aes(x = date2017, y = value, color = statut) +
geom_line() +
theme_bw() +
facet_grid(. ~ Sol)
to_plot %>%
gather(ER, PS, EH, key = Sol, value = nombre, factor_key = TRUE) %>%
ggplot +
aes(x = date2017, y = nombre, color = statut) +
geom_line() +
theme_bw() +
facet_grid(. ~ Sol)
to_plot %>%
gather(ER, PS, EH, key = Sol, value = nombre, factor_key = TRUE) %>%
ggplot +
aes(x = rep(date2017, 6), y = nombre, color = statut) +
geom_line() +
theme_bw() +
facet_grid(. ~ Sol)
to_plot %>%
gather(ER, PS, EH, key = Sol, value = nombre, factor_key = TRUE) %>%
ggplot +
aes(x = rep(date2017, 6), y = nombre, color = statut) +
geom_line() +
theme_bw() +
facet_grid(. ~ Sol) +
theme(legend.title = element_blank())
to_plot %>%
gather(ER, PS, EH, key = Sol, value = nombre, factor_key = TRUE) %>%
ggplot +
aes(x = rep(date2017, 6), y = nombre, color = statut) +
geom_line(lwd = 0.75) +
theme_bw() +
facet_grid(. ~ Sol) +
theme(legend.title = element_blank())
to_plot %>%
gather(ER, PS, EH, key = Sol, value = nombre, factor_key = TRUE) %>%
ggplot +
aes(x = rep(date2017, 6), y = nombre, color = statut) +
geom_line(lwd = 0.75) +
theme_bw() +
facet_grid(. ~ Sol) +
theme(legend.title = element_blank()) +
xlab("Date")
to_plot %>%
gather(ER, PS, EH, key = Sol, value = nombre, factor_key = TRUE) %>%
ggplot +
aes(x = rep(date2017, 6), y = nombre, color = statut) +
geom_line(lwd = 0.75) +
theme_bw() +
facet_grid(. ~ Sol) +
theme(legend.title = element_blank()) +
xlab("Date") +
ylab("Nombre d'inflorescences")

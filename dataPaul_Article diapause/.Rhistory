rm(list = ls())
install.packages("gplots")
source('~/cecidomyie/dataPaul_Article diapause/SuiviR_data1.r')
data.df
unique(data.df$Intro)
data.df$Date
data.df$Date %>% cut("week")
library(tidyverse)
data.df$Date %>% cut("week")
data.df$Date %>% cut("week", labels = FALSE)
data.df$Sem
data2.df
meteo.df
XX$sem
XX$sem-21
XX$sem - 21
XX$sem %>% as.numeric - 21
XX$sem %>% as.numeric
XX$sem
levels(XX$sem)
levels(XX$sem) %>% as.numeric()
levels(XX$sem) %>% as.numeric() - 21
data <- read_csv2("/home/bastien/Stage/Moi/Data/2017_flo_B1_.csv") %>% mutate(Observées = moving.mean(alive), Théoriques = moving.mean(alive_theo))
data <- read_csv2("/home/bastien/Stage/Moi/Data/2017_flo_B1_.csv") %>% mutate(Observées = moving.mean(alive), Théoriques = moving.mean(alive_theo))
data2 <- data %>% gather(`Observées`, `Théoriques`, key = "Stade", value = "Nombre")
ggplot(data2, aes(x=days ,y= Nombre, color = Stade))+geom_line(lwd=1) + theme_bw() + xlab("Date") + ylab("Nombre d'inflorescences vivantes observées et théoriques") + theme(legend.title = element_blank())
moving.mean <- function(x) {
n_x <- length(x)
ans <- rep(NA, n_x)
ans[2:(n_x - 1)] <- x[2:(n_x - 1)] + x[1:(n_x - 2)] + x[3:n_x]
ans[1] <- 2 * x[1] + x[2]
ans[n_x] <- 2 * x[n_x] + x[n_x - 1]
ans / 3
}
data <- read_csv2("/home/bastien/Stage/Moi/Data/2017_flo_B1_.csv") %>%
mutate(Observées = moving.mean(alive), Théoriques = moving.mean(alive_theo))
data2 <- data %>% gather(`Observées`, `Théoriques`, key = "Stade", value = "Nombre")
ggplot(data2, aes(x=days ,y= Nombre, color = Stade)) +
geom_line(lwd=1) +
theme_bw() +
xlab("Date") +
ylab("Nombre d'inflorescences vivantes observées et théoriques") +
theme(legend.title = element_blank())
data2
data <- read_csv2("/home/bastien/Stage/Moi/Data/2017_flo_B1_.csv") %>%
mutate(Observées = moving.mean(alive), Théoriques = moving.mean(alive_theo)) %>%
gather(stadeC_theo, stadeE_theo, stadeF_theo, key = "Stade", value = "Nombre")
dara
data
ggplot(data) +
aes(x = days, y = Théoriques, color = Stade) +
geom_line(lwd=1) +
geom_area() +
theme_bw() +
xlab("Date") +
ylab("Nombre d'inflorescences vivantes observées et théoriques") +
theme(legend.title = element_blank())
ggplot(data) +
aes(x = days, y = Théoriques, fill = Stade) +
geom_line(lwd=1) +
geom_area() +
theme_bw() +
xlab("Date") +
ylab("Nombre d'inflorescences vivantes observées et théoriques") +
theme(legend.title = element_blank())
ggplot(data) +
aes(x = days, y = Observées, fill = Stade) +
geom_line(lwd=1) +
geom_area() +
theme_bw() +
xlab("Date") +
ylab("Nombre d'inflorescences vivantes observées et théoriques") +
theme(legend.title = element_blank())
Théoriques
ggplot(data) +
aes(x = days, y = Théoriques, fill = Stade) +
geom_line(lwd=1) +
geom_area() +
theme_bw() +
xlab("Date") +
ylab("Nombre d'inflorescences vivantes observées et théoriques") +
theme(legend.title = element_blank())
data <- read_csv2("/home/bastien/Stage/Moi/Data/2017_flo_B1_.csv") %>%
mutate(Observées = alive, Théoriques = alive_theo) %>%
gather(stadeC_theo, stadeE_theo, stadeF_theo, key = "Stade", value = "Nombre")
ggplot(data) +
aes(x = days, y = Théoriques, fill = Stade) +
geom_line(lwd=1) +
geom_area() +
theme_bw() +
xlab("Date") +
ylab("Nombre d'inflorescences vivantes observées et théoriques") +
theme(legend.title = element_blank())
data2
(data2$stadeC_theo + data2$stadeE_theo) / (data2$stadeC_theo + data2$stadeE_theo + data2$stadeF_theo)
(data2$stadeC_theo + data2$stadeE_theo) / (data2$stadeC_theo + data2$stadeE_theo + data2$stadeF_theo) %>% plot
(data2$stadeC_theo + data2$stadeE_theo) / (data2$stadeC_theo + data2$stadeE_theo + data2$stadeF_theo)
toto <- (data2$stadeC_theo + data2$stadeE_theo) / (data2$stadeC_theo + data2$stadeE_theo + data2$stadeF_theo)
data2
plot(toto)
par(mfrow = c(1,1))
plot(toto)
data <- read_csv2("/home/bastien/Stage/Moi/Data/2017_flo_B1_.csv") %>%
mutate(Observées = alive, Théoriques = alive_theo) %>%
gather(stadeC_theo, stadeE_theo, stadeF_theo, key = "Stade", value = "Nombre")
data
plot(data2$days, toto)
plot(data2$days, toto, type = "l")
plot(data2$days, toto, type = "")
plot(data2$days, toto, type = "-p")
plot(data2$days, toto, type = "-o")
plot(data2$days, toto)
plot(data2$days, toto, type = "l")
toto
df_prop <- data.frame(date = days, prop = toto)
df_prop <- data.frame(date = data2$days, prop = toto)
df_prop %>% ggplot + aes(x = date, y = prop) + geom_line
df_prop %>% ggplot + aes(x = date, y = prop) + geom_line()
df_prop %>% ggplot +
aes(x = date, y = prop) +
geom_line() +
theme_bw()
df_prop <- data.frame(date = data2$days,
stadec = data2$stadeC_theo / (data2$stadeC_theo + data2$stadeE_theo + data2$stadeF_theo),
stadee = data2$stadeE_theo / (data2$stadeC_theo + data2$stadeE_theo + data2$stadeF_theo),
stadef = data2$stadeF_theo /
(data2$stadeC_theo + data2$stadeE_theo + data2$stadeF_theo)) %>%
gather(stadec, stadee, stadef, key = stade, value = prop)
df_prop %>% ggplot +
aes(x = date, fill = prop) +
geom_area() +
geom_line() +
theme_bw()
df_prop %>% ggplot +
aes(x = date, y= prop, fill = stade) +
geom_area() +
geom_line() +
theme_bw()
df_prop
df_prop %>% ggplot +
aes(x = date, y= 1, fill = stade) +
geom_area() +
geom_line() +
theme_bw()
df_prop %>% ggplot +
aes(x = date) +
geom_hline(yintercept = 1)
?geom_ribbon
df_prop <- data.frame(date = data2$days,
stadec = data2$stadeC_theo / (data2$stadeC_theo + data2$stadeE_theo + data2$stadeF_theo),
stadee = data2$stadeE_theo / (data2$stadeC_theo + data2$stadeE_theo + data2$stadeF_theo),
stadef = data2$stadeF_theo /
(data2$stadeC_theo + data2$stadeE_theo + data2$stadeF_theo)) #%>%
df_prop %>% ggplot +
aes(x = date) +
geom_hline(yintercept = 1) +
geom_ribbon(ymin = 0, ymax = stadec) +
geom_line() +
theme_bw()
df_prop
df_prop %>% ggplot +
aes(x = date) +
geom_hline(yintercept = 1) +
geom_ribbon(aes(ymin = 0, ymax = stadec)) +
geom_line() +
theme_bw()
df_prop %>% ggplot +
aes(x = date) +
geom_hline(yintercept = 1) +
geom_ribbon(aes(y = 0, ymax = stadec)) +
geom_line() +
theme_bw()
df_prop %>% ggplot +
aes(x = date) +
geom_hline(yintercept = 1) +
geom_ribbon(aes(ymin = 0, ymax = stadec)) +
geom_line() +
theme_bw()
df_prop %>% ggplot +
aes(x = date) +
geom_hline(yintercept = 1) +
geom_ribbon(aes(ymin = 0, ymax = stadec)) +
theme_bw()
df_prop %>% ggplot +
aes(x = date) +
geom_hline(yintercept = 1) +
geom_ribbon(aes(ymin = 0, ymax = stadec)) +
geom_ribbon(aes(ymin = stadec, ymax = stadee)) +
geom_ribbon(aes(ymin = stadee, ymax = stadef)) +
theme_bw()
df_prop %>% ggplot +
aes(x = date) +
geom_hline(yintercept = 1) +
geom_ribbon(aes(ymin = 0, ymax = stadec), col = "red") +
geom_ribbon(aes(ymin = stadec, ymax = stadee)) +
geom_ribbon(aes(ymin = stadee, ymax = stadef)) +
theme_bw()
df_prop %>% ggplot +
aes(x = date) +
geom_hline(yintercept = 1) +
geom_ribbon(aes(ymin = 0, ymax = stadec), fill = "red") +
geom_ribbon(aes(ymin = stadec, ymax = stadee)) +
geom_ribbon(aes(ymin = stadee, ymax = stadef)) +
theme_bw()
df_prop %>% ggplot +
aes(x = date) +
geom_hline(yintercept = 1) +
geom_ribbon(aes(ymin = 0, ymax = stadec, fill = "red")) +
geom_ribbon(aes(ymin = stadec, ymax = stadee)) +
geom_ribbon(aes(ymin = stadee, ymax = stadef)) +
theme_bw()
df_prop %>% ggplot +
aes(x = date) +
geom_hline(yintercept = 1) +
geom_ribbon(aes(ymin = 0, ymax = stadec, fill = "red")) +
geom_ribbon(aes(ymin = stadec, ymax = stadee, fill = "blue")) +
geom_ribbon(aes(ymin = stadee, ymax = stadef)) +
theme_bw()
df_prop %>% ggplot +
aes(x = date) +
geom_hline(yintercept = 1) +
geom_ribbon(aes(ymin = 0, ymax = stadec, fill = "red")) +
geom_ribbon(aes(ymin = stadec, ymax = stadee, fill = "blue")) +
geom_ribbon(aes(ymin = stadee, ymax = stadef, fill = "green4")) +
theme_bw()
df_prop %>% ggplot +
aes(x = date) +
geom_hline(yintercept = 1) +
geom_ribbon(aes(ymin = 0, ymax = stadec, fill = "red")) +
# geom_ribbon(aes(ymin = stadec, ymax = stadee, fill = "blue")) +
# geom_ribbon(aes(ymin = stadee, ymax = stadef, fill = "green4")) +
theme_bw()
df_prop %>% ggplot +
aes(x = date) +
geom_hline(yintercept = 1) +
geom_ribbon(aes(ymin = 0, ymax = stadec, fill = "red")) +
geom_ribbon(aes(ymin = stadec, ymax = stadee, fill = "blue")) +
# geom_ribbon(aes(ymin = stadee, ymax = stadef, fill = "green4")) +
theme_bw()
df_prop %>% ggplot +
aes(x = date) +
geom_hline(yintercept = 1) +
geom_ribbon(aes(ymin = 0, ymax = stadec, fill = "red")) +
geom_ribbon(aes(ymin = 1 - stadec, ymax = stadee, fill = "blue")) +
# geom_ribbon(aes(ymin = stadee, ymax = stadef, fill = "green4")) +
theme_bw()
df_prop %>% ggplot +
aes(x = date) +
geom_hline(yintercept = 1) +
geom_ribbon(aes(ymin = 0, ymax = stadec, fill = "red")) +
geom_ribbon(aes(ymin = stadec, ymax = stadee, fill = "blue")) +
geom_ribbon(aes(ymin = stadec + stadee, ymax = stadef, fill = "green4")) +
theme_bw()
df_prop %>% ggplot +
aes(x = date) +
geom_hline(yintercept = 1) +
geom_ribbon(aes(ymin = 0, ymax = stadec, fill = "red")) +
geom_ribbon(aes(ymin = stadec, ymax = stadec + stadee, fill = "blue")) +
geom_ribbon(aes(ymin = stadec + stadee, ymax = stadef, fill = "green4")) +
theme_bw()
df_prop %>% ggplot +
aes(x = date) +
geom_hline(yintercept = 1) +
geom_ribbon(aes(ymin = 0, ymax = stadec, fill = "red")) +
geom_ribbon(aes(ymin = stadec, ymax = stadec + stadee, fill = "blue")) +
geom_ribbon(aes(ymin = stadec + stadee, ymax = stadec + stadee + stadef, fill = "green4")) +
theme_bw()
df_prop %>% ggplot +
aes(x = date) +
geom_hline(yintercept = 1) +
geom_ribbon(aes(ymin = 0, ymax = stadec, fill = "C")) +
geom_ribbon(aes(ymin = stadec, ymax = stadec + stadee, fill = "E")) +
geom_ribbon(aes(ymin = stadec + stadee, ymax = stadec + stadee + stadef, fill = "F")) +
theme_bw()
df_prop <- data.frame(date = data2$days,
stadec = data2$stadeC_theo / (data2$stadeC_theo + data2$stadeE_theo + data2$stadeF_theo),
stadee = data2$stadeE_theo / (data2$stadeC_theo + data2$stadeE_theo + data2$stadeF_theo),
stadef = data2$stadeF_theo / (data2$stadeC_theo + data2$stadeE_theo + data2$stadeF_theo),
theo = data2$alive_theo)
df_prop %>% ggplot +
aes(x = date) +
geom_line(y = theo) +
geom_ribbon(aes(ymin = 0, ymax = stadec, fill = "C")) +
geom_ribbon(aes(ymin = stadec, ymax = stadec + stadee, fill = "E")) +
geom_ribbon(aes(ymin = stadec + stadee, ymax = stadec + stadee + stadef, fill = "F")) +
theme_bw()
df_prop %>% ggplot +
aes(x = date) +
geom_line(aes(y = theo)) +
geom_ribbon(aes(ymin = 0, ymax = stadec, fill = "C")) +
geom_ribbon(aes(ymin = stadec, ymax = stadec + stadee, fill = "E")) +
geom_ribbon(aes(ymin = stadec + stadee, ymax = stadec + stadee + stadef, fill = "F")) +
theme_bw()
df_prop %>% ggplot +
aes(x = date) +
geom_line(aes(y = theo)) +
geom_ribbon(aes(ymin = 0, ymax = stadec * theo, fill = "C")) +
geom_ribbon(aes(ymin = stadec * theo, ymax = (stadec + stadee) * theo, fill = "E")) +
geom_ribbon(aes(ymin = (stadec + stadee) * theo, ymax = (stadec + stadee + stadef) * theo, fill = "F")) +
theme_bw()
df_prop %>% ggplot +
aes(x = date) +
geom_line(aes(y = theo)) +
geom_ribbon(aes(ymin = 0, ymax = stadec * theo, fill = "C")) +
geom_ribbon(aes(ymin = stadec * theo, ymax = (stadec + stadee) * theo, fill = "E")) +
geom_ribbon(aes(ymin = (stadec + stadee) * theo, ymax = (stadec + stadee + stadef) * theo, fill = "F")) +
theme_bw() +
ylab("Inflorescences vivantes théoriques et\nstade phénologiques théoriques")
df_prop %>% ggplot +
aes(x = date) +
geom_line(aes(y = theo)) +
geom_ribbon(aes(ymin = 0, ymax = stadec * theo, fill = "C")) +
geom_ribbon(aes(ymin = stadec * theo, ymax = (stadec + stadee) * theo, fill = "E")) +
geom_ribbon(aes(ymin = (stadec + stadee) * theo, ymax = (stadec + stadee + stadef) * theo, fill = "F")) +
theme_bw() +
ylab("Inflorescences vivantes théoriques et\nstade phénologiques théoriques calculés\ngrâce aux débourrements observés")
df_prop %>% ggplot +
aes(x = date) +
geom_line(aes(y = theo)) +
geom_ribbon(aes(ymin = 0, ymax = stadec * theo, fill = "C")) +
geom_ribbon(aes(ymin = stadec * theo, ymax = (stadec + stadee) * theo, fill = "E")) +
geom_ribbon(aes(ymin = (stadec + stadee) * theo, ymax = (stadec + stadee + stadef) * theo, fill = "F")) +
theme_bw() +
ggtitle("Inflorescences vivantes théoriques et\nstade phénologiques théoriques calculés\ngrâce aux débourrements observés")
df_prop %>% ggplot +
aes(x = date) +
geom_line(aes(y = theo)) +
geom_ribbon(aes(ymin = 0, ymax = stadec * theo, fill = "C")) +
geom_ribbon(aes(ymin = stadec * theo, ymax = (stadec + stadee) * theo, fill = "E")) +
geom_ribbon(aes(ymin = (stadec + stadee) * theo, ymax = (stadec + stadee + stadef) * theo, fill = "F")) +
theme_bw() +
ggtitle("Inflorescences vivantes théoriques et stade phénologiques théoriques calculés\ngrâce aux débourrements observés")
df_prop %>% ggplot +
aes(x = date) +
geom_line(aes(y = theo)) +
geom_ribbon(aes(ymin = 0, ymax = stadec * theo, fill = "C")) +
geom_ribbon(aes(ymin = stadec * theo, ymax = (stadec + stadee) * theo, fill = "E")) +
geom_ribbon(aes(ymin = (stadec + stadee) * theo, ymax = (stadec + stadee + stadef) * theo, fill = "F")) +
theme_bw() +
ggtitle("Inflorescences vivantes théoriques et stade phénologiques théoriques calculés\ngrâce aux débourrements observés sur le dataset 1")
df_prop %>% ggplot +
aes(x = date) +
geom_line(aes(y = theo)) +
geom_ribbon(aes(ymin = 0, ymax = stadec * theo, fill = "C")) +
geom_ribbon(aes(ymin = stadec * theo, ymax = (stadec + stadee) * theo, fill = "E")) +
geom_ribbon(aes(ymin = (stadec + stadee) * theo, ymax = (stadec + stadee + stadef) * theo, fill = "F")) +
theme_bw() +
ggtitle("Inflorescences vivantes théoriques et stade phénologiques théoriques calculés\ngrâce aux débourrements observés sur le dataset 1") +
xlab("Date") +
ylab("Nombre")
df_prop %>% ggplot +
aes(x = date) +
geom_line(aes(y = theo)) +
geom_ribbon(aes(ymin = 0, ymax = stadec * theo, fill = "C")) +
geom_ribbon(aes(ymin = stadec * theo, ymax = (stadec + stadee) * theo, fill = "E")) +
geom_ribbon(aes(ymin = (stadec + stadee) * theo, ymax = (stadec + stadee + stadef) * theo, fill = "F")) +
theme_bw() +
ggtitle("Inflorescences vivantes théoriques et stade phénologiques théoriques calculés\ngrâce aux débourrements observés sur le dataset 1") +
xlab("Date") +
ylab("Nombre") +
theme(legend.title = element_blank())

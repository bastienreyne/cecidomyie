er
ps
eh
# Plots -------------------------------------------------------------------
ref <- dynamics(c(0.054, 0, 0, 0, 55), inflos)
new <- dynamics2(arg2, inflos)
# ref2 <- dynamics2(arg3, inflos)
# new2 <- dynamics4(arg4, inflos)
df_er <- data.frame(Date = date2017,
Observés = larves_ER,
Référence = ref[, 1],
Nouveau_pm = new[, 1])
er <- df_er %>% ggplot +
aes(x = Date) +
geom_line(aes(y = Observés), col = "black") +
geom_line(aes(y = Référence), col = "blue") +
geom_line(aes(y = Nouveau_pm), col = "green4") +
geom_point(aes(y = Observés), col = "black") +
geom_point(aes(y = Référence), col = "blue") +
geom_point(aes(y = Nouveau_pm), col = "green4") +
theme_bw()
df_ps <- data.frame(Date = date2017,
Observés = larves_PS,
Référence = ref[, 2],
Nouveau_pm = new[, 2])
ps <- df_ps %>% ggplot +
aes(x = Date) +
geom_line(aes(y = Observés), col = "black") +
geom_line(aes(y = Référence), col = "blue") +
geom_line(aes(y = Nouveau_pm), col = "green4") +
geom_point(aes(y = Observés), col = "black") +
geom_point(aes(y = Référence), col = "blue") +
geom_point(aes(y = Nouveau_pm), col = "green4") +
theme_bw()
df_eh <- data.frame(Date = date2017,
Observés = larves_EH,
Référence = ref[, 3],
Nouveau_pm = new[, 3])
eh <- df_eh %>% ggplot +
aes(x = Date) +
geom_line(aes(y = Observés), col = "black") +
geom_line(aes(y = Référence), col = "blue") +
geom_line(aes(y = Nouveau_pm), col = "green4") +
geom_point(aes(y = Observés), col = "black") +
geom_point(aes(y = Référence), col = "blue") +
geom_point(aes(y = Nouveau_pm), col = "green4") +
theme_bw()
er
ps
eh
# Plots -------------------------------------------------------------------
ref <- dynamics(c(0.04, 0, 0, 0, 55), inflos)
new <- dynamics2(arg2, inflos)
# ref2 <- dynamics2(arg3, inflos)
# new2 <- dynamics4(arg4, inflos)
df_er <- data.frame(Date = date2017,
Observés = larves_ER,
Référence = ref[, 1],
Nouveau_pm = new[, 1])
er <- df_er %>% ggplot +
aes(x = Date) +
geom_line(aes(y = Observés), col = "black") +
geom_line(aes(y = Référence), col = "blue") +
geom_line(aes(y = Nouveau_pm), col = "green4") +
geom_point(aes(y = Observés), col = "black") +
geom_point(aes(y = Référence), col = "blue") +
geom_point(aes(y = Nouveau_pm), col = "green4") +
theme_bw()
df_ps <- data.frame(Date = date2017,
Observés = larves_PS,
Référence = ref[, 2],
Nouveau_pm = new[, 2])
ps <- df_ps %>% ggplot +
aes(x = Date) +
geom_line(aes(y = Observés), col = "black") +
geom_line(aes(y = Référence), col = "blue") +
geom_line(aes(y = Nouveau_pm), col = "green4") +
geom_point(aes(y = Observés), col = "black") +
geom_point(aes(y = Référence), col = "blue") +
geom_point(aes(y = Nouveau_pm), col = "green4") +
theme_bw()
df_eh <- data.frame(Date = date2017,
Observés = larves_EH,
Référence = ref[, 3],
Nouveau_pm = new[, 3])
eh <- df_eh %>% ggplot +
aes(x = Date) +
geom_line(aes(y = Observés), col = "black") +
geom_line(aes(y = Référence), col = "blue") +
geom_line(aes(y = Nouveau_pm), col = "green4") +
geom_point(aes(y = Observés), col = "black") +
geom_point(aes(y = Référence), col = "blue") +
geom_point(aes(y = Nouveau_pm), col = "green4") +
theme_bw()
er
ps
eh
# Plots -------------------------------------------------------------------
ref <- dynamics(c(0.054, 1, 1, 1, 55), inflos)
new <- dynamics2(arg2, inflos)
# ref2 <- dynamics2(arg3, inflos)
# new2 <- dynamics4(arg4, inflos)
df_er <- data.frame(Date = date2017,
Observés = larves_ER,
Référence = ref[, 1],
Nouveau_pm = new[, 1])
er <- df_er %>% ggplot +
aes(x = Date) +
geom_line(aes(y = Observés), col = "black") +
geom_line(aes(y = Référence), col = "blue") +
geom_line(aes(y = Nouveau_pm), col = "green4") +
geom_point(aes(y = Observés), col = "black") +
geom_point(aes(y = Référence), col = "blue") +
geom_point(aes(y = Nouveau_pm), col = "green4") +
theme_bw()
df_ps <- data.frame(Date = date2017,
Observés = larves_PS,
Référence = ref[, 2],
Nouveau_pm = new[, 2])
ps <- df_ps %>% ggplot +
aes(x = Date) +
geom_line(aes(y = Observés), col = "black") +
geom_line(aes(y = Référence), col = "blue") +
geom_line(aes(y = Nouveau_pm), col = "green4") +
geom_point(aes(y = Observés), col = "black") +
geom_point(aes(y = Référence), col = "blue") +
geom_point(aes(y = Nouveau_pm), col = "green4") +
theme_bw()
df_eh <- data.frame(Date = date2017,
Observés = larves_EH,
Référence = ref[, 3],
Nouveau_pm = new[, 3])
eh <- df_eh %>% ggplot +
aes(x = Date) +
geom_line(aes(y = Observés), col = "black") +
geom_line(aes(y = Référence), col = "blue") +
geom_line(aes(y = Nouveau_pm), col = "green4") +
geom_point(aes(y = Observés), col = "black") +
geom_point(aes(y = Référence), col = "blue") +
geom_point(aes(y = Nouveau_pm), col = "green4") +
theme_bw()
er
ps
eh
# Plots -------------------------------------------------------------------
ref <- dynamics(arg1, inflos)
new <- dynamics2(arg2, inflos)
# ref2 <- dynamics2(arg3, inflos)
# new2 <- dynamics4(arg4, inflos)
df_er <- data.frame(Date = date2017,
Observés = larves_ER,
Référence = ref[, 1],
Nouveau_pm = new[, 1])
er <- df_er %>% ggplot +
aes(x = Date) +
geom_line(aes(y = Observés), col = "black") +
geom_line(aes(y = Référence), col = "blue") +
geom_line(aes(y = Nouveau_pm), col = "green4") +
geom_point(aes(y = Observés), col = "black") +
geom_point(aes(y = Référence), col = "blue") +
geom_point(aes(y = Nouveau_pm), col = "green4") +
theme_bw()
df_ps <- data.frame(Date = date2017,
Observés = larves_PS,
Référence = ref[, 2],
Nouveau_pm = new[, 2])
ps <- df_ps %>% ggplot +
aes(x = Date) +
geom_line(aes(y = Observés), col = "black") +
geom_line(aes(y = Référence), col = "blue") +
geom_line(aes(y = Nouveau_pm), col = "green4") +
geom_point(aes(y = Observés), col = "black") +
geom_point(aes(y = Référence), col = "blue") +
geom_point(aes(y = Nouveau_pm), col = "green4") +
theme_bw()
df_eh <- data.frame(Date = date2017,
Observés = larves_EH,
Référence = ref[, 3],
Nouveau_pm = new[, 3])
eh <- df_eh %>% ggplot +
aes(x = Date) +
geom_line(aes(y = Observés), col = "black") +
geom_line(aes(y = Référence), col = "blue") +
geom_line(aes(y = Nouveau_pm), col = "green4") +
geom_point(aes(y = Observés), col = "black") +
geom_point(aes(y = Référence), col = "blue") +
geom_point(aes(y = Nouveau_pm), col = "green4") +
theme_bw()
er
ps
eh
rm(list = ls())
source('~/cecidomyie/drafts/test_new_pm.R')
er
arg1
arg2
arg3
obj1(arg1, inflos = )
obj1(arg1, inflos)
obj3(arg3, inflos)
rm(list = ls())
source('~/cecidomyie/drafts/test_new_pm.R')
er
ps
eh
arg1
arg3
ob1(arg1, inflos)
obj1(arg1, inflos)
obj3(arg3, inflos)
pi
area_circle <- function(x) {
## Donne l'aire d'un cercle en fonction de son périmètre.
x^2 / (4 * pi)
}
area_circle(14.2)
area_circle(c(14.2, 14))
area_circle(c(14.2, 14, 14.3, 15.2, 13.3, 12.5, 15.8))
area_circle(c(14.2, 14, 14.3, 15.2, 13.3, 12.5, 15.8)) %>% mean()
library(tidyverse)
area_circle(c(14.2, 14, 14.3, 15.2, 13.3, 12.5, 15.8)) %>% mean()
area_circle(mean(14.2, 14, 14.3, 15.2, 13.3, 12.5, 15.8))
area_arbre <- area_circle(c(14.2, 14, 14.3, 15.2, 13.3, 12.5, 15.8)) %>% mean
area_arbre
sum(data1)
library(tidyverse)
data1 <- c(8.3333333, 12.0000000, 5.3333333, 0.6666667, 0.3333333, 1.3333333, 0.3333333,
1.3333333, 1.6666667, 1.0000000, 0.3333333, 1.3333333, 0.3333333, 0.3333333)
temp1 <- c(21.45000, 21.10000, 20.77143, 20.92857, 21.48571, 20.31429, 21.18571,
21.12857, 21.45714, 21.84286, 21.41429, 22.20000, 21.81429, 22.54286)
data2 <- c(6.3333333, 10.3333333, 0.6666667, 2.3333333, 1.3333333, 2.3333333, 2.3333333,
1.0000000, 2.0000000, 0.3333333, 0.6666667, 0.3333333)
temp2 <- c(20.31667, 20.84286, 22.05714, 21.22857, 21.25714, 21.45714, 21.44286, 20.80000,
20.86667, 21.24286, 21.35000, 21.57143)
## Seuil 20.5°C
density(c(data1, data2))
sum(data1)
sum(data2)
10^data1
10^data1 %>% sum()
10^data2 %>% sum()
log10(data1)
test <- replace(rep(0,max(as.numeric(names(m)))),as.numeric(names(m)),m)
data.df <- read.table("data1.txt", header=T, sep="\t")
meteo.df <- read.table("data1_meteo.txt", header=T, sep="\t")
data.df$Date <- as.Date(data.df$Date,"%d/%m/%Y")
# "Date"      "Piege"     "Nbad"      "Bourgeons" "FlorC"     "FlorD"     "FlorE"
# [8] "FlorF"     "FlorG"     "VegC"      "VegD"      "VegE"
#[13] "VegF"      "VegG"
# Moment de mise en place du piege
# 1ere lettre du numero du piege
data.df$Intro <- substr(data.df$Piege,1,1)
# Supprime les lignes avec NA dans Nbad
res <- which(is.na(data.df$Nbad)==T)
data.df <- data.df[-res,]
setwd("../dataPaul_Article diapause/")
data.df <- read.table("data1.txt", header=T, sep="\t")
meteo.df <- read.table("data1_meteo.txt", header=T, sep="\t")
data.df$Date <- as.Date(data.df$Date,"%d/%m/%Y")
# "Date"      "Piege"     "Nbad"      "Bourgeons" "FlorC"     "FlorD"     "FlorE"
# [8] "FlorF"     "FlorG"     "VegC"      "VegD"      "VegE"
#[13] "VegF"      "VegG"
# Moment de mise en place du piege
# 1ere lettre du numero du piege
data.df$Intro <- substr(data.df$Piege,1,1)
# Supprime les lignes avec NA dans Nbad
res <- which(is.na(data.df$Nbad)==T)
data.df <- data.df[-res,]
library(gplots)     # pour barplot2
# Rajoute Colonne Semaine
data.df$Sem <- cut(data.df$Date,"week",labels=FALSE)
# Faire un dataframe a l echelle de la semaine
data2.df <- aggregate(data.df$Nbad,
list(data.df$Piege, data.df$Sem, data.df$Intro),
sum,
simplify=F)
data2.df <- as.data.frame(data2.df)
names(data2.df) <- c("Piege", "Sem", "Intro", "Nbad")
data2.df$Sem <- as.factor(data2.df$Sem)
data2.df$Nbad <- as.numeric(data2.df$Nbad)
# Donnees de temperatures du CPEA
meteo.df[,1] <- as.Date(meteo.df[,1], format="%d/%m/%Y")
meteo.df$an <- as.factor(meteo.df$an)
# pour Saint-Paul au lyc?e agricole  LEGTA
XX <- meteo.df[meteo.df$lieu=="LEGTA",]
# Rajoute une colonne semaine
XX$sem <- cut(XX$date,"week",labels=FALSE) + 21
XX$sem <- factor(XX$sem)
# Temperature moyenne hebdomadaire
mXX <- tapply(XX$tempm, XX$sem, mean, na.rm=T)
nXX <- tapply(XX$tempn, XX$sem, mean, na.rm=T)
xXX <- tapply(XX$tempx, XX$sem, mean, na.rm=T)
rXX <- tapply(XX$rr, XX$sem, sum, na.rm=T)
par(mfrow=c(4,1),mar=c(4,5,1,0),cex.axis=1.4,cex.lab=1.8,las=1,oma=c(0,0,0,0))
# Piege sans inflorescence ni pousse vegetative recente
m  <- tapply(data2.df[data2.df$Intro=="A",]$Nbad,data2.df[data2.df$Intro=="A",]$Sem,mean)
sd <- tapply(data2.df[data2.df$Intro=="A",]$Nbad,data2.df[data2.df$Intro=="A",]$Sem,sd)
sd <- replace(rep(0,max(as.numeric(names(sd)))),as.numeric(names(sd)),sd)
test <- replace(rep(0,max(as.numeric(names(m)))),as.numeric(names(m)),m)
test
log10(test)
log(test)
log(test+1)
# Piege sans inflorescence ni pousse vegetative recente
m  <- tapply(data2.df[data2.df$Intro=="A",]$Nbad,data2.df[data2.df$Intro=="A",]$Sem,mean)
sd <- tapply(data2.df[data2.df$Intro=="A",]$Nbad,data2.df[data2.df$Intro=="A",]$Sem,sd)
sd <- replace(rep(0,max(as.numeric(names(sd)))),as.numeric(names(sd)),sd)
test <- replace(rep(0,max(as.numeric(names(m)))),as.numeric(names(m)),m)
names(test) <-  c(29:52,1:52)[1:length(test)]
barplot2(log10(test+1),plot.ci=T,ci.u=log10(test+sd+1),ci.l=log10(test+1),xlab="",ylab="",ylim=c(0,2.5))
text(75,2,"A",cex=3)
abline(v=29,lty=2)
text(25,2.2,"2011",cex=1.8)
text(33,2.2,"2012",cex=1.8)
# Piege avec inflorescences infestees en juillet
m  <- tapply(data2.df[data2.df$Intro=="B",]$Nbad,data2.df[data2.df$Intro=="B",]$Sem,mean)
sd <- tapply(data2.df[data2.df$Intro=="B",]$Nbad,data2.df[data2.df$Intro=="B",]$Sem,sd)
sd <- replace(rep(0,max(as.numeric(names(sd)))),as.numeric(names(sd)),sd)
test <- replace(rep(0,max(as.numeric(names(m)))),as.numeric(names(m)),m)
names(test) <-  c(29:52,1:52)[1:length(test)]
barplot2(log10(test+1),plot.ci=T,ci.u=log10(test+sd+1),ci.l=log10(test+1),xlab="",ylab="",ylim=c(0,2.5))
text(75,2,"B",cex=3)
par(las=0)
mtext("log10 ( Adults emerged per m2 )                          ",2,outer=T,adj=1,line=-2,cex=1.2)
par(las=1)
abline(v=29,lty=2)
text(25,2.3,"2011",cex=1.8)
text(33,2.3,"2012",cex=1.8)
par(mfrow=c(4,1),mar=c(4,5,1,0),cex.axis=1.4,cex.lab=1.8,las=1,oma=c(0,0,0,0))
# Piege sans inflorescence ni pousse vegetative recente
m  <- tapply(data2.df[data2.df$Intro=="A",]$Nbad,data2.df[data2.df$Intro=="A",]$Sem,mean)
sd <- tapply(data2.df[data2.df$Intro=="A",]$Nbad,data2.df[data2.df$Intro=="A",]$Sem,sd)
sd <- replace(rep(0,max(as.numeric(names(sd)))),as.numeric(names(sd)),sd)
test <- replace(rep(0,max(as.numeric(names(m)))),as.numeric(names(m)),m)
names(test) <-  c(29:52,1:52)[1:length(test)]
barplot2(log10(test+1),plot.ci=T,ci.u=log10(test+sd+1),ci.l=log10(test+1),xlab="",ylab="",ylim=c(0,2.5))
text(75,2,"A",cex=3)
abline(v=29,lty=2)
text(25,2.2,"2011",cex=1.8)
text(33,2.2,"2012",cex=1.8)
test
test+1 %>% log10
(test+1) %>% log10
(data1+1) %>% log10
log10(0)
data1 %>% sum()
data2 %>% sum()
30+34.666
64.666/2
larves
larves[, 1] %>% sum()
larves[, 2] %>% sum()
larves[, 3] %>% sum()
## Seuil 20.5°C
density(c(data1, data2))
## Seuil 20.5°C
density(c(data1, data2)) %>% plot()
par(mfrow = c(1, 1))
## Seuil 20.5°C
density(c(data1, data2)) %>% plot()
?density
## Seuil 20.5°C
density(c(data1, data2), from = 0)
## Seuil 20.5°C
density(c(data1, data2), from = 0) %>% plot()
## Seuil 20.5°C
density(c(data1, data2))
## Seuil 20.5°C
density(c(data1, data2))(1)
## Seuil 20.5°C
density(c(data1, data2))
## Seuil 20.5°C
density(c(data1, data2))[1]
## Seuil 20.5°C
density(c(data1, data2))[2]
## Seuil 20.5°C
sortie <- density(c(data1, data2))
str(sortie)
integrate(sortie)
sortie %>% class
ecdf(c(data1, data2))
ecdf(c(data1, data2)) %>% plot
fdr <- ecdf(c(data1, data2))
fdr(0)
fdr(1)
fdr(1)-fdr(-15)
fdr(1)-fdr(-14)
fdr(14)
fdr(13)
fdr(12)
fdr(11)
prop_sortie <- rep(NA, 12)
prop_sortie[1] <- fdr(1) - fdr(-15)
for (i in 2:12) {
prop_sortie <- fdr(i) - fdr(i-1)
}
prop_sortie %>% sum()
prop_sortie
prop_sortie <- rep(NA, 12)
prop_sortie[1] <- fdr(1) - fdr(-15)
for (i in 2:12) {
prop_sortie[i] <- fdr(i) - fdr(i-1)
}
prop_sortie %>% sum()
plot(prop_sortie)
toto <- data.frame(jour = 1:12, prob = prop_sortie)
toto
toto %>% ggplot +
aes(x = jour, y = prob) +
geom_point() +
theme_bw()
toto %>% ggplot +
aes(x = jour, y = prob) +
geom_point() +
theme_bw() +
ylab("Proportion du stock de diapausantes qui sortent") +
xlab("Jour")
sortie_diapause <- prop_sortie
save(sortie_diapause, file = "sortie_diapause.Rdata")
source('~/cecidomyie/drafts/p_pup_temp.R')
good_temp
plot(good_temp)
plot(good_temp, type = "l")
which(good_temp < 20.5)
date2017[15]
prop_sortie
c(rep(0, 14), prop_sortie, rep(0, 18)) %>% length()
c(rep(0, 14), prop_sortie, rep(0, 56)) %>% length()
c(rep(0, 14), prop_sortie, rep(0, 54)) %>% length()
toto <- c(rep(0, 14), prop_sortie, rep(0, 54))
toto
sortie_diapause2017 <- toto
save(sortie_diapause2017, file = "sortie_diapause2017")
save(sortie_diapause2017, file = "sortie_diapause2017.Rdata")
## Seuil 20.5°C
sortie <- density(c(data1, data2))
fdr <- ecdf(c(data1, data2))
prop_sortie <- rep(NA, 12)
prop_sortie[1] <- fdr(1) - fdr(-15)
for (i in 2:12) {
prop_sortie[i] <- fdr(i) - fdr(i-1)
}
toto <- data.frame(jour = 1:12, prob = prop_sortie)
toto %>% ggplot +
aes(x = jour, y = prob) +
geom_point() +
theme_bw() +
ylab("Proportion du stock de diapausantes qui sortent") +
xlab("Jour")
library(tidyverse)
data1 <- c(8.3333333, 12.0000000, 5.3333333, 0.6666667, 0.3333333, 1.3333333, 0.3333333,
1.3333333, 1.6666667, 1.0000000, 0.3333333, 1.3333333, 0.3333333, 0.3333333)
temp1 <- c(21.45000, 21.10000, 20.77143, 20.92857, 21.48571, 20.31429, 21.18571,
21.12857, 21.45714, 21.84286, 21.41429, 22.20000, 21.81429, 22.54286)
data2 <- c(6.3333333, 10.3333333, 0.6666667, 2.3333333, 1.3333333, 2.3333333, 2.3333333,
1.0000000, 2.0000000, 0.3333333, 0.6666667, 0.3333333)
temp2 <- c(20.31667, 20.84286, 22.05714, 21.22857, 21.25714, 21.45714, 21.44286, 20.80000,
20.86667, 21.24286, 21.35000, 21.57143)
## Seuil 20.5°C
sortie <- density(c(data1, data2))
fdr <- ecdf(c(data1, data2))
prop_sortie <- rep(NA, 12)
prop_sortie[1] <- fdr(1) - fdr(-15)
for (i in 2:12) {
prop_sortie[i] <- fdr(i) - fdr(i-1)
}
toto <- data.frame(jour = 1:12, prob = prop_sortie)
toto %>% ggplot +
aes(x = jour, y = prob) +
geom_point() +
theme_bw() +
ylab("Proportion du stock de diapausantes qui sortent") +
xlab("Jour")
rep(prop_sortie/12, each = 7)
toto <- data.frame(jour = 1:12, prob = rep(prop_sortie/7, each = 7))
toto %>% ggplot +
aes(x = jour, y = prob) +
geom_point() +
theme_bw() +
ylab("Proportion du stock de diapausantes qui sortent") +
xlab("Jour")
toto <- data.frame(jour = 1:84, prob = rep(prop_sortie/7, each = 7))
toto %>% ggplot +
aes(x = jour, y = prob) +
geom_point() +
theme_bw() +
ylab("Proportion du stock de diapausantes qui sortent") +
xlab("Jour")
seq(4, 84, 7)
approx(seq(4, 84, 7), prop_sortie, 1:84)
toto <- data.frame(jour = 1:84, prob = approx(seq(4, 84, 7), prop_sortie, 1:84)$y)
toto %>% ggplot +
aes(x = jour, y = prob) +
geom_point() +
theme_bw() +
ylab("Proportion du stock de diapausantes qui sortent") +
xlab("Jour")
approx(seq(4, 84, 7), prop_sortie, 1:84)$y %>% sum()
approx(seq(4, 84, 7), prop_sortie, 1:84)$y %>% sum(na.rm = TRUE)
rep(prop_sortie/12, each = 7) %>% sum()
rep(prop_sortie/7, each = 7) %>% sum()
toto <- data.frame(jour = 1:84, prob = rep(prop_sortie/7, each = 7))
toto %>% ggplot +
aes(x = jour, y = prob) +
geom_point() +
theme_bw() +
ylab("Proportion du stock de diapausantes qui sortent") +
xlab("Jour")
prop_sortie <- rep(prop_sortie/7, each = 7)
prop_sortie
save(prop_sortie, file = sortie_diapause2017.Rdata)
save(prop_sortie, file = "sortie_diapause2017.Rdata")
